---
ms.date: 06/12/2017
keywords: jea, powershell, säkerhet
title: JEA-säkerhetsaspekter
ms.openlocfilehash: 9526e141517601ae3b6d6932cd3536fdf49aa9a6
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 04/23/2019
ms.locfileid: "62084784"
---
# <a name="jea-security-considerations"></a><span data-ttu-id="4a526-103">JEA-säkerhetsaspekter</span><span class="sxs-lookup"><span data-stu-id="4a526-103">JEA Security Considerations</span></span>

> <span data-ttu-id="4a526-104">Gäller för: Windows PowerShell 5.0</span><span class="sxs-lookup"><span data-stu-id="4a526-104">Applies to: Windows PowerShell 5.0</span></span>

<span data-ttu-id="4a526-105">JEA hjälper dig att förbättra din säkerhetsposition genom att minska antalet permanenta administratörer på dina datorer.</span><span class="sxs-lookup"><span data-stu-id="4a526-105">JEA helps you improve your security posture by reducing the number of permanent administrators on your machines.</span></span>
<span data-ttu-id="4a526-106">Detta sker genom att skapa en ny startpunkt för användare att hantera system (en PowerShell-session-konfiguration) som är nära låsta som standard för att förhindra missbruk.</span><span class="sxs-lookup"><span data-stu-id="4a526-106">It does so by creating a new entry point for users to manage the system (a PowerShell session configuration) which is tightly locked down by default to prevent misuse.</span></span>
<span data-ttu-id="4a526-107">Användare som behöver vissa, men inte obegränsad åtkomst till datorn för att utföra administrativa uppgifter kan beviljas åtkomst till JEA-slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="4a526-107">Users who need some, but not unlimited, access to the machine to perform administrative tasks can be granted access to the JEA endpoint.</span></span>
<span data-ttu-id="4a526-108">Eftersom JEA tillåter dem att köra admin-kommandon utan direkt administratörsåtkomst, kan du sedan ta bort dessa användare från säkerhetsgrupper med med hög behörighetsnivå (blir vanliga användare).</span><span class="sxs-lookup"><span data-stu-id="4a526-108">Because JEA allows them to run admin commands without directly having admin access, you can then remove those users from highly privileged security groups (make them standard users).</span></span>

<span data-ttu-id="4a526-109">Det här avsnittet beskriver JEA-säkerhetsmodellen och bästa praxis i detalj.</span><span class="sxs-lookup"><span data-stu-id="4a526-109">This topic describes the JEA security model and best practices in more detail.</span></span>

## <a name="run-as-account"></a><span data-ttu-id="4a526-110">Kör som-konto</span><span class="sxs-lookup"><span data-stu-id="4a526-110">Run As account</span></span>

<span data-ttu-id="4a526-111">Varje JEA-slutpunkt har ett konto med avsedda ”kör som”, vilket är det konto som den anslutande användaren åtgärder utförs.</span><span class="sxs-lookup"><span data-stu-id="4a526-111">Each JEA endpoint has a designated "run as" account, which is the account under which the connecting user's actions are performed.</span></span>
<span data-ttu-id="4a526-112">Det här kontot kan konfigureras i den [session konfigurationsfilen](session-configurations.md), och det konto som du väljer har betydelse på säkerheten för din slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="4a526-112">This account is configurable in the [session configuration file](session-configurations.md), and the account you choose has a significant bearing on the security of your endpoint.</span></span>

<span data-ttu-id="4a526-113">**Virtuella konton** är det rekommenderade sättet att konfigurera kör som-konto.</span><span class="sxs-lookup"><span data-stu-id="4a526-113">**Virtual accounts** are the recommended way of configuring the run as account.</span></span>
<span data-ttu-id="4a526-114">Virtuella konton är enstaka, tillfälligt lokala konton som har skapats för den anslutande användaren ska användas under hela sin JEA-session.</span><span class="sxs-lookup"><span data-stu-id="4a526-114">Virtual accounts are one-time, temporary local accounts that are created for the connecting user to use during the duration of their JEA session.</span></span>
<span data-ttu-id="4a526-115">Så snart som sin session avslutas virtuellt konto kommer att raderas och kan inte längre användas.</span><span class="sxs-lookup"><span data-stu-id="4a526-115">As soon as their session is terminated, the virtual account will be destroyed and cannot be used anymore.</span></span>
<span data-ttu-id="4a526-116">Den anslutande användaren vet inte autentiseringsuppgifterna för virtuellt konto och kan inte använda virtuella konto för att komma åt systemet via andra sätt, till exempel Remote Desktop eller en obegränsad PowerShell-slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="4a526-116">The connecting user does not know the credentials for the virtual account and cannot use the virtual account to access the system via other means, such as Remote Desktop or an unconstrained PowerShell endpoint.</span></span>

<span data-ttu-id="4a526-117">Som standard tillhör virtuella konton gruppen lokala administratörer på datorn.</span><span class="sxs-lookup"><span data-stu-id="4a526-117">By default, virtual accounts belong to the local administrators group on the machine.</span></span>
<span data-ttu-id="4a526-118">Detta ger dem fullständiga rättigheter att hantera allt i systemet, men inga rättigheter att hantera resurser i nätverket.</span><span class="sxs-lookup"><span data-stu-id="4a526-118">This gives them full rights to manage anything on the system, but no rights to manage resources on the network.</span></span>
<span data-ttu-id="4a526-119">När du autentiserar med andra datorer blir användarkontexten som lokalt datorkonto, inte virtuellt konto.</span><span class="sxs-lookup"><span data-stu-id="4a526-119">When authenticating with other machines, the user context will be that of the local computer account, not the virtual account.</span></span>

<span data-ttu-id="4a526-120">Domänkontrollanter är ett specialfall, eftersom det inte finns något begrepp om lokala administratörsgruppen.</span><span class="sxs-lookup"><span data-stu-id="4a526-120">Domain controllers are a special case since there is no concept of a local administrators group.</span></span>
<span data-ttu-id="4a526-121">I stället virtuella konton tillhör Domänadministratörer i stället och kan hantera katalogtjänster på domänkontrollanten.</span><span class="sxs-lookup"><span data-stu-id="4a526-121">Instead, virtual accounts belong to Domain Admins instead and can manage the directory services on the domain controller.</span></span>
<span data-ttu-id="4a526-122">Domän-identiteten är fortfarande begränsad till att använda på den domänkontrollant där JEA-sessionen har initierats, och eventuella nätverksåtkomst visas komma från domänkontrollantens datorobjekt i stället.</span><span class="sxs-lookup"><span data-stu-id="4a526-122">The domain identity is still restricted to use on the domain controller where the JEA session was instantiated, and any network access will appear to come from the domain controller computer object instead.</span></span>

<span data-ttu-id="4a526-123">I båda fallen kan du också explicit definiera vilka säkerhetsgrupper som virtuellt konto ska tillhöra.</span><span class="sxs-lookup"><span data-stu-id="4a526-123">In both cases, you can also explicitly define which security groups the virtual account should belong to.</span></span>
<span data-ttu-id="4a526-124">Detta är en bra idé när den uppgift du utför kan göras utan lokal/domänadministratörsprivilegier.</span><span class="sxs-lookup"><span data-stu-id="4a526-124">This is a good practice when the task you are performing can be done without local/domain admin privileges.</span></span>
<span data-ttu-id="4a526-125">Om du redan har en säkerhetsgrupp som definierats för dina administratörer kan ge du helt enkelt virtuellt konto medlemskap i gruppen att ge det de behörigheter som krävs.</span><span class="sxs-lookup"><span data-stu-id="4a526-125">If you already have a security group defined for your admins, you can simply grant the virtual account membership to that group to give it the permissions it needs.</span></span>
<span data-ttu-id="4a526-126">Virtuellt konto gruppmedlemskap är begränsad till lokala säkerhetsgrupper på arbetsstation och medlemmen servrar, men på en domänkontrollant kan de bara vara medlemmar i domänsäkerhetsgrupper.</span><span class="sxs-lookup"><span data-stu-id="4a526-126">Virtual account group membership is limited to local security groups on workstation and member servers, but on a domain controller they can only be members of domain security groups.</span></span>
<span data-ttu-id="4a526-127">När du anger en eller flera säkerhetsgrupper för virtuellt konto om du vill tillhör, kommer den inte längre tillhör standardgrupper (lokal administratör eller domänadministratör).</span><span class="sxs-lookup"><span data-stu-id="4a526-127">Once you specify one or more security groups for the virtual account to belong to, it will no longer belong to the default groups (local admin or domain admin).</span></span>

<span data-ttu-id="4a526-128">I tabellen nedan sammanfattas de möjliga konfigurationsalternativ och resulterande behörigheter för virtuella konton</span><span class="sxs-lookup"><span data-stu-id="4a526-128">The table below summarizes the possible configuration options and resulting permissions for virtual accounts</span></span>

<span data-ttu-id="4a526-129">Typ av dator</span><span class="sxs-lookup"><span data-stu-id="4a526-129">Computer type</span></span>                | <span data-ttu-id="4a526-130">Virtuell grupp kontokonfigurationen</span><span class="sxs-lookup"><span data-stu-id="4a526-130">Virtual account group configuration</span></span> | <span data-ttu-id="4a526-131">Lokala användarkontext</span><span class="sxs-lookup"><span data-stu-id="4a526-131">Local user context</span></span>                                      | <span data-ttu-id="4a526-132">Nätverket användarkontext</span><span class="sxs-lookup"><span data-stu-id="4a526-132">Network user context</span></span>
-----------------------------|-------------------------------------|---------------------------------------------------------|--------------------------------------------------
<span data-ttu-id="4a526-133">Domänkontrollant</span><span class="sxs-lookup"><span data-stu-id="4a526-133">Domain controller</span></span>            | <span data-ttu-id="4a526-134">Standard</span><span class="sxs-lookup"><span data-stu-id="4a526-134">Default</span></span>                             | <span data-ttu-id="4a526-135">Domänanvändare, medlem i ”*domän*\Domain'</span><span class="sxs-lookup"><span data-stu-id="4a526-135">Domain user, member of '*DOMAIN*\Domain Admins'</span></span>         | <span data-ttu-id="4a526-136">Datorkonto</span><span class="sxs-lookup"><span data-stu-id="4a526-136">Computer account</span></span>
<span data-ttu-id="4a526-137">Domänkontrollant</span><span class="sxs-lookup"><span data-stu-id="4a526-137">Domain controller</span></span>            | <span data-ttu-id="4a526-138">Domängrupper A och B</span><span class="sxs-lookup"><span data-stu-id="4a526-138">Domain groups A and B</span></span>               | <span data-ttu-id="4a526-139">Domänanvändare, medlem i ”*domän*\A ','*domän*\B'</span><span class="sxs-lookup"><span data-stu-id="4a526-139">Domain user, member of '*DOMAIN*\A', '*DOMAIN*\B'</span></span>       | <span data-ttu-id="4a526-140">Datorkonto</span><span class="sxs-lookup"><span data-stu-id="4a526-140">Computer account</span></span>
<span data-ttu-id="4a526-141">Medlemsserver eller arbetsstation</span><span class="sxs-lookup"><span data-stu-id="4a526-141">Member server or workstation</span></span> | <span data-ttu-id="4a526-142">Standard</span><span class="sxs-lookup"><span data-stu-id="4a526-142">Default</span></span>                             | <span data-ttu-id="4a526-143">Lokal användare, medlem i ”*BUILTIN*\Administrators'</span><span class="sxs-lookup"><span data-stu-id="4a526-143">Local user, member of '*BUILTIN*\Administrators'</span></span>        | <span data-ttu-id="4a526-144">Datorkonto</span><span class="sxs-lookup"><span data-stu-id="4a526-144">Computer account</span></span>
<span data-ttu-id="4a526-145">Medlemsserver eller arbetsstation</span><span class="sxs-lookup"><span data-stu-id="4a526-145">Member server or workstation</span></span> | <span data-ttu-id="4a526-146">Lokala grupper C och D</span><span class="sxs-lookup"><span data-stu-id="4a526-146">Local groups C and D</span></span>                | <span data-ttu-id="4a526-147">Lokal användare, medlem i ”*datorn*\C' och '*datorn*\D”</span><span class="sxs-lookup"><span data-stu-id="4a526-147">Local user, member of '*COMPUTER*\C' and '*COMPUTER*\D'</span></span> | <span data-ttu-id="4a526-148">Datorkonto</span><span class="sxs-lookup"><span data-stu-id="4a526-148">Computer account</span></span>

<span data-ttu-id="4a526-149">När du tittar på säkerhetsgranskningshändelser och händelseloggarna för programmet, ser du att varje användarsession i JEA har ett unikt virtuellt konto.</span><span class="sxs-lookup"><span data-stu-id="4a526-149">When you look at security audit events and application event logs, you will see that each JEA user session has a unique virtual account.</span></span>
<span data-ttu-id="4a526-150">På så sätt kan du spåra användaråtgärder i en JEA-slutpunkt tillbaka till den ursprungliga användaren som körde kommandot.</span><span class="sxs-lookup"><span data-stu-id="4a526-150">This helps you track user actions in a JEA endpoint back to the original user who ran the command.</span></span>
<span data-ttu-id="4a526-151">Virtuellt konto namnen följer formatet ”WinRM virtuella användare\\WinRM\_VA\_*ACCOUNTNUMBER*\_*domän* \_ *sAMAccountName*”till exempel om användaren” Alice ”i domänen” Contoso ”startar om en tjänst i en JEA-slutpunkt, användarnamnet som är associerade med alla service control manager-händelser blir” WinRM virtuella användare\\WinRM\_ VA\_1\_contoso\_alice ”.</span><span class="sxs-lookup"><span data-stu-id="4a526-151">Virtual account names follow the format "WinRM Virtual Users\\WinRM\_VA\_*ACCOUNTNUMBER*\_*DOMAIN*\_*sAMAccountName*" For example, if user "Alice" in domain "Contoso" restarts a service in a JEA endpoint, the username associated with any service control manager events would be "WinRM Virtual Users\\WinRM\_VA\_1\_contoso\_alice".</span></span>


<span data-ttu-id="4a526-152">**Gruppen hanterade tjänstkonton (gMSAs)** är användbara när en medlemsserver måste ha åtkomst till nätverksresurser i JEA-session.</span><span class="sxs-lookup"><span data-stu-id="4a526-152">**Group managed service accounts (gMSAs)** are useful when a member server needs to have access to network resources in the JEA session.</span></span>
<span data-ttu-id="4a526-153">Ett exempel för det här är en JEA-slutpunkt som används för att styra åtkomsten till en REST-API som finns på en annan dator.</span><span class="sxs-lookup"><span data-stu-id="4a526-153">An example use case for this is a JEA endpoint that is used to control access to a REST API hosted on a different machine.</span></span>
<span data-ttu-id="4a526-154">Det är enkelt att skriva funktioner till att göra de önskade anrop för REST API, men för att kunna autentisera med API: et som du behöver en nätverksidentitet.</span><span class="sxs-lookup"><span data-stu-id="4a526-154">It is easy to write functions to make the desired invocations on the REST API, but in order to authenticate with the API you need a network identity.</span></span>
<span data-ttu-id="4a526-155">Med hjälp av en grupphanterade tjänstkontot gör ”andra hopp” möjligt medan du fortfarande har kontroll över vilka datorer kan använda kontot.</span><span class="sxs-lookup"><span data-stu-id="4a526-155">Using a group managed service account makes the "second hop" possible while still having control over which computers can use the account.</span></span>
<span data-ttu-id="4a526-156">GMSA gällande behörigheter definieras av säkerhetsgrupper (lokalt eller via domänadministratör) som gMSA-kontot tillhör.</span><span class="sxs-lookup"><span data-stu-id="4a526-156">The effective permissions of the gMSA are defined by the security groups (local or domain) to which the gMSA account belongs.</span></span>

<span data-ttu-id="4a526-157">När en JEA-slutpunkt har konfigurerats för att använda ett gMSA-konto visas åtgärderna för alla JEA-användare komma från samma grupp Hanterat tjänstkonto.</span><span class="sxs-lookup"><span data-stu-id="4a526-157">When a JEA endpoint is configured to use a gMSA account, the actions of all JEA users will appear to come from the same group managed service account.</span></span>
<span data-ttu-id="4a526-158">Det enda sättet som du kan spåra åtgärder tillbaka till en specifik användare är att identifiera uppsättningen kommandon som körs i en PowerShell-session avskrift.</span><span class="sxs-lookup"><span data-stu-id="4a526-158">The only way you can trace actions back to a specific user is to identify the set of commands run in a PowerShell session transcript.</span></span>

<span data-ttu-id="4a526-159">**Pass till autentiseringsuppgifter** används när du inte ange ett kör som-konto och vill använda PowerShell för att använda den anslutande användarens autentiseringsuppgifter för att köra kommandon på fjärrservern.</span><span class="sxs-lookup"><span data-stu-id="4a526-159">**Pass-thru credentials** are used when you do not specify a run as account and want PowerShell to use the connecting user's credential to run commands on the remote server.</span></span>
<span data-ttu-id="4a526-160">Den här konfigurationen är *inte* rekommenderas för JEA eftersom det kräver att bevilja den anslutande användare direkt åtkomsten till Privilegierade hanteringsgrupper.</span><span class="sxs-lookup"><span data-stu-id="4a526-160">This configuration is *not* recommended for JEA as it would require you to grant the connecting user direct access to privileged management groups.</span></span>
<span data-ttu-id="4a526-161">Om den anslutande användaren redan har administratörsrättigheter, kan de undvika JEA helt och hållet och hantera systemet via andra, obegränsad innebär.</span><span class="sxs-lookup"><span data-stu-id="4a526-161">If the connecting user already has admin privileges, they can avoid JEA altogether and manage the system via other, unconstrained means.</span></span>
<span data-ttu-id="4a526-162">Se avsnittet nedan om hur [JEA skyddar inte mot administratörer](#jea-does-not-protect-against-admins) för mer information.</span><span class="sxs-lookup"><span data-stu-id="4a526-162">See the section below on how [JEA does not protect against admins](#jea-does-not-protect-against-admins) for more information.</span></span>

<span data-ttu-id="4a526-163">**Standard kör som-konton** kan du ange ett användarkonto som ska köras på hela PowerShell-sessionen.</span><span class="sxs-lookup"><span data-stu-id="4a526-163">**Standard run as accounts** allow you to specify any user account under which the entire PowerShell session will run.</span></span>
<span data-ttu-id="4a526-164">Detta är en viktig skillnad eftersom en sessionskonfiguration inställd på att använda ett fast kör som-konto (med den `-RunAsCredential` parametern) inte är JEA-medveten.</span><span class="sxs-lookup"><span data-stu-id="4a526-164">This is an important distinction, because a session configuration set to use a fixed run as account (with the `-RunAsCredential` parameter) is not JEA-aware.</span></span>
<span data-ttu-id="4a526-165">Det innebär att att rolldefinitioner inte längre fungerar som förväntat och att varje användare som har behörighet att komma åt slutpunkten kommer att tilldelas samma roll.</span><span class="sxs-lookup"><span data-stu-id="4a526-165">That means that role definitions no longer function as expected, and every user authorized to access the endpoint will be assigned the same role.</span></span>

<span data-ttu-id="4a526-166">Du bör inte använda en RunAsCredential på en JEA-slutpunkt på grund av problem i spårning av åtgärder till specifika användare och avsaknaden av stöd för att mappa användare till roller.</span><span class="sxs-lookup"><span data-stu-id="4a526-166">You should not use a RunAsCredential on a JEA endpoint because of the difficulty in tracing actions back to specific users and the lack of support for mapping users to roles.</span></span>

## <a name="winrm-endpoint-acl"></a><span data-ttu-id="4a526-167">WinRM slutpunkts-ACL</span><span class="sxs-lookup"><span data-stu-id="4a526-167">WinRM Endpoint ACL</span></span>

<span data-ttu-id="4a526-168">Som med vanlig PowerShell-fjärrkommunikation slutpunkter varje JEA-slutpunkt har en separat åtkomstkontrollista (ACL) i WinRM-konfigurationen som styr vem som kan autentisera med JEA-slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="4a526-168">As with regular PowerShell remoting endpoints, each JEA endpoint has a separate access control list (ACL) set in the WinRM configuration that controls who can authenticate with the JEA endpoint.</span></span>
<span data-ttu-id="4a526-169">Om felaktigt konfigurerad, betrodda användare kanske inte kan komma åt JEA-slutpunkt och/eller ej betrodda användare kan komma åt den.</span><span class="sxs-lookup"><span data-stu-id="4a526-169">If improperly configured, trusted users may not be able to access the JEA endpoint and/or untrusted users may gain access.</span></span>
<span data-ttu-id="4a526-170">WinRM-ACL påverkar inte, men mappningen av användare till JEA-roller.</span><span class="sxs-lookup"><span data-stu-id="4a526-170">The WinRM ACL does not, however, affect the mapping of users to JEA roles.</span></span>
<span data-ttu-id="4a526-171">Som styrs av den *RoleDefinitions* i konfigurationsfilen session som har registrerats i systemet.</span><span class="sxs-lookup"><span data-stu-id="4a526-171">That is controlled by the *RoleDefinitions* field in the session configuration file that was registered on the system.</span></span>

<span data-ttu-id="4a526-172">Som standard när du registrerar en JEA-slutpunkt med hjälp av en konfigurationsfil för sessionen och en eller flera rollfunktioner konfigureras WinRM ACL för att tillåta alla användare som mappar till en eller flera roller tillgång till slutpunkten.</span><span class="sxs-lookup"><span data-stu-id="4a526-172">By default, when you register a JEA endpoint using a session configuration file and one or more role capabilities, the WinRM ACL will be configured to allow all users mapping to one or more roles access to the endpoint.</span></span>
<span data-ttu-id="4a526-173">Till exempel en JEA-session som har konfigurerats med hjälp av följande kommandon för att ge fullständig åtkomst till *CONTOSO\JEA\_Lev1* och *CONTOSO\JEA\_Lev2*.</span><span class="sxs-lookup"><span data-stu-id="4a526-173">For example, a JEA session configured using the following commands will grant full access to *CONTOSO\JEA\_Lev1* and *CONTOSO\JEA\_Lev2*.</span></span>

```powershell
$roles = @{ 'CONTOSO\JEA_Lev1' = 'Lev1Role'; 'CONTOSO\JEA_Lev2' = 'Lev2Role' }
New-PSSessionConfigurationFile -Path '.\jea.pssc' -SessionType RestrictedRemoteServer -RoleDefinitions $roles -RunAsVirtualAccount
Register-PSSessionConfiguration -Path '.\jea.pssc' -Name 'MyJEAEndpoint'
```

<span data-ttu-id="4a526-174">Du kan granska användarbehörigheter med den [Get-PSSessionConfiguration](https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.core/get-pssessionconfiguration) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="4a526-174">You can audit user permissions with the [Get-PSSessionConfiguration](https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.core/get-pssessionconfiguration) cmdlet.</span></span>

```powershell
PS C:\> Get-PSSessionConfiguration -Name 'MyJEAEndpoint' | Select-Object Permission

Permission
----------
CONTOSO\JEA_Lev1 AccessAllowed
CONTOSO\JEA_Lev2 AccessAllowed
```

<span data-ttu-id="4a526-175">Om du vill ändra vilka användare som har åtkomst, kör du antingen `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` för en interaktiv prompt eller `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` att uppdatera behörigheterna.</span><span class="sxs-lookup"><span data-stu-id="4a526-175">To change which users have access, run either `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` for an interactive prompt or `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` to update the permissions.</span></span>
<span data-ttu-id="4a526-176">Användare behöver minst *Invoke* behörighet att komma åt JEA-slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="4a526-176">Users need at least *Invoke* rights to access the JEA endpoint.</span></span>

<span data-ttu-id="4a526-177">Om ytterligare användare beviljas åtkomst till JEA-slutpunkt, men inte tillhör någon av de roller som definierats i konfigurationsfilen för sessionen, kommer de att kunna starta en JEA-session men bara har åtkomst till cmdletarna som standard.</span><span class="sxs-lookup"><span data-stu-id="4a526-177">If additional users are granted access to the JEA endpoint but do not fall into any of the roles defined in the session configuration file, they will be able to start a JEA session but only have access to the default cmdlets.</span></span>
<span data-ttu-id="4a526-178">Du kan granska användarbehörigheter i en JEA-slutpunkt genom att köra `Get-PSSessionCapability`.</span><span class="sxs-lookup"><span data-stu-id="4a526-178">You can audit user permissions in a JEA endpoint by running `Get-PSSessionCapability`.</span></span>
<span data-ttu-id="4a526-179">Kolla in den [gransknings- och rapportering i JEA](audit-and-report.md) artikeln för mer information om granskning vilka kommandon en användare har åtkomst till i en JEA-slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="4a526-179">Check out the [Auditing and Reporting on JEA](audit-and-report.md) article for more information about auditing which commands a user has access to in a JEA endpoint.</span></span>

## <a name="least-privilege-roles"></a><span data-ttu-id="4a526-180">Minsta privilegium roller</span><span class="sxs-lookup"><span data-stu-id="4a526-180">Least privilege roles</span></span>

<span data-ttu-id="4a526-181">När du designar JEA roller, är det viktigt att komma ihåg att den virtuella eller gruppen hanterad tjänst-konto som kör i bakgrunden ofta har obegränsad åtkomst för att hantera den lokala datorn.</span><span class="sxs-lookup"><span data-stu-id="4a526-181">When designing JEA roles, it is important to remember that the virtual or group managed service account running behind the scenes often has unrestricted access to manage the local machine.</span></span>
<span data-ttu-id="4a526-182">JEA rollfunktioner i syfte att begränsa vad det kontot kan användas för genom att begränsa de kommandon och program som kan köras med den privilegierade kontexten.</span><span class="sxs-lookup"><span data-stu-id="4a526-182">JEA role capabilities help restrict what that account can be used for by limiting the commands and applications that can be run using that privileged context.</span></span>
<span data-ttu-id="4a526-183">Felaktigt roller kan farliga kommandon som ska köras som kan tillåta en användare att dela ut från JEA-gränser eller få åtkomst till känslig information.</span><span class="sxs-lookup"><span data-stu-id="4a526-183">Improperly designed roles can allow dangerous commands to run that may allow a user to break out of the JEA boundaries or obtain access to sensitive information.</span></span>

<span data-ttu-id="4a526-184">Anta exempelvis att följande roll funktionen post:</span><span class="sxs-lookup"><span data-stu-id="4a526-184">For example, consider the following role capability entry:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\*-Process'
}
```

<span data-ttu-id="4a526-185">Den här rollen-funktionen kan användare köra alla PowerShell-cmdlet med substantiv ”Process” från modulen Microsoft.PowerShell.Management.</span><span class="sxs-lookup"><span data-stu-id="4a526-185">This role capability allows users to run any PowerShell cmdlet with the noun "Process" from the Microsoft.PowerShell.Management module.</span></span>
<span data-ttu-id="4a526-186">Användare kan behöva använda cmdletar som `Get-Process` att förstå vilka program som körs på systemet och `Stop-Process` att avsluta alla program som inte svarar.</span><span class="sxs-lookup"><span data-stu-id="4a526-186">Users may need to access cmdlets like `Get-Process` to understand what applications are running on the system and `Stop-Process` to kill any applications that are not responding.</span></span>
<span data-ttu-id="4a526-187">Den här posten också kan dock `Start-Process`, som kan användas för att starta en godtycklig program med fullständig administratörsbehörighet.</span><span class="sxs-lookup"><span data-stu-id="4a526-187">However, this entry also allows `Start-Process`, which can be used to start up an arbitrary program with full administrator permissions.</span></span>
<span data-ttu-id="4a526-188">Programmet inte behöver installeras lokalt på datorn, så att en angripare kan bara starta ett program på en filresurs som ger de anslutande användarbehörigheter för lokal administratör och kör skadlig kod ”.</span><span class="sxs-lookup"><span data-stu-id="4a526-188">The program doesn't need to be installed locally on the system, so an adversary could simply start a program on a file share that gives the connecting user local admin privileges, runs malware, and more.'</span></span>

<span data-ttu-id="4a526-189">En säkrare version av den här samma roll funktionen ser ut som:</span><span class="sxs-lookup"><span data-stu-id="4a526-189">A more secure version of this same role capability would look like:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\Get-Process', 'Microsoft.PowerShell.Management\Stop-Process'
}
```

<span data-ttu-id="4a526-190">Undvik att använda jokertecken i rollfunktioner och se till att [granska effektiva användarbehörigheter](audit-and-report.md#check-effective-rights-for-a-specific-user) regelbundet att förstå vilka kommandon som en användare har åtkomst till.</span><span class="sxs-lookup"><span data-stu-id="4a526-190">Avoid using wildcards in role capabilities, and be sure to [audit effective user permissions](audit-and-report.md#check-effective-rights-for-a-specific-user) regularly to understand which commands a user has access to.</span></span>

## <a name="jea-does-not-protect-against-admins"></a><span data-ttu-id="4a526-191">JEA skyddar inte mot administratörer</span><span class="sxs-lookup"><span data-stu-id="4a526-191">JEA does not protect against admins</span></span>

<span data-ttu-id="4a526-192">En av huvudprinciperna för JEA är möjligheten för icke-administratörer att utföra *vissa* administrativa uppgifter.</span><span class="sxs-lookup"><span data-stu-id="4a526-192">One of the core principles of JEA is that it allows non-admins to perform *some* admin tasks.</span></span>
<span data-ttu-id="4a526-193">JEA skyddar inte mot de som redan har administratörsbehörighet.</span><span class="sxs-lookup"><span data-stu-id="4a526-193">JEA does not protect against those who already have administrator privileges.</span></span>
<span data-ttu-id="4a526-194">Användare som tillhör ”Domänadministratörer”, ”lokala administratörer”, eller andra mycket Privilegierade grupper i din miljö kommer fortfarande att kunna komma runt JEAS skydd genom att logga in på datorn via ett annat sätt.</span><span class="sxs-lookup"><span data-stu-id="4a526-194">Users who belong "domain admins," "local admins," or other highly privileged groups in your environment will still be able to get around JEA's protections by signing into the machine via another means.</span></span>
<span data-ttu-id="4a526-195">De kan till exempel logga in med RDP, använda fjärranslutna MMC-konsoler eller ansluta till obegränsad PowerShell-slutpunkter.</span><span class="sxs-lookup"><span data-stu-id="4a526-195">They could, for example, sign in with RDP, use remote MMC consoles, or connect to unconstrained PowerShell endpoints.</span></span>
<span data-ttu-id="4a526-196">Lokala administratörer på systemet kan också ändra JEA-konfigurationer för att tillåta ytterligare användare att hantera systemet eller ändra en roll-funktion för att utöka omfånget för en användare kan göra i sina JEA-session.</span><span class="sxs-lookup"><span data-stu-id="4a526-196">Local admins on the system can also modify JEA configurations to allow additional users to manage the system or change a role capability to extend the scope of what a user can do in their JEA session.</span></span>
<span data-ttu-id="4a526-197">Det är därför viktigt att utvärdera JEA användarnas utökade behörigheter för att se om det finns andra sätt som de kan få privilegierad åtkomst till systemet.</span><span class="sxs-lookup"><span data-stu-id="4a526-197">It is therefore important to evaluate your JEA users' extended permissions to see if there are other ways they could gain privileged access to the system.</span></span>

<span data-ttu-id="4a526-198">En vanlig metod är att använda JEA för vanliga dagliga underhåll och har ”just in-time” privilegierad åtkomsthanteringslösning kan du tillfälligt blir lokala administratörer i nödsituationer.</span><span class="sxs-lookup"><span data-stu-id="4a526-198">A common practice is to use JEA for regular day-to-day maintenance and have a "just in time" privileged access management solution allow users to temporarily become local admins in emergency situations.</span></span>
<span data-ttu-id="4a526-199">Detta hjälper till att säkerställa användare inte är permanenta administratörer på systemet, men kan hämta dessa rättigheter om och när de utföra ett arbetsflöde som dokument deras användning av dessa behörigheter.</span><span class="sxs-lookup"><span data-stu-id="4a526-199">This helps ensure users are not permanent admins on the system, but can get those rights if, and only when, they complete a workflow that documents their use of those permissions.</span></span>
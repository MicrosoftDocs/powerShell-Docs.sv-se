---
title: Uppmuntras utveckling riktlinjer | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 4d68a8f3-fba0-44c5-97b9-9fc191d269a5
caps.latest.revision: 13
ms.openlocfilehash: 0906d0d37c66b8c1538a0b2e9e0f1ff2fba12ac0
ms.sourcegitcommit: caac7d098a448232304c9d6728e7340ec7517a71
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 03/16/2019
ms.locfileid: "58057730"
---
# <a name="strongly-encouraged-development-guidelines"></a><span data-ttu-id="89356-102">Starkt rekommenderade riktlinjer för utveckling</span><span class="sxs-lookup"><span data-stu-id="89356-102">Strongly Encouraged Development Guidelines</span></span>

<span data-ttu-id="89356-103">Det här avsnittet beskriver riktlinjer som du bör följa när du skriver dina cmdlets.</span><span class="sxs-lookup"><span data-stu-id="89356-103">This section describes guidelines that you should follow when you write your cmdlets.</span></span> <span data-ttu-id="89356-104">De är indelade i riktlinjer för att utforma cmdlets och riktlinjer för att skriva cmdlet-kod.</span><span class="sxs-lookup"><span data-stu-id="89356-104">They are separated into guidelines for designing cmdlets and guidelines for writing your cmdlet code.</span></span> <span data-ttu-id="89356-105">Du kanske upptäcker att riktlinjerna inte kan användas för alla scenarier.</span><span class="sxs-lookup"><span data-stu-id="89356-105">You might find that these guidelines are not applicable for every scenario.</span></span> <span data-ttu-id="89356-106">Men om de gäller och du inte följer dessa riktlinjer kan kan dina användare ha en dålig upplevelse när de använder dina cmdlets.</span><span class="sxs-lookup"><span data-stu-id="89356-106">However, if they do apply and you do not follow these guidelines, your users might have a poor experience when they use your cmdlets.</span></span>

## <a name="design-guidelines"></a><span data-ttu-id="89356-107">Designriktlinjer</span><span class="sxs-lookup"><span data-stu-id="89356-107">Design Guidelines</span></span>

- [<span data-ttu-id="89356-108">Använda en specifik substantiv för en Cmdlet-namn (SD01)</span><span class="sxs-lookup"><span data-stu-id="89356-108">Use a Specific Noun for a Cmdlet Name (SD01)</span></span>](./strongly-encouraged-development-guidelines.md#use-a-specific-noun-for-a-cmdlet-name-sd01)

- [<span data-ttu-id="89356-109">Använd Pascalnotation för Cmdlet-namnen (SD02)</span><span class="sxs-lookup"><span data-stu-id="89356-109">Use Pascal Case for Cmdlet Names (SD02)</span></span>](./strongly-encouraged-development-guidelines.md#use-pascal-case-for-cmdlet-names-sd02)

- [<span data-ttu-id="89356-110">Designriktlinjer för parametern (SD03)</span><span class="sxs-lookup"><span data-stu-id="89356-110">Parameter Design Guidelines (SD03)</span></span>](./strongly-encouraged-development-guidelines.md#parameter-design-guidelines-sd03)

- [<span data-ttu-id="89356-111">Ge Feedback till användaren (SD04)</span><span class="sxs-lookup"><span data-stu-id="89356-111">Provide Feedback to the User (SD04)</span></span>](./strongly-encouraged-development-guidelines.md#provide-feedback-to-the-user-sd04)

- [<span data-ttu-id="89356-112">Skapa en Cmdlet-hjälpavsnitten-fil (SD05)</span><span class="sxs-lookup"><span data-stu-id="89356-112">Create a Cmdlet Help File (SD05)</span></span>](./strongly-encouraged-development-guidelines.md#create-a-cmdlet-help-file-sd05)

## <a name="code-guidelines"></a><span data-ttu-id="89356-113">Riktlinjer för kod</span><span class="sxs-lookup"><span data-stu-id="89356-113">Code Guidelines</span></span>

- [<span data-ttu-id="89356-114">Koda parametrar (SC01)</span><span class="sxs-lookup"><span data-stu-id="89356-114">Coding Parameters (SC01)</span></span>](./strongly-encouraged-development-guidelines.md#coding-parameters-sc01)

- [<span data-ttu-id="89356-115">Stöd för väldefinierade Pipeline-indata (SC02)</span><span class="sxs-lookup"><span data-stu-id="89356-115">Support Well Defined Pipeline Input (SC02)</span></span>](./strongly-encouraged-development-guidelines.md#support-well-defined-pipeline-input-sc02)

- [<span data-ttu-id="89356-116">Skriva enskild poster till pipelinen (SC03)</span><span class="sxs-lookup"><span data-stu-id="89356-116">Write Single Records to the Pipeline (SC03)</span></span>](./strongly-encouraged-development-guidelines.md#write-single-records-to-the-pipeline-sc03)

- [<span data-ttu-id="89356-117">Kontrollera cmdletarna skiftlägeskänsliga och bevara (SC04)</span><span class="sxs-lookup"><span data-stu-id="89356-117">Make Cmdlets Case-Insensitive and Case-Preserving (SC04)</span></span>](./strongly-encouraged-development-guidelines.md#make-cmdlets-case-insensitive-and-case-preserving-sc04)

## <a name="design-guidelines"></a><span data-ttu-id="89356-118">Designriktlinjer</span><span class="sxs-lookup"><span data-stu-id="89356-118">Design Guidelines</span></span>

<span data-ttu-id="89356-119">Följande riktlinjer ska följas när du utformar cmdletar för att säkerställa en konsekvent användarupplevelse mellan att använda dina cmdlets och andra cmdlet: ar.</span><span class="sxs-lookup"><span data-stu-id="89356-119">The following guidelines should be followed when designing cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="89356-120">När du har hittat en Design riktlinje som gäller för din situation bör du titta på koden riktlinjer för liknande riktlinjer.</span><span class="sxs-lookup"><span data-stu-id="89356-120">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="use-a-specific-noun-for-a-cmdlet-name-sd01"></a><span data-ttu-id="89356-121">Använda en specifik substantiv för en Cmdlet-namn (SD01)</span><span class="sxs-lookup"><span data-stu-id="89356-121">Use a Specific Noun for a Cmdlet Name (SD01)</span></span>

<span data-ttu-id="89356-122">Substantiv som används i namngivning av cmdlet: en måste vara mycket specifik så att användaren kan identifiera dina cmdlets.</span><span class="sxs-lookup"><span data-stu-id="89356-122">Nouns used in cmdlet naming need to be very specific so that the user can discover your cmdlets.</span></span> <span data-ttu-id="89356-123">Prefixet allmän substantiv, till exempel ”server” med en förkortad version av produktens namn.</span><span class="sxs-lookup"><span data-stu-id="89356-123">Prefix generic nouns such as "server" with a shortened version of the product name.</span></span> <span data-ttu-id="89356-124">Till exempel om ett substantiv refererar till en server som kör en instans av Microsoft SQL Server, använda ett substantiv, till exempel ”SQLServer”.</span><span class="sxs-lookup"><span data-stu-id="89356-124">For example, if a noun refers to a server that is running an instance of Microsoft SQL Server, use a noun such as "SQLServer".</span></span> <span data-ttu-id="89356-125">Kombinationen av specifika substantiv och en kort lista över godkända verb gör att användaren kan snabbt identifiera och förutse funktioner samtidigt som du undviker duplicering bland cmdlet-namnen.</span><span class="sxs-lookup"><span data-stu-id="89356-125">The combination of specific nouns and the short list of approved verbs enable the user to quickly discover and anticipate functionality while avoiding duplication among cmdlet names.</span></span>

<span data-ttu-id="89356-126">För att förbättra användarupplevelsen, ska substantiv som du väljer för en cmdlet-namn rapportanvändare.</span><span class="sxs-lookup"><span data-stu-id="89356-126">To enhance the user experience, the noun that you choose for a cmdlet name should be singular.</span></span> <span data-ttu-id="89356-127">Till exempel använda namnet `Get-Process` i stället för **Get-processer**.</span><span class="sxs-lookup"><span data-stu-id="89356-127">For example, use the name `Get-Process` instead of **Get-Processes**.</span></span> <span data-ttu-id="89356-128">Det är bäst att följa den här regeln för alla cmdlet-namn, även när en cmdlet kommer troligen att agera på mer än ett objekt.</span><span class="sxs-lookup"><span data-stu-id="89356-128">It is best to follow this rule for all cmdlet names, even when a cmdlet is likely to act upon more than one item.</span></span>

### <a name="use-pascal-case-for-cmdlet-names-sd02"></a><span data-ttu-id="89356-129">Använd Pascalnotation för Cmdlet-namnen (SD02)</span><span class="sxs-lookup"><span data-stu-id="89356-129">Use Pascal Case for Cmdlet Names (SD02)</span></span>

<span data-ttu-id="89356-130">Använd pascalnotation för parameternamn.</span><span class="sxs-lookup"><span data-stu-id="89356-130">Use Pascal case for parameter names.</span></span> <span data-ttu-id="89356-131">Med andra ord med versal verb och alla termer som används i substantivet.</span><span class="sxs-lookup"><span data-stu-id="89356-131">In other words, capitalize the first letter of verb and all terms used in the noun.</span></span> <span data-ttu-id="89356-132">Till exempel ”`Clear-ItemProperty`”.</span><span class="sxs-lookup"><span data-stu-id="89356-132">For example, "`Clear-ItemProperty`".</span></span>

### <a name="parameter-design-guidelines-sd03"></a><span data-ttu-id="89356-133">Designriktlinjer för parametern (SD03)</span><span class="sxs-lookup"><span data-stu-id="89356-133">Parameter Design Guidelines (SD03)</span></span>

<span data-ttu-id="89356-134">En cmdlet måste parametrarna som tar emot data måste köra och parametrar som visar information som används för att fastställa egenskaperna för åtgärden.</span><span class="sxs-lookup"><span data-stu-id="89356-134">A cmdlet needs parameters that receive the data on which it must operate, and parameters that indicate information that is used to determine the characteristics of the operation.</span></span> <span data-ttu-id="89356-135">En cmdlet kan till exempel ha en `Name` parameter som tar emot data från pipelinen och cmdleten kan ha en `Force` parameter som anger att cmdleten kan tvingas att utföra åtgärden.</span><span class="sxs-lookup"><span data-stu-id="89356-135">For example, a cmdlet might have a `Name` parameter that receives data from the pipeline, and the cmdlet might have a `Force` parameter to indicate that the cmdlet can be forced to perform its operation.</span></span> <span data-ttu-id="89356-136">Det finns ingen gräns för antalet parametrar som en cmdlet kan definiera.</span><span class="sxs-lookup"><span data-stu-id="89356-136">There is no limit to the number of parameters that a cmdlet can define.</span></span>

#### <a name="use-standard-parameter-names"></a><span data-ttu-id="89356-137">Använd Standard parameternamn</span><span class="sxs-lookup"><span data-stu-id="89356-137">Use Standard Parameter Names</span></span>

<span data-ttu-id="89356-138">Cmdlet: bör använda standard parameternamn, så att du snabbt kan fastställa vad en viss parameter innebär.</span><span class="sxs-lookup"><span data-stu-id="89356-138">Your cmdlet should use standard parameter names so that the user can quickly determine what a particular parameter means.</span></span> <span data-ttu-id="89356-139">Om en mer specifik namn måste anges, använda ett standard parameternamn och anger sedan ett mer specifika namn som ett alias.</span><span class="sxs-lookup"><span data-stu-id="89356-139">If a more specific name is required, use a standard parameter name, and then specify a more specific name as an alias.</span></span> <span data-ttu-id="89356-140">Till exempel den `Get-Service` cmdleten har en parameter som har ett allmänt namn (`Name`) och en mer specifik alias (`ServiceName`).</span><span class="sxs-lookup"><span data-stu-id="89356-140">For example, the `Get-Service` cmdlet has a  parameter that has a generic name (`Name`) and a more specific alias (`ServiceName`).</span></span> <span data-ttu-id="89356-141">Båda termerna kan användas för att ange parametern.</span><span class="sxs-lookup"><span data-stu-id="89356-141">Both terms can be used to specify the parameter.</span></span>

<span data-ttu-id="89356-142">Läs mer om parameternamn och datatyperna [Cmdlet parameternamnet och funktioner riktlinjer](./standard-cmdlet-parameter-names-and-types.md).</span><span class="sxs-lookup"><span data-stu-id="89356-142">For more information about parameter names and their data types, see [Cmdlet Parameter Name and Functionality Guidelines](./standard-cmdlet-parameter-names-and-types.md).</span></span>

#### <a name="use-singular-parameter-names"></a><span data-ttu-id="89356-143">Använd rapportanvändare parameternamn</span><span class="sxs-lookup"><span data-stu-id="89356-143">Use Singular Parameter Names</span></span>

<span data-ttu-id="89356-144">Undvik att använda plural namn för parametrar som vars värde är ett enda element.</span><span class="sxs-lookup"><span data-stu-id="89356-144">Avoid using plural names for parameters whose value is a single element.</span></span> <span data-ttu-id="89356-145">Detta omfattar parametrar som tar matriser eller listar eftersom användaren kan ange en matris eller en lista med bara ett element.</span><span class="sxs-lookup"><span data-stu-id="89356-145">This includes parameters that take arrays or lists because the user might supply an array or list with only one element.</span></span>

<span data-ttu-id="89356-146">Plural parameternamn ska användas endast i de fall där värdet för parametern är alltid ett värde för flera element.</span><span class="sxs-lookup"><span data-stu-id="89356-146">Plural parameter names should be used only in those cases where the value of the parameter is always a multiple-element value.</span></span> <span data-ttu-id="89356-147">I dessa fall bör du kontrollera att flera element distribueras utan att cmdleten ska visa en varning till användaren om flera element inte levereras cmdlet: en.</span><span class="sxs-lookup"><span data-stu-id="89356-147">In these cases, the cmdlet should verify that multiple elements are supplied, and the cmdlet should display a warning to the user if multiple elements are not supplied.</span></span>

#### <a name="use-pascal-case-for-parameter-names"></a><span data-ttu-id="89356-148">Använd Pascalnotation för parameternamn</span><span class="sxs-lookup"><span data-stu-id="89356-148">Use Pascal Case for Parameter Names</span></span>

<span data-ttu-id="89356-149">Använd pascalnotation för parameternamn.</span><span class="sxs-lookup"><span data-stu-id="89356-149">Use Pascal case for parameter names.</span></span> <span data-ttu-id="89356-150">Med andra ord med versal i varje ord i parameternamn, inklusive den första bokstaven i namnet.</span><span class="sxs-lookup"><span data-stu-id="89356-150">In other words, capitalize the first letter of each word in the parameter name, including the first letter of the name.</span></span> <span data-ttu-id="89356-151">Till exempel parameternamnet `ErrorAction` använder Korrigera versaler.</span><span class="sxs-lookup"><span data-stu-id="89356-151">For example, the parameter name `ErrorAction` uses the correct capitalization.</span></span> <span data-ttu-id="89356-152">I följande parameternamnen Använd felaktiga versaler:</span><span class="sxs-lookup"><span data-stu-id="89356-152">The following parameter names use incorrect capitalization:</span></span>

- `errorAction`

- `erroraction`

#### <a name="parameters-that-take-a-list-of-options"></a><span data-ttu-id="89356-153">Parametrar som tar en lista med alternativ</span><span class="sxs-lookup"><span data-stu-id="89356-153">Parameters That Take a List of Options</span></span>

<span data-ttu-id="89356-154">Det finns två sätt att skapa en parameter vars värde kan väljas från en uppsättning med alternativ.</span><span class="sxs-lookup"><span data-stu-id="89356-154">There are two ways to create a parameter whose value can be selected from a set of options.</span></span>

- <span data-ttu-id="89356-155">Definiera en uppräkningstyp (eller använda en befintlig uppräkningstyp) som anger de giltiga värdena.</span><span class="sxs-lookup"><span data-stu-id="89356-155">Define an enumeration type (or use an existing enumeration type) that specifies the valid values.</span></span> <span data-ttu-id="89356-156">Sedan Använd uppräkningstypen för att skapa en parameter av den typen.</span><span class="sxs-lookup"><span data-stu-id="89356-156">Then, use the enumeration type to create a parameter of that type.</span></span>

- <span data-ttu-id="89356-157">Lägg till den **ValidateSet** attributet Parameterdeklarationen.</span><span class="sxs-lookup"><span data-stu-id="89356-157">Add the **ValidateSet** attribute to the parameter declaration.</span></span> <span data-ttu-id="89356-158">Läs mer om det här attributet [ValidateSet attributet deklarationen](./validateset-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="89356-158">For more information about this attribute, see [ValidateSet Attribute Declaration](./validateset-attribute-declaration.md).</span></span>

#### <a name="use-standard-types-for-parameters"></a><span data-ttu-id="89356-159">Använd Standard typer för parametrar</span><span class="sxs-lookup"><span data-stu-id="89356-159">Use Standard Types for Parameters</span></span>

<span data-ttu-id="89356-160">Använda standard typer för parametrar för att säkerställa konsekvens med andra cmdlet: ar, där ända möjligt.</span><span class="sxs-lookup"><span data-stu-id="89356-160">To ensure consistency with other cmdlets, use standard types for parameters where ever possible.</span></span> <span data-ttu-id="89356-161">Läs mer om vilka typer som ska användas för olika parametern [Standard Cmdlet parameternamn och typer](./standard-cmdlet-parameter-names-and-types.md).</span><span class="sxs-lookup"><span data-stu-id="89356-161">For more information about the types that should be used for different parameter, see [Standard Cmdlet Parameter Names and Types](./standard-cmdlet-parameter-names-and-types.md).</span></span> <span data-ttu-id="89356-162">Det här avsnittet innehåller länkar till flera avsnitt som beskriver namn och .NET Framework-typer för grupper av standard parametrar, till exempel ”aktivitetsparametrar”.</span><span class="sxs-lookup"><span data-stu-id="89356-162">This topic provides links to several topics that describe the names and .NET Framework types for groups of standard parameters, such as the "activity parameters".</span></span>

#### <a name="use-strongly-typed-net-framework-types"></a><span data-ttu-id="89356-163">Använda starkt typifierade .NET Framework-typer</span><span class="sxs-lookup"><span data-stu-id="89356-163">Use Strongly-Typed .NET Framework Types</span></span>

<span data-ttu-id="89356-164">Parametrar ska definieras som .NET Framework-typer för att ge bättre parameterverifieringen.</span><span class="sxs-lookup"><span data-stu-id="89356-164">Parameters should be defined as .NET Framework types to provide better parameter validation.</span></span> <span data-ttu-id="89356-165">Till exempel ska parametrar som är begränsad till ett värde från en uppsättning värden vara definierat som en uppräkningstyp.</span><span class="sxs-lookup"><span data-stu-id="89356-165">For example, parameters that are restricted to one value from a set of values should be defined as an enumeration type.</span></span> <span data-ttu-id="89356-166">För ett värde för ID: T URI (Uniform Resource) måste definiera parametern som ett [System.Uri](/dotnet/api/System.Uri) typen.</span><span class="sxs-lookup"><span data-stu-id="89356-166">To support a Uniform Resource Identifier (URI) value, define the parameter as a [System.Uri](/dotnet/api/System.Uri) type.</span></span> <span data-ttu-id="89356-167">Undvik grundläggande strängparametrar för allt utom friformsarbetsyta textegenskaper.</span><span class="sxs-lookup"><span data-stu-id="89356-167">Avoid basic string parameters for all but free-form text properties.</span></span>

#### <a name="use-consistent-parameter-types"></a><span data-ttu-id="89356-168">Använd konsekvent parametertyper</span><span class="sxs-lookup"><span data-stu-id="89356-168">Use Consistent Parameter Types</span></span>

<span data-ttu-id="89356-169">När samma parameter används av flera cmdlets, Använd alltid samma parametertypen.</span><span class="sxs-lookup"><span data-stu-id="89356-169">When the same parameter is used by multiple cmdlets, always use the same parameter type.</span></span>  <span data-ttu-id="89356-170">Till exempel om den `Process` parametern är en [System.Int16](/dotnet/api/System.Int16) skriver för en cmdlet, ska du inte göra den `Process` parameter för en annan cmdlet en [System.Uint16](/dotnet/api/System.UInt16) typen.</span><span class="sxs-lookup"><span data-stu-id="89356-170">For example, if the `Process` parameter is an [System.Int16](/dotnet/api/System.Int16) type for one cmdlet, do not make the `Process` parameter for another cmdlet a [System.Uint16](/dotnet/api/System.UInt16) type.</span></span>

#### <a name="parameters-that-take-true-and-false"></a><span data-ttu-id="89356-171">Parametrar som tar värdet är True och False</span><span class="sxs-lookup"><span data-stu-id="89356-171">Parameters That Take True and False</span></span>

<span data-ttu-id="89356-172">Om parametern tar endast `true` och `false`, definiera parametern som typen [System.Management.Automation.SwitchParameter](/dotnet/api/System.Management.Automation.SwitchParameter).</span><span class="sxs-lookup"><span data-stu-id="89356-172">If your parameter takes only `true` and `false`, define the parameter as type [System.Management.Automation.SwitchParameter](/dotnet/api/System.Management.Automation.SwitchParameter).</span></span> <span data-ttu-id="89356-173">En växlingsparametern behandlas som `true` när det anges i ett kommando.</span><span class="sxs-lookup"><span data-stu-id="89356-173">A switch parameter is treated as `true` when it is specified in a command.</span></span> <span data-ttu-id="89356-174">Om parametern inte ingår i ett kommando, Windows PowerShell tar hänsyn till värdet för parametern ska vara `false`.</span><span class="sxs-lookup"><span data-stu-id="89356-174">If the parameter is not included in a command, Windows PowerShell considers the value of the parameter to be `false`.</span></span> <span data-ttu-id="89356-175">Definiera inte booleskt parametrar.</span><span class="sxs-lookup"><span data-stu-id="89356-175">Do not define Boolean parameters.</span></span>

<span data-ttu-id="89356-176">Om parametern måste skilja mellan 3 värden: $true, $false och ”okänt”, sedan definierar en parameter av typen kan ha värdet null\<bool >.</span><span class="sxs-lookup"><span data-stu-id="89356-176">If your parameter needs to differentiate between 3 values: $true, $false and "unspecified", then define a parameter of type Nullable\<bool>.</span></span>  <span data-ttu-id="89356-177">Behovet av en 3, ”okänt” värde uppstår vanligen när cmdlet: en kan ändra en boolesk egenskap för ett objekt.</span><span class="sxs-lookup"><span data-stu-id="89356-177">The need for a 3rd, "unspecified" value typically occurs when the cmdlet can modify a Boolean property of an object.</span></span> <span data-ttu-id="89356-178">I det här fallet ”okänt” innebär att inte ändra det aktuella värdet för egenskapen.</span><span class="sxs-lookup"><span data-stu-id="89356-178">In this case "unspecified" means to not change the current value of the property.</span></span>

#### <a name="support-arrays-for-parameters"></a><span data-ttu-id="89356-179">Stöd för matriser för parametrar</span><span class="sxs-lookup"><span data-stu-id="89356-179">Support Arrays for Parameters</span></span>

<span data-ttu-id="89356-180">Användare måste ofta kan utföra samma åtgärd mot flera argument.</span><span class="sxs-lookup"><span data-stu-id="89356-180">Frequently, users must perform the same operation against multiple arguments.</span></span> <span data-ttu-id="89356-181">Dessa användare bör en cmdlet accepterar en matris som parameter som indata så att en användare kan skicka argumenten till parametern som en Windows PowerShell-variabel.</span><span class="sxs-lookup"><span data-stu-id="89356-181">For these users, a cmdlet should accept an array as parameter input so that a user can pass the arguments into the parameter as a Windows PowerShell variable.</span></span> <span data-ttu-id="89356-182">Till exempel den [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) cmdlet: en använder en matris för strängar som identifierar namnen på processerna som ska hämtas.</span><span class="sxs-lookup"><span data-stu-id="89356-182">For example, the [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) cmdlet uses an array for the strings that identify the names of the processes to retrieve.</span></span>

#### <a name="support-the-passthru-parameter"></a><span data-ttu-id="89356-183">Stöd för PassThru-parametern</span><span class="sxs-lookup"><span data-stu-id="89356-183">Support the PassThru Parameter</span></span>

<span data-ttu-id="89356-184">Som standard många cmdletar som ändrar systemet, till exempel den [Stop-Process](/powershell/module/Microsoft.PowerShell.Management/Stop-Process) cmdlet, fungerar som ”mottagare” för objekt och inte returnerar ett resultat.</span><span class="sxs-lookup"><span data-stu-id="89356-184">By default, many cmdlets that modify the system, such as the [Stop-Process](/powershell/module/Microsoft.PowerShell.Management/Stop-Process) cmdlet, act as "sinks" for objects and do not return a result.</span></span> <span data-ttu-id="89356-185">Dessa cmdlet: en ska implementera den `PassThru` parameter för att tvinga cmdlet för att returnera ett-objekt.</span><span class="sxs-lookup"><span data-stu-id="89356-185">These cmdlet should implement the `PassThru` parameter to force the cmdlet to return an object.</span></span> <span data-ttu-id="89356-186">När den `PassThru` parameter har angetts, cmdleten returnerar ett objekt med hjälp av ett anrop till den [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) metod.</span><span class="sxs-lookup"><span data-stu-id="89356-186">When the `PassThru` parameter is specified, the cmdlet returns an object by using a call to the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="89356-187">Följande kommando stoppar Calc-processen och skickar den resulterande processen till transportledningen.</span><span class="sxs-lookup"><span data-stu-id="89356-187">For example, the following command stops the Calc process and passes the resultant process to the pipeline.</span></span>

```powershell
Stop-Process calc -passthru
```

<span data-ttu-id="89356-188">I de flesta fall Lägg till, uppsättning och nya cmdlets ska ha stöd för en `PassThru` parametern.</span><span class="sxs-lookup"><span data-stu-id="89356-188">In most cases, Add, Set, and New cmdlets should support a `PassThru` parameter.</span></span>

#### <a name="support-parameter-sets"></a><span data-ttu-id="89356-189">Stöd för parameteruppsättningar</span><span class="sxs-lookup"><span data-stu-id="89356-189">Support Parameter Sets</span></span>

<span data-ttu-id="89356-190">En cmdlet är avsedd att göra ett enda syfte.</span><span class="sxs-lookup"><span data-stu-id="89356-190">A cmdlet is intended to accomplish a single purpose.</span></span> <span data-ttu-id="89356-191">Det finns dock ofta flera olika sätt att beskriva det eller åtgärdsmål.</span><span class="sxs-lookup"><span data-stu-id="89356-191">However, there is frequently more than one way to describe the operation or the operation target.</span></span> <span data-ttu-id="89356-192">Till exempel kan en process identifieras av dess namn, dess identifierare eller ett processobjekt.</span><span class="sxs-lookup"><span data-stu-id="89356-192">For example, a process might be identified by its name, by its identifier, or by a process object.</span></span> <span data-ttu-id="89356-193">Cmdlet: en ska ha stöd för alla rimliga framställningar av dess mål.</span><span class="sxs-lookup"><span data-stu-id="89356-193">The cmdlet should support all the reasonable representations of its targets.</span></span> <span data-ttu-id="89356-194">Normalt sett uppfyller det här kravet genom att ange uppsättningar med parametrar som (kallas parameteruppsättningar) som fungerar tillsammans med cmdlet: en.</span><span class="sxs-lookup"><span data-stu-id="89356-194">Normally, the cmdlet satisfies this requirement by specifying sets of parameters (referred to as parameter sets) that operate together.</span></span> <span data-ttu-id="89356-195">En parameter kan höra till valfritt antal parameteruppsättningar.</span><span class="sxs-lookup"><span data-stu-id="89356-195">A single parameter can belong to any number of parameter sets.</span></span> <span data-ttu-id="89356-196">Läs mer om parameteruppsättningar [cmdlet: en Parameter anger](./cmdlet-parameter-sets.md).</span><span class="sxs-lookup"><span data-stu-id="89356-196">For more information about parameter sets, see [Cmdlet Parameter Sets](./cmdlet-parameter-sets.md).</span></span>

<span data-ttu-id="89356-197">När du anger parameteruppsättningar, ange endast en parameter i inställt ValueFromPipeline.</span><span class="sxs-lookup"><span data-stu-id="89356-197">When you specify parameter sets, set only one parameter in the set to ValueFromPipeline.</span></span> <span data-ttu-id="89356-198">Mer information om hur du deklarera den **parametern** attributet, se [ParameterAttribute deklarationen](./parameter-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="89356-198">For more information about how to declare the **Parameter** attribute, see [ParameterAttribute Declaration](./parameter-attribute-declaration.md).</span></span>

<span data-ttu-id="89356-199">När parameteruppsättningar används standard-parameteruppsättningen definieras av den **Cmdlet** attribut.</span><span class="sxs-lookup"><span data-stu-id="89356-199">When parameter sets are used, the default parameter set is defined by the **Cmdlet** attribute.</span></span> <span data-ttu-id="89356-200">Standard-parameteruppsättningen ska innehålla parametrarna som sannolikt kommer att användas i en interaktiv Windows PowerShell-session.</span><span class="sxs-lookup"><span data-stu-id="89356-200">The default parameter set should include the parameters most likely to be used in an interactive Windows PowerShell session.</span></span> <span data-ttu-id="89356-201">Mer information om hur du deklarera den **Cmdlet** attributet, se [CmdletAttribute deklarationen](./cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="89356-201">For more information about how to declare the **Cmdlet** attribute, see [CmdletAttribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

### <a name="provide-feedback-to-the-user-sd04"></a><span data-ttu-id="89356-202">Ge Feedback till användaren (SD04)</span><span class="sxs-lookup"><span data-stu-id="89356-202">Provide Feedback to the User (SD04)</span></span>

<span data-ttu-id="89356-203">Använd riktlinjer i det här avsnittet för att ge feedback till användaren.</span><span class="sxs-lookup"><span data-stu-id="89356-203">Use the guidelines in this section to provide feedback to the user.</span></span> <span data-ttu-id="89356-204">Denna feedback gör att användaren ska vara medveten om vad som händer i systemet och fatta bättre administrativ.</span><span class="sxs-lookup"><span data-stu-id="89356-204">This feedback allows the user to be aware of what is occurring in the system and to make better administrative decisions.</span></span>

<span data-ttu-id="89356-205">Windows PowerShell-runtime gör att användaren kan ange hur du hanterar utdata från varje anrop till den `Write` metoden genom att ange en inställningsvariabeln.</span><span class="sxs-lookup"><span data-stu-id="89356-205">The Windows PowerShell runtime allows a user to specify how to handle output from each call to the `Write` method by setting a preference variable.</span></span> <span data-ttu-id="89356-206">Användaren kan ange flera inställningsvariabler, inklusive en variabel som avgör om systemet ska visa information och en variabel som avgör huruvida systemet ska fråga användaren innan du vidtar ytterligare åtgärder.</span><span class="sxs-lookup"><span data-stu-id="89356-206">The user can set several preference variables, including a variable that determines whether the system should display information and a variable that determines whether the system should query the user before taking further action.</span></span>

#### <a name="support-the-writewarning-writeverbose-and-writedebug-methods"></a><span data-ttu-id="89356-207">Stöd för WriteWarning, WriteVerbose och WriteDebug metoder</span><span class="sxs-lookup"><span data-stu-id="89356-207">Support the WriteWarning, WriteVerbose, and WriteDebug Methods</span></span>

<span data-ttu-id="89356-208">En cmdlet ska anropa den [System.Management.Automation.Cmdlet.WriteWarning](/dotnet/api/System.Management.Automation.Cmdlet.WriteWarning) metod när cmdleten ska utföra en åtgärd som kan ha ett oönskade resultat.</span><span class="sxs-lookup"><span data-stu-id="89356-208">A cmdlet should call the [System.Management.Automation.Cmdlet.WriteWarning](/dotnet/api/System.Management.Automation.Cmdlet.WriteWarning) method when the cmdlet is about to perform an operation that might have an unintended result.</span></span> <span data-ttu-id="89356-209">En cmdlet ska anropa den här metoden om cmdlet: en är att skriva över en skrivskyddad fil.</span><span class="sxs-lookup"><span data-stu-id="89356-209">For example, a cmdlet should call this method if the cmdlet is about to overwrite a read-only file.</span></span>

<span data-ttu-id="89356-210">En cmdlet ska anropa den [System.Management.Automation.Cmdlet.WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) metod när användaren kräver detalj diskutera vad cmdleten gör.</span><span class="sxs-lookup"><span data-stu-id="89356-210">A cmdlet should call the [System.Management.Automation.Cmdlet.WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) method when the user requires some detail about what the cmdlet is doing.</span></span> <span data-ttu-id="89356-211">En cmdlet ska anropa den här informationen om cmdleten författaren anser att det finns scenarier som kan kräva mer information om vad cmdleten gör.</span><span class="sxs-lookup"><span data-stu-id="89356-211">For example, a cmdlet should call this information if the cmdlet author feels that there are scenarios that might require more information about what the cmdlet is doing.</span></span>

<span data-ttu-id="89356-212">Cmdlet: en ska anropa den [System.Management.Automation.Cmdlet.WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) metod när en utvecklare eller produkten supporttekniker måste förstå vad har skadat cmdlet igen.</span><span class="sxs-lookup"><span data-stu-id="89356-212">The cmdlet should call the [System.Management.Automation.Cmdlet.WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) method when a developer or product support engineer must understand what has corrupted the cmdlet operation.</span></span> <span data-ttu-id="89356-213">Det är inte nödvändigt för cmdleten att anropa den [System.Management.Automation.Cmdlet.WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) -metod i samma kod som anropar den [System.Management.Automation.Cmdlet.WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) metod eftersom den `Debug` parametern anger båda uppsättningarna information.</span><span class="sxs-lookup"><span data-stu-id="89356-213">It is not necessary for the cmdlet to call the [System.Management.Automation.Cmdlet.WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) method in the same code that calls the [System.Management.Automation.Cmdlet.WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) method because the `Debug` parameter presents both sets of information.</span></span>

#### <a name="support-writeprogress-for-operations-that-take-a-long-time"></a><span data-ttu-id="89356-214">Stöd för WriteProgress för åtgärder som tar lång tid</span><span class="sxs-lookup"><span data-stu-id="89356-214">Support WriteProgress for Operations that take a Long Time</span></span>

<span data-ttu-id="89356-215">Cmdlet-åtgärder som tar lång tid att slutföra och som inte kan köras i bakgrunden ska ha stöd för statusrapportering via periodiska anrop till den [System.Management.Automation.Cmdlet.WriteProgress](/dotnet/api/System.Management.Automation.Cmdlet.WriteProgress) metod.</span><span class="sxs-lookup"><span data-stu-id="89356-215">Cmdlet operations that take a long time to complete and that cannot run in the background should support progress reporting through periodic calls to the [System.Management.Automation.Cmdlet.WriteProgress](/dotnet/api/System.Management.Automation.Cmdlet.WriteProgress) method.</span></span>

#### <a name="use-the-host-interfaces"></a><span data-ttu-id="89356-216">Använd värd-gränssnitt</span><span class="sxs-lookup"><span data-stu-id="89356-216">Use the Host Interfaces</span></span>

<span data-ttu-id="89356-217">Ibland kan en cmdlet måste kommunicera direkt med användare i stället för med hjälp av de olika skriva eller bör metoder som stöds av den [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) klass.</span><span class="sxs-lookup"><span data-stu-id="89356-217">Occasionally, a cmdlet must communicate directly with the user instead of by using the various Write or Should methods supported by the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class.</span></span> <span data-ttu-id="89356-218">I så fall cmdlet: en måste härledas från den [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) klassen och använda den [System.Management.Automation.PSCmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) egenskapen.</span><span class="sxs-lookup"><span data-stu-id="89356-218">In this case, the cmdlet should derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class and use the [System.Management.Automation.PSCmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) property.</span></span> <span data-ttu-id="89356-219">Den här egenskapen stöder olika nivåer av typen av kommunikation, inklusive PromptForChoice, fråga och WriteLine/ReadLine-typer.</span><span class="sxs-lookup"><span data-stu-id="89356-219">This property supports different levels of communication type, including the PromptForChoice, Prompt, and WriteLine/ReadLine types.</span></span> <span data-ttu-id="89356-220">Högst viss nivå finns även sätt att läsa och skriva enskilda nycklar och hantera buffertar.</span><span class="sxs-lookup"><span data-stu-id="89356-220">At the most specific level, it also provides ways to read and write individual keys and to deal with buffers.</span></span>

<span data-ttu-id="89356-221">Om inte en cmdlet är speciellt utformad för att generera ett grafiskt användargränssnitt (GUI), bör det inte kringgå värden med hjälp av den [System.Management.Automation.PSCmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) egenskapen.</span><span class="sxs-lookup"><span data-stu-id="89356-221">Unless a cmdlet is specifically designed to generate a graphical user interface (GUI), it should not bypass the host by using the [System.Management.Automation.PSCmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) property.</span></span> <span data-ttu-id="89356-222">Ett exempel på en cmdlet som har utformats för att generera ett grafiskt användargränssnitt är den [Out GridView](/powershell/module/Microsoft.PowerShell.Utility/Out-GridView) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="89356-222">An example of a cmdlet that is designed to generate a GUI is the [Out-GridView](/powershell/module/Microsoft.PowerShell.Utility/Out-GridView) cmdlet.</span></span>

> [!NOTE]
> <span data-ttu-id="89356-223">Cmdlet: ar bör inte använda den [System.Console](/dotnet/api/System.Console) API.</span><span class="sxs-lookup"><span data-stu-id="89356-223">Cmdlets should not use the [System.Console](/dotnet/api/System.Console) API.</span></span>

### <a name="create-a-cmdlet-help-file-sd05"></a><span data-ttu-id="89356-224">Skapa en Cmdlet-hjälpavsnitten-fil (SD05)</span><span class="sxs-lookup"><span data-stu-id="89356-224">Create a Cmdlet Help File (SD05)</span></span>

<span data-ttu-id="89356-225">Skapa en Help.xml-fil som innehåller information om cmdlet: en för varje cmdlet-sammansättningen.</span><span class="sxs-lookup"><span data-stu-id="89356-225">For each cmdlet assembly, create a Help.xml file that contains information about the cmdlet.</span></span> <span data-ttu-id="89356-226">Denna information innehåller en beskrivning av cmdlet, beskrivningar av cmdletens parametrar, exempel på cmdletens användning och mycket mer.</span><span class="sxs-lookup"><span data-stu-id="89356-226">This information includes a description of the cmdlet, descriptions of the cmdlet's parameters, examples of the cmdlet's use, and more.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="89356-227">Riktlinjer för kod</span><span class="sxs-lookup"><span data-stu-id="89356-227">Code Guidelines</span></span>

<span data-ttu-id="89356-228">Följande riktlinjer ska följas när kodning cmdletar för att säkerställa en konsekvent användarupplevelse mellan att använda dina cmdlets och andra cmdlet: ar.</span><span class="sxs-lookup"><span data-stu-id="89356-228">The following guidelines should be followed when coding cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="89356-229">När du har hittat en kod riktlinje som gäller för din situation bör du titta på designriktlinjer för liknande riktlinjer.</span><span class="sxs-lookup"><span data-stu-id="89356-229">When you find a Code guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="coding-parameters-sc01"></a><span data-ttu-id="89356-230">Koda parametrar (SC01)</span><span class="sxs-lookup"><span data-stu-id="89356-230">Coding Parameters (SC01)</span></span>

<span data-ttu-id="89356-231">Definiera en parameter genom att deklarera en offentlig egenskap för cmdlet-klassen som innehåller den **parametern** attribut.</span><span class="sxs-lookup"><span data-stu-id="89356-231">Define a parameter by declaring a public property of the cmdlet class that is decorated with the **Parameter** attribute.</span></span> <span data-ttu-id="89356-232">Parametrar behöver inte vara statiska medlemmar i den härledda klassen för .NET Framework för cmdleten.</span><span class="sxs-lookup"><span data-stu-id="89356-232">Parameters do not have to be static members of the derived .NET Framework class for the cmdlet.</span></span> <span data-ttu-id="89356-233">Mer information om hur du deklarera den **parametern** attributet, se [parameterdeklaration för attributet](./parameter-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="89356-233">For more information about how to declare the **Parameter** attribute, see [Parameter Attribute Declaration](./parameter-attribute-declaration.md).</span></span>

#### <a name="support-windows-powershell-paths"></a><span data-ttu-id="89356-234">Stöd för Windows PowerShell-sökvägar</span><span class="sxs-lookup"><span data-stu-id="89356-234">Support Windows PowerShell Paths</span></span>

<span data-ttu-id="89356-235">Windows PowerShell-sökvägen är en mekanism för normaliserar åtkomst till namnområden.</span><span class="sxs-lookup"><span data-stu-id="89356-235">The Windows PowerShell path is the mechanism for normalizing access to namespaces.</span></span> <span data-ttu-id="89356-236">När du tilldelar en Windows PowerShell-sökväg till en parameter i cmdleten, kan användaren definiera en anpassad ”enhet” som fungerar som en genväg till en specifik sökväg.</span><span class="sxs-lookup"><span data-stu-id="89356-236">When you assign a Windows PowerShell path to a parameter in the cmdlet, the user can define a custom "drive" that acts as a shortcut to a specific path.</span></span> <span data-ttu-id="89356-237">När en användare anger enheten, kan du använda lagrade data, till exempel data i registret på ett konsekvent sätt.</span><span class="sxs-lookup"><span data-stu-id="89356-237">When a user designates such a drive, stored data, such as data in the Registry, can be used in a consistent way.</span></span>

<span data-ttu-id="89356-238">Om cmdlet: tillåter att användaren anger en fil eller en datakälla kan den bör definiera en parameter av typen [System.String](/dotnet/api/System.String).</span><span class="sxs-lookup"><span data-stu-id="89356-238">If your cmdlet allows the user to specify a file or a data source, it should define a parameter of type [System.String](/dotnet/api/System.String).</span></span> <span data-ttu-id="89356-239">Om flera enheter stöds, ska typen vara en matris.</span><span class="sxs-lookup"><span data-stu-id="89356-239">If more than one drive is supported, the type should be an array.</span></span> <span data-ttu-id="89356-240">Namnet på parametern bör vara `Path`, med ett alias för `PSPath`.</span><span class="sxs-lookup"><span data-stu-id="89356-240">The name of the parameter should be `Path`, with an alias of `PSPath`.</span></span> <span data-ttu-id="89356-241">Dessutom kan den `Path` parametern ska ha stöd för jokertecken.</span><span class="sxs-lookup"><span data-stu-id="89356-241">Additionally, the `Path` parameter should support wildcard characters.</span></span> <span data-ttu-id="89356-242">Om stöd för jokertecken inte är obligatoriskt, definiera en `LiteralPath` parametern.</span><span class="sxs-lookup"><span data-stu-id="89356-242">If support for wildcard characters is not required, define a `LiteralPath` parameter.</span></span>

<span data-ttu-id="89356-243">Om de data som cmdleten läser eller skriver måste vara en fil, cmdleten ska ta emot indata för Windows PowerShell-sökväg och cmdlet: en ska använda den [System.Management.Automation.Sessionstate.Path](/dotnet/api/System.Management.Automation.SessionState.Path) egenskapen att översätta i Windows PowerShell-sökvägar till sökvägar som filsystemet känner igen.</span><span class="sxs-lookup"><span data-stu-id="89356-243">If the data that the cmdlet reads or writes has to be a file, the cmdlet should accept Windows PowerShell path input, and the cmdlet should use the [System.Management.Automation.Sessionstate.Path](/dotnet/api/System.Management.Automation.SessionState.Path) property to translate the Windows PowerShell paths into paths that the file system recognizes.</span></span> <span data-ttu-id="89356-244">Specifika mekanismer är följande:</span><span class="sxs-lookup"><span data-stu-id="89356-244">The specific mechanisms include the following methods:</span></span>

- [<span data-ttu-id="89356-245">System.Management.Automation.PSCmdlet.GetResolvedProviderPathFromPSPath</span><span class="sxs-lookup"><span data-stu-id="89356-245">System.Management.Automation.PSCmdlet.GetResolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PSCmdlet.GetResolvedProviderPathFromPSPath)

- [<span data-ttu-id="89356-246">System.Management.Automation.PSCmdlet.GetUnresolvedProviderPathFromPSPath</span><span class="sxs-lookup"><span data-stu-id="89356-246">System.Management.Automation.PSCmdlet.GetUnresolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PSCmdlet.GetUnresolvedProviderPathFromPSPath)

- [<span data-ttu-id="89356-247">System.Management.Automation.PathIntrinsics.GetResolvedProviderPathFromPSPath</span><span class="sxs-lookup"><span data-stu-id="89356-247">System.Management.Automation.PathIntrinsics.GetResolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PathIntrinsics.GetResolvedProviderPathFromPSPath)

- [<span data-ttu-id="89356-248">System.Management.Automation.PathIntrinsics.GetUnresolvedProviderPathFromPSPath</span><span class="sxs-lookup"><span data-stu-id="89356-248">System.Management.Automation.PathIntrinsics.GetUnresolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PathIntrinsics.GetUnresolvedProviderPathFromPSPath)

<span data-ttu-id="89356-249">Om de data som cmdleten läser eller skriver är endast en uppsättning strängar i stället för en fil, cmdleten ska använda providern innehållsinformationen (`Content` medlem) att läsa och skriva.</span><span class="sxs-lookup"><span data-stu-id="89356-249">If the data that the cmdlet reads or writes is only a set of strings instead of a file, the cmdlet should use the provider content information (`Content` member) to read and write.</span></span> <span data-ttu-id="89356-250">Den här informationen hämtas från den [System.Management.Automation.Provider.CmdletProvider.InvokeProvider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.InvokeProvider) egenskapen.</span><span class="sxs-lookup"><span data-stu-id="89356-250">This information is obtained from the [System.Management.Automation.Provider.CmdletProvider.InvokeProvider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.InvokeProvider) property.</span></span> <span data-ttu-id="89356-251">Dessa mekanismer kan andra datalager att delta i läsning och skrivning av data.</span><span class="sxs-lookup"><span data-stu-id="89356-251">These mechanisms allow other data stores to participate in the reading and writing of data.</span></span>

#### <a name="support-wildcard-characters"></a><span data-ttu-id="89356-252">Stöd för jokertecken</span><span class="sxs-lookup"><span data-stu-id="89356-252">Support Wildcard Characters</span></span>

<span data-ttu-id="89356-253">En cmdlet ska ha stöd för jokertecken om möjligt.</span><span class="sxs-lookup"><span data-stu-id="89356-253">A cmdlet should support wildcard characters if possible.</span></span> <span data-ttu-id="89356-254">Stöd för jokertecken inträffar på olika ställen i en cmdlet (särskilt när en parameter tar en sträng att identifiera ett objekt från en uppsättning objekt).</span><span class="sxs-lookup"><span data-stu-id="89356-254">Support for wildcard characters occurs in many places in a cmdlet (especially when a parameter takes a string to identify one object from a set of objects).</span></span> <span data-ttu-id="89356-255">Till exempel exemplet **stoppa Proc** cmdlet från den [StopProc självstudien](./stopproc-tutorial.md) definierar en `Name` parameter för att hantera strängar som representerar processnamn.</span><span class="sxs-lookup"><span data-stu-id="89356-255">For example, the sample **Stop-Proc** cmdlet from the [StopProc Tutorial](./stopproc-tutorial.md) defines a `Name` parameter to handle strings that represent process names.</span></span> <span data-ttu-id="89356-256">Den här parametern har stöd för jokertecken så att du enkelt kan ange processer för att stoppa.</span><span class="sxs-lookup"><span data-stu-id="89356-256">This parameter supports wildcard characters so that the user can easily specify the processes to stop.</span></span>

<span data-ttu-id="89356-257">Om har stöd för jokertecken tecken är tillgänglig, en cmdlet-åtgärd ger vanligtvis en matris.</span><span class="sxs-lookup"><span data-stu-id="89356-257">When support for wildcard characters is available, a cmdlet operation usually produces an array.</span></span> <span data-ttu-id="89356-258">Ibland kan det inte meningsfullt att stödja en matris eftersom användaren kan använda endast en post i taget.</span><span class="sxs-lookup"><span data-stu-id="89356-258">Occasionally, it does not make sense to support an array because the user might use only a single item at a time.</span></span> <span data-ttu-id="89356-259">Till exempel den [Set-Location](/powershell/module/Microsoft.PowerShell.Management/Set-Location) cmdlet inte behöver stöd för en matris eftersom användaren kan du ställa en enda plats.</span><span class="sxs-lookup"><span data-stu-id="89356-259">For example, the [Set-Location](/powershell/module/Microsoft.PowerShell.Management/Set-Location) cmdlet does not need to support an array because the user is setting only a single location.</span></span> <span data-ttu-id="89356-260">Cmdlet: en har fortfarande stöd för jokertecken i den här instansen, men tvingas av lösningen till en enda plats.</span><span class="sxs-lookup"><span data-stu-id="89356-260">In this instance, the cmdlet still supports wildcard characters, but it forces resolution to a single location.</span></span>

<span data-ttu-id="89356-261">Läs mer om jokertecknet mönster [stöd för jokertecken i Cmdlet-parametrarna](./supporting-wildcard-characters-in-cmdlet-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="89356-261">For more information about wildcard-character patterns, see [Supporting Wildcard Characters in Cmdlet Parameters](./supporting-wildcard-characters-in-cmdlet-parameters.md).</span></span>

#### <a name="defining-objects"></a><span data-ttu-id="89356-262">Hur du definierar objekt</span><span class="sxs-lookup"><span data-stu-id="89356-262">Defining Objects</span></span>

<span data-ttu-id="89356-263">Det här avsnittet innehåller riktlinjer för att definiera objekt för cmdletar och för att utöka befintliga objekt.</span><span class="sxs-lookup"><span data-stu-id="89356-263">This section contains guidelines for defining objects for cmdlets and for extending existing objects.</span></span>

##### <a name="define-standard-members"></a><span data-ttu-id="89356-264">Definiera standardmedlemmar</span><span class="sxs-lookup"><span data-stu-id="89356-264">Define Standard Members</span></span>

<span data-ttu-id="89356-265">Definiera standard medlemmar för att utöka en objekttyp i en anpassad Types.ps1xml-fil (Använd Windows PowerShell Types.ps1xml-filen som en mall).</span><span class="sxs-lookup"><span data-stu-id="89356-265">Define standard members to extend an object type in a custom Types.ps1xml file (use the Windows PowerShell Types.ps1xml file as a template).</span></span> <span data-ttu-id="89356-266">Standardmedlemmar definieras av en nod med namnet PSStandardMembers.</span><span class="sxs-lookup"><span data-stu-id="89356-266">Standard members are defined by a node with the name PSStandardMembers.</span></span> <span data-ttu-id="89356-267">Dessa definitioner kan andra cmdlet: ar och Windows PowerShell-körning för att arbeta med dina objekt i ett konsekvent sätt.</span><span class="sxs-lookup"><span data-stu-id="89356-267">These definitions allow other cmdlets and the Windows PowerShell runtime to work with your object in a consistent way.</span></span>

##### <a name="define-objectmembers-to-be-used-as-parameters"></a><span data-ttu-id="89356-268">Definiera ObjectMembers som ska användas som parametrar</span><span class="sxs-lookup"><span data-stu-id="89356-268">Define ObjectMembers to Be Used as Parameters</span></span>

<span data-ttu-id="89356-269">Om du designar ett objekt för en cmdlet, kontrollerar du att medlemmarna mappas direkt till parametrarna för cmdletarna som kommer att använda den.</span><span class="sxs-lookup"><span data-stu-id="89356-269">If you are designing an object for a cmdlet, ensure that its members map directly to the parameters of the cmdlets that will use it.</span></span> <span data-ttu-id="89356-270">Den här mappningen innebär att objektet enkelt skickas till pipelinen och som ska skickas från en cmdlet till en annan.</span><span class="sxs-lookup"><span data-stu-id="89356-270">This mapping allows the object to be easily sent to the pipeline and to be passed from one cmdlet to another.</span></span>

<span data-ttu-id="89356-271">Redan befintliga .NET Framework-objekt som returneras av cmdlet: ar saknar ofta vissa viktiga eller praktiskt medlemmar som krävs av skriptutvecklare eller användare.</span><span class="sxs-lookup"><span data-stu-id="89356-271">Preexisting .NET Framework objects that are returned by cmdlets are frequently missing some important or convenient members that are needed by the script developer or user.</span></span> <span data-ttu-id="89356-272">Dessa saknas medlemmar kan vara särskilt viktigt för visning och för att skapa rätt medlemmen namn så att objektet korrekt kan skickas till pipelinen.</span><span class="sxs-lookup"><span data-stu-id="89356-272">These missing members can be particularly important for display and for creating the correct member names so that the object can be correctly passed to the pipeline.</span></span> <span data-ttu-id="89356-273">Skapa en anpassad Types.ps1xml-fil för att dokumentera dessa tillämpliga medlemmar.</span><span class="sxs-lookup"><span data-stu-id="89356-273">Create a custom Types.ps1xml file to document these required members.</span></span> <span data-ttu-id="89356-274">När du skapar den här filen, rekommenderar vi följande namngivningskonvention: *< Your_Product_Name >*. Types.ps1xml.</span><span class="sxs-lookup"><span data-stu-id="89356-274">When you create this file, we recommend the following naming convention: *<Your_Product_Name>*.Types.ps1xml.</span></span>

<span data-ttu-id="89356-275">Exempelvis kan du lägga till en `Mode` skript som den [System.IO.FileInfo](/dotnet/api/System.IO.FileInfo) Skriv för att visa attribut för en fil tydligare.</span><span class="sxs-lookup"><span data-stu-id="89356-275">For example, you could add a `Mode` script property to the [System.IO.FileInfo](/dotnet/api/System.IO.FileInfo) type to display the attributes of a file more clearly.</span></span> <span data-ttu-id="89356-276">Dessutom kan du lägga till en `Count` alias-egenskap enligt den [System.Array](/dotnet/api/System.Array) typ som tillåter konsekvent användning av det egenskapsnamnet (i stället för `Length`).</span><span class="sxs-lookup"><span data-stu-id="89356-276">Additionally, you could add a `Count` alias property to the [System.Array](/dotnet/api/System.Array) type to allow the consistent use of that property name (instead of `Length`).</span></span>

##### <a name="implement-the-icomparable-interface"></a><span data-ttu-id="89356-277">Implementera gränssnittet IComparable</span><span class="sxs-lookup"><span data-stu-id="89356-277">Implement the IComparable Interface</span></span>

<span data-ttu-id="89356-278">Implementera en [System.IComparable](/dotnet/api/System.IComparable) gränssnittet på alla objekt som utdata.</span><span class="sxs-lookup"><span data-stu-id="89356-278">Implement a [System.IComparable](/dotnet/api/System.IComparable) interface on all output objects.</span></span> <span data-ttu-id="89356-279">På så sätt kan utdata objekt som ska skickas enkelt olika cmdletar för sortering och analys.</span><span class="sxs-lookup"><span data-stu-id="89356-279">This allows the output objects to be easily piped to various sorting and analysis cmdlets.</span></span>

##### <a name="update-display-information"></a><span data-ttu-id="89356-280">Uppdatera visningsinformation</span><span class="sxs-lookup"><span data-stu-id="89356-280">Update Display Information</span></span>

<span data-ttu-id="89356-281">Om visningen för ett objekt inte tillhandahåller de förväntade resultaten, skapa en anpassad  *\<YourProductName >*. Format.ps1xml fil för objektet.</span><span class="sxs-lookup"><span data-stu-id="89356-281">If the display for an object does not provide the expected results, create a custom *\<YourProductName>*.Format.ps1xml file for that object.</span></span>

### <a name="support-well-defined-pipeline-input-sc02"></a><span data-ttu-id="89356-282">Stöd för väldefinierade Pipeline-indata (SC02)</span><span class="sxs-lookup"><span data-stu-id="89356-282">Support Well Defined Pipeline Input (SC02)</span></span>

#### <a name="implement-for-the-middle-of-a-pipeline"></a><span data-ttu-id="89356-283">Implementera för mitten av en Pipeline</span><span class="sxs-lookup"><span data-stu-id="89356-283">Implement for the Middle of a Pipeline</span></span>

<span data-ttu-id="89356-284">Implementera en cmdlet förutsatt att den anropas från mitten av en pipeline (det vill säga andra cmdletar kommer producerar indata eller använda dess utdata).</span><span class="sxs-lookup"><span data-stu-id="89356-284">Implement a cmdlet assuming that it will be called from the middle of a pipeline (that is, other cmdlets will produce its input or consume its output).</span></span> <span data-ttu-id="89356-285">Du kan till exempel förutsätts att den `Get-Process` cmdlet, eftersom den genererar data, används endast som den första cmdlet: i en pipeline.</span><span class="sxs-lookup"><span data-stu-id="89356-285">For example, you might assume that the `Get-Process` cmdlet, because it generates data, is used only as the first cmdlet in a pipeline.</span></span> <span data-ttu-id="89356-286">Eftersom denna cmdlet är utformat för mitten av en pipeline, kan denna cmdlet dock tidigare cmdletar eller data i pipeline för att ange processerna som ska hämtas.</span><span class="sxs-lookup"><span data-stu-id="89356-286">However, because this cmdlet is designed for the middle of a pipeline, this cmdlet allows previous cmdlets or data in the pipeline to specify the processes to retrieve.</span></span>

#### <a name="support-input-from-the-pipeline"></a><span data-ttu-id="89356-287">Stöd för indata från Pipeline</span><span class="sxs-lookup"><span data-stu-id="89356-287">Support Input from the Pipeline</span></span>

<span data-ttu-id="89356-288">På varje parameter som angetts för en cmdlet, innehåller minst en parameter som har stöd för indata från pipeline.</span><span class="sxs-lookup"><span data-stu-id="89356-288">In each parameter set for a cmdlet, include at least one parameter that supports input from the pipeline.</span></span> <span data-ttu-id="89356-289">Stöd för pipeline-indata används att hämta data eller objekt att skicka dem till rätt parameteruppsättningen och skickar resultaten direkt till en cmdlet.</span><span class="sxs-lookup"><span data-stu-id="89356-289">Support for pipeline input allows the user to retrieve data or objects, to send them to the correct parameter set, and to pass the results directly to a cmdlet.</span></span>

<span data-ttu-id="89356-290">En parameter godkänner indata från pipelinen om den **parametern** attribut innehåller den `ValueFromPipeline` nyckelord, den `ValueFromPipelineByPropertyName` nyckelordet attributet eller båda nyckelord i dess deklaration.</span><span class="sxs-lookup"><span data-stu-id="89356-290">A parameter accepts input from the pipeline if the **Parameter** attribute includes the `ValueFromPipeline` keyword, the `ValueFromPipelineByPropertyName` keyword attribute, or both keywords in its  declaration.</span></span> <span data-ttu-id="89356-291">Om ingen av parametrarna i en parameter anger stöd i `ValueFromPipeline` eller `ValueFromPipelineByPropertyName` nyckelord, cmdleten meningsfullt kan inte placeras efter en annan cmdlet eftersom det kommer att ignorera alla indata från pipeline.</span><span class="sxs-lookup"><span data-stu-id="89356-291">If none of the parameters in a parameter set support the `ValueFromPipeline` or `ValueFromPipelineByPropertyName` keywords, the cmdlet cannot meaningfully be placed after another cmdlet because it will ignore any pipeline input.</span></span>

#### <a name="support-the-processrecord-method"></a><span data-ttu-id="89356-292">Stöd för metoden ProcessRecord</span><span class="sxs-lookup"><span data-stu-id="89356-292">Support the ProcessRecord Method</span></span>

<span data-ttu-id="89356-293">För att godkänna alla poster från den föregående cmdleten i pipelinen, din cmdlet måste implementera de [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) metod.</span><span class="sxs-lookup"><span data-stu-id="89356-293">To accept all the records from the preceding cmdlet in the pipeline, your cmdlet must implement the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method.</span></span> <span data-ttu-id="89356-294">Windows PowerShell anropar den här metoden flera gånger, en gång för varje post som skickas till din cmdlet.</span><span class="sxs-lookup"><span data-stu-id="89356-294">Windows PowerShell calls this method multiple times, once for every record that is sent to your cmdlet.</span></span>

### <a name="write-single-records-to-the-pipeline-sc03"></a><span data-ttu-id="89356-295">Skriva enskild poster till pipelinen (SC03)</span><span class="sxs-lookup"><span data-stu-id="89356-295">Write Single Records to the Pipeline (SC03)</span></span>

<span data-ttu-id="89356-296">När en cmdlet returnerar objekt, cmdleten ska skriva objekten direkt när de skapas.</span><span class="sxs-lookup"><span data-stu-id="89356-296">When a cmdlet returns objects, the cmdlet should write the objects immediately as they are generated.</span></span> <span data-ttu-id="89356-297">Cmdlet: en ska inte innehålla dem för att buffra dem till en kombinerad matris.</span><span class="sxs-lookup"><span data-stu-id="89356-297">The cmdlet should not hold them in order to buffer them into a combined array.</span></span> <span data-ttu-id="89356-298">De cmdletar som tar emot objekt som indata kommer sedan att kunna bearbeta, visa, eller bearbeta och visa utdata-objekt utan fördröjning.</span><span class="sxs-lookup"><span data-stu-id="89356-298">The cmdlets that receive the objects as input will then be able to process, display, or process and display the output objects without delay.</span></span> <span data-ttu-id="89356-299">En cmdlet som genererar utdata objekt i taget ska anropa den [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) metod.</span><span class="sxs-lookup"><span data-stu-id="89356-299">A cmdlet that generates output objects one at a time should call the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="89356-300">En cmdlet som genererar utdata-objekt i batchar (till exempel eftersom en underliggande API: T returnerar en matris med objekt i utdata) ska anropa den [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) metoden med dess andra parameter ange att `true`.</span><span class="sxs-lookup"><span data-stu-id="89356-300">A cmdlet that generates output objects in batches (for example, because an underlying API returns an array of output objects) should call the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) Method with its second parameter set to `true`.</span></span>

### <a name="make-cmdlets-case-insensitive-and-case-preserving-sc04"></a><span data-ttu-id="89356-301">Kontrollera cmdletarna skiftlägeskänsliga och bevara (SC04)</span><span class="sxs-lookup"><span data-stu-id="89356-301">Make Cmdlets Case-Insensitive and Case-Preserving (SC04)</span></span>

<span data-ttu-id="89356-302">Som standard inte själva Windows PowerShell är skiftlägeskänslig.</span><span class="sxs-lookup"><span data-stu-id="89356-302">By default, Windows PowerShell itself is case-insensitive.</span></span> <span data-ttu-id="89356-303">Men eftersom den behandlar många befintliga system, bevarar Windows PowerShell fall för att underlätta av åtgärden och kompatibilitet.</span><span class="sxs-lookup"><span data-stu-id="89356-303">However, because it deals with many preexisting systems, Windows PowerShell does preserve case for ease of operation and compatibility.</span></span> <span data-ttu-id="89356-304">Med andra ord, om ett tecken anges med versaler håller Windows PowerShell den med versaler.</span><span class="sxs-lookup"><span data-stu-id="89356-304">In other words, if a character is supplied in uppercase letters, Windows PowerShell keeps it in uppercase letters.</span></span> <span data-ttu-id="89356-305">För system för att fungera, måste en cmdlet följer denna konvention.</span><span class="sxs-lookup"><span data-stu-id="89356-305">For systems to work well, a cmdlet needs to follow this convention.</span></span> <span data-ttu-id="89356-306">Den bör om möjligt att fungera på ett skiftlägesokänsligt sätt.</span><span class="sxs-lookup"><span data-stu-id="89356-306">If possible, it should operate in a case-insensitive way.</span></span> <span data-ttu-id="89356-307">Det bör dock bevara det ursprungliga skiftläget för cmdletar som inträffar senare i ett kommando eller i pipelinen.</span><span class="sxs-lookup"><span data-stu-id="89356-307">It should, however, preserve the original case for cmdlets that occur later in a command or in the pipeline.</span></span>

## <a name="see-also"></a><span data-ttu-id="89356-308">Se även</span><span class="sxs-lookup"><span data-stu-id="89356-308">See Also</span></span>

[<span data-ttu-id="89356-309">Riktlinjer för nödvändiga utveckling</span><span class="sxs-lookup"><span data-stu-id="89356-309">Required Development Guidelines</span></span>](./required-development-guidelines.md)

[<span data-ttu-id="89356-310">Riktlinjer för rådgivande utveckling</span><span class="sxs-lookup"><span data-stu-id="89356-310">Advisory Development Guidelines</span></span>](./advisory-development-guidelines.md)

[<span data-ttu-id="89356-311">Skriva en Windows PowerShell-Cmdlet</span><span class="sxs-lookup"><span data-stu-id="89356-311">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)

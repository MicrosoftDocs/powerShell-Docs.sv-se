---
title: Riktlinjerna för utveckling | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 41d2b308-a36a-496f-8542-666b6a21eedc
caps.latest.revision: 19
ms.openlocfilehash: 3f6bcd2e4ef4d9c404b3a5deeaa9f25d3fa42ec1
ms.sourcegitcommit: caac7d098a448232304c9d6728e7340ec7517a71
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 03/16/2019
ms.locfileid: "58056523"
---
# <a name="required-development-guidelines"></a><span data-ttu-id="7199b-102">Obligatoriska riktlinjer för utveckling</span><span class="sxs-lookup"><span data-stu-id="7199b-102">Required Development Guidelines</span></span>

<span data-ttu-id="7199b-103">Följande riktlinjer måste följas när du skriver dina cmdlets.</span><span class="sxs-lookup"><span data-stu-id="7199b-103">The following guidelines must be followed when you write your cmdlets.</span></span> <span data-ttu-id="7199b-104">De är indelade i riktlinjer för att utforma cmdlets och riktlinjer för att skriva cmdlet-kod.</span><span class="sxs-lookup"><span data-stu-id="7199b-104">They are separated into guidelines for designing cmdlets and guidelines for writing your cmdlet code.</span></span> <span data-ttu-id="7199b-105">Om du inte följer dessa riktlinjer dina cmdlets kan misslyckas och användarna kan ha en dålig upplevelse när de använder dina cmdlets.</span><span class="sxs-lookup"><span data-stu-id="7199b-105">If you do not follow these guidelines, your cmdlets could fail, and your users might have a poor experience when they use your cmdlets.</span></span>

## <a name="in-this-topic"></a><span data-ttu-id="7199b-106">I det här avsnittet</span><span class="sxs-lookup"><span data-stu-id="7199b-106">In this Topic</span></span>

### <a name="design-guidelines"></a><span data-ttu-id="7199b-107">Designriktlinjer</span><span class="sxs-lookup"><span data-stu-id="7199b-107">Design Guidelines</span></span>

- [<span data-ttu-id="7199b-108">Använd endast godkända verb (RD01)</span><span class="sxs-lookup"><span data-stu-id="7199b-108">Use Only Approved Verbs (RD01)</span></span>](./required-development-guidelines.md#use-only-approved-verbs-rd01)

- [<span data-ttu-id="7199b-109">Cmdlet-namn: Tecken som inte får återanvändas (RD02)</span><span class="sxs-lookup"><span data-stu-id="7199b-109">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>](./required-development-guidelines.md#cmdlet-names-characters-that-cannot-be-used-rd02)

- [<span data-ttu-id="7199b-110">Namn på parametrar som inte får återanvändas (RD03)</span><span class="sxs-lookup"><span data-stu-id="7199b-110">Parameters Names that cannot be Used (RD03)</span></span>](./required-development-guidelines.md#parameters-names-that-cannot-be-used-rd03)

- [<span data-ttu-id="7199b-111">Bekräftelse supportärenden (RD04)</span><span class="sxs-lookup"><span data-stu-id="7199b-111">Support Confirmation Requests (RD04)</span></span>](./required-development-guidelines.md#support-confirmation-requests-rd04)

- [<span data-ttu-id="7199b-112">Stöd för parametern Force för interaktiva sessioner (RD05)</span><span class="sxs-lookup"><span data-stu-id="7199b-112">Support Force Parameter for Interactive Sessions (RD05)</span></span>](./required-development-guidelines.md#support-force-parameter-for-interactive-sessions-rd05)

- [<span data-ttu-id="7199b-113">Utdata-Dokumentobjekt (RD06)</span><span class="sxs-lookup"><span data-stu-id="7199b-113">Document Output Objects (RD06)</span></span>](./required-development-guidelines.md#document-output-objects-rd06)

### <a name="code-guidelines"></a><span data-ttu-id="7199b-114">Riktlinjer för kod</span><span class="sxs-lookup"><span data-stu-id="7199b-114">Code Guidelines</span></span>

- [<span data-ttu-id="7199b-115">Härledd från Cmdlet eller PSCmdlet klasser (RC01)</span><span class="sxs-lookup"><span data-stu-id="7199b-115">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>](./required-development-guidelines.md#derive-from-the-cmdlet-or-pscmdlet-classes-rc01)

- [<span data-ttu-id="7199b-116">Ange Cmdlet-attribut (RC02)</span><span class="sxs-lookup"><span data-stu-id="7199b-116">Specify the Cmdlet Attribute (RC02)</span></span>](./required-development-guidelines.md#specify-the-cmdlet-attribute-rc02)

- [<span data-ttu-id="7199b-117">Åsidosätt indata som bearbetar metod (RC03)</span><span class="sxs-lookup"><span data-stu-id="7199b-117">Override an Input Processing Method (RC03)</span></span>](./required-development-guidelines.md#override-an-input-processing-method-rc03)

- [<span data-ttu-id="7199b-118">Ange OutputType-attributet (RC04)</span><span class="sxs-lookup"><span data-stu-id="7199b-118">Specify the OutputType Attribute (RC04)</span></span>](./required-development-guidelines.md#specify-the-outputtype-attribute-rc04)

- [<span data-ttu-id="7199b-119">Spara inte referenser till utdata-objekt (RC05)</span><span class="sxs-lookup"><span data-stu-id="7199b-119">Do Not Retain Handles to Output Objects (RC05)</span></span>](./required-development-guidelines.md#do-not-retain-handles-to-output-objects-rc05)

- [<span data-ttu-id="7199b-120">Handle Errors Robustly (RC06)</span><span class="sxs-lookup"><span data-stu-id="7199b-120">Handle Errors Robustly (RC06)</span></span>](./required-development-guidelines.md#handle-errors-robustly-rc06)

- [<span data-ttu-id="7199b-121">Använda en Windows PowerShell-modul för att distribuera dina Cmdlets (RC07)</span><span class="sxs-lookup"><span data-stu-id="7199b-121">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>](./required-development-guidelines.md#use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07)

## <a name="design-guidelines"></a><span data-ttu-id="7199b-122">Designriktlinjer</span><span class="sxs-lookup"><span data-stu-id="7199b-122">Design Guidelines</span></span>

<span data-ttu-id="7199b-123">Följande riktlinjer måste följas när du utformar cmdletar för att säkerställa en konsekvent användarupplevelse mellan att använda dina cmdlets och andra cmdlet: ar.</span><span class="sxs-lookup"><span data-stu-id="7199b-123">The following guidelines must be followed when designing cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="7199b-124">När du har hittat en Design riktlinje som gäller för din situation bör du titta på koden riktlinjer för liknande riktlinjer.</span><span class="sxs-lookup"><span data-stu-id="7199b-124">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="use-only-approved-verbs-rd01"></a><span data-ttu-id="7199b-125">Använd endast godkända verb (RD01)</span><span class="sxs-lookup"><span data-stu-id="7199b-125">Use Only Approved Verbs (RD01)</span></span>

<span data-ttu-id="7199b-126">Verbet som har angetts i Cmdlet-attributet måste komma från en känd uppsättning verb som tillhandahålls av Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7199b-126">The verb specified in the Cmdlet attribute must come from the recognized set of verbs provided by Windows PowerShell.</span></span> <span data-ttu-id="7199b-127">Det får inte vara någon av otillåten synonymer.</span><span class="sxs-lookup"><span data-stu-id="7199b-127">It must not be one of the prohibited synonyms.</span></span> <span data-ttu-id="7199b-128">Använd konstant strängar som definieras av följande uppräkningar ange cmdlet verb:</span><span class="sxs-lookup"><span data-stu-id="7199b-128">Use the constant strings that are defined by the following enumerations to specify cmdlet verbs:</span></span>

- [<span data-ttu-id="7199b-129">System.Management.Automation.VerbsCommon</span><span class="sxs-lookup"><span data-stu-id="7199b-129">System.Management.Automation.VerbsCommon</span></span>](/dotnet/api/System.Management.Automation.VerbsCommon)

- [<span data-ttu-id="7199b-130">System.Management.Automation.VerbsCommunications</span><span class="sxs-lookup"><span data-stu-id="7199b-130">System.Management.Automation.VerbsCommunications</span></span>](/dotnet/api/System.Management.Automation.VerbsCommunications)

- [<span data-ttu-id="7199b-131">System.Management.Automation.VerbsData</span><span class="sxs-lookup"><span data-stu-id="7199b-131">System.Management.Automation.VerbsData</span></span>](/dotnet/api/System.Management.Automation.VerbsData)

- [<span data-ttu-id="7199b-132">System.Management.Automation.VerbsDiagnostic</span><span class="sxs-lookup"><span data-stu-id="7199b-132">System.Management.Automation.VerbsDiagnostic</span></span>](/dotnet/api/System.Management.Automation.VerbsDiagnostic)

- [<span data-ttu-id="7199b-133">System.Management.Automation.VerbsLifeCycle</span><span class="sxs-lookup"><span data-stu-id="7199b-133">System.Management.Automation.VerbsLifeCycle</span></span>](/dotnet/api/System.Management.Automation.VerbsLifeCycle)

- [<span data-ttu-id="7199b-134">System.Management.Automation.VerbsSecurity</span><span class="sxs-lookup"><span data-stu-id="7199b-134">System.Management.Automation.VerbsSecurity</span></span>](/dotnet/api/System.Management.Automation.VerbsSecurity)

- [<span data-ttu-id="7199b-135">System.Management.Automation.VerbsOther</span><span class="sxs-lookup"><span data-stu-id="7199b-135">System.Management.Automation.VerbsOther</span></span>](/dotnet/api/System.Management.Automation.VerbsOther)

<span data-ttu-id="7199b-136">Läs mer om de godkända verb, [Cmdlet verb](./approved-verbs-for-windows-powershell-commands.md).</span><span class="sxs-lookup"><span data-stu-id="7199b-136">For more information about the approved verb names, see [Cmdlet Verbs](./approved-verbs-for-windows-powershell-commands.md).</span></span>

<span data-ttu-id="7199b-137">Användare behöver en uppsättning att upptäcka och förväntade cmdlet-namnen.</span><span class="sxs-lookup"><span data-stu-id="7199b-137">Users need a set of discoverable and expected cmdlet names.</span></span> <span data-ttu-id="7199b-138">Använd lämplig verbet så att användaren kan göra en snabb utvärdering av en cmdlet gör och för att enkelt utforska funktionerna i systemet.</span><span class="sxs-lookup"><span data-stu-id="7199b-138">Use the appropriate verb so that the user can make a quick assessment of what a cmdlet does and to easily discover the capabilities of the system.</span></span> <span data-ttu-id="7199b-139">Till exempel följande kommandorad hämtar en lista över alla kommandon i systemet vars namn börjar med ”start”: `get-command start-*`.</span><span class="sxs-lookup"><span data-stu-id="7199b-139">For example, the following command-line command gets a list of all the commands on the system whose names begin with "start": `get-command start-*`.</span></span> <span data-ttu-id="7199b-140">Använd substantiv i dina cmdlets för att skilja dina cmdletar från andra cmdlet: ar.</span><span class="sxs-lookup"><span data-stu-id="7199b-140">Use the nouns in your cmdlets to differentiate your cmdlets from other cmdlets.</span></span> <span data-ttu-id="7199b-141">Substantivet anger den resurs där åtgärden utförs.</span><span class="sxs-lookup"><span data-stu-id="7199b-141">The noun indicates the resource on which the operation will be performed.</span></span> <span data-ttu-id="7199b-142">Själva funktionen representeras av verbet.</span><span class="sxs-lookup"><span data-stu-id="7199b-142">The operation itself is represented by the verb.</span></span>

### <a name="cmdlet-names-characters-that-cannot-be-used-rd02"></a><span data-ttu-id="7199b-143">Cmdlet-namn: Tecken som inte får återanvändas (RD02)</span><span class="sxs-lookup"><span data-stu-id="7199b-143">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>

<span data-ttu-id="7199b-144">När du namnger cmdletar, Använd inte någon av följande specialtecken.</span><span class="sxs-lookup"><span data-stu-id="7199b-144">When you name cmdlets, do not use any of the following special characters.</span></span>

|<span data-ttu-id="7199b-145">Tecken</span><span class="sxs-lookup"><span data-stu-id="7199b-145">Character</span></span>|<span data-ttu-id="7199b-146">Namn</span><span class="sxs-lookup"><span data-stu-id="7199b-146">Name</span></span>|
|---------------|----------|
|#|<span data-ttu-id="7199b-147">nummertecken</span><span class="sxs-lookup"><span data-stu-id="7199b-147">number sign</span></span>|
|<span data-ttu-id="7199b-148">, </span><span class="sxs-lookup"><span data-stu-id="7199b-148">,</span></span>|<span data-ttu-id="7199b-149">kommaavgränsad</span><span class="sxs-lookup"><span data-stu-id="7199b-149">comma</span></span>|
|<span data-ttu-id="7199b-150">()</span><span class="sxs-lookup"><span data-stu-id="7199b-150">()</span></span>|<span data-ttu-id="7199b-151">parenteser</span><span class="sxs-lookup"><span data-stu-id="7199b-151">parentheses</span></span>|
|{}|<span data-ttu-id="7199b-152">klammerparenteser</span><span class="sxs-lookup"><span data-stu-id="7199b-152">braces</span></span>|
|<span data-ttu-id="7199b-153">[]</span><span class="sxs-lookup"><span data-stu-id="7199b-153">[]</span></span>|<span data-ttu-id="7199b-154">hakparenteser</span><span class="sxs-lookup"><span data-stu-id="7199b-154">brackets</span></span>|
|&|<span data-ttu-id="7199b-155">et-tecken</span><span class="sxs-lookup"><span data-stu-id="7199b-155">ampersand</span></span>|
|-|<span data-ttu-id="7199b-156">bindestreck **Obs:**  Bindestreck som kan användas för att avgränsa verb från substantivet, men den kan inte användas inom substantivet eller verbet.</span><span class="sxs-lookup"><span data-stu-id="7199b-156">hyphen **Note:**  The hyphen can be used to separate the verb from the noun, but it cannot be used within the noun or within the verb.</span></span>|
|/|<span data-ttu-id="7199b-157">snedstreck</span><span class="sxs-lookup"><span data-stu-id="7199b-157">slash mark</span></span>|
|<span data-ttu-id="7199b-158">\|backslash</span><span class="sxs-lookup"><span data-stu-id="7199b-158">\|backslash</span></span>|
|$|<span data-ttu-id="7199b-159">dollartecken</span><span class="sxs-lookup"><span data-stu-id="7199b-159">dollar sign</span></span>|
|^|<span data-ttu-id="7199b-160">cirkumflex</span><span class="sxs-lookup"><span data-stu-id="7199b-160">caret</span></span>|
|<span data-ttu-id="7199b-161">;</span><span class="sxs-lookup"><span data-stu-id="7199b-161">;</span></span>|<span data-ttu-id="7199b-162">semicolon</span><span class="sxs-lookup"><span data-stu-id="7199b-162">semicolon</span></span>|
|<span data-ttu-id="7199b-163">:</span><span class="sxs-lookup"><span data-stu-id="7199b-163">:</span></span>|<span data-ttu-id="7199b-164">kolon</span><span class="sxs-lookup"><span data-stu-id="7199b-164">colon</span></span>|
|<span data-ttu-id="7199b-165">"</span><span class="sxs-lookup"><span data-stu-id="7199b-165">"</span></span>|<span data-ttu-id="7199b-166">citattecken</span><span class="sxs-lookup"><span data-stu-id="7199b-166">double quotation mark</span></span>|
|<span data-ttu-id="7199b-167">'</span><span class="sxs-lookup"><span data-stu-id="7199b-167">'</span></span>|<span data-ttu-id="7199b-168">enkelt citattecken</span><span class="sxs-lookup"><span data-stu-id="7199b-168">single quotation mark</span></span>|
|<>|<span data-ttu-id="7199b-169">vinkelparentes</span><span class="sxs-lookup"><span data-stu-id="7199b-169">angle brackets</span></span>|
|<span data-ttu-id="7199b-170">&#124;</span><span class="sxs-lookup"><span data-stu-id="7199b-170">&#124;</span></span>|<span data-ttu-id="7199b-171">vertikalstreck</span><span class="sxs-lookup"><span data-stu-id="7199b-171">vertical bar</span></span>|
|<span data-ttu-id="7199b-172">?</span><span class="sxs-lookup"><span data-stu-id="7199b-172">?</span></span>|<span data-ttu-id="7199b-173">frågetecken</span><span class="sxs-lookup"><span data-stu-id="7199b-173">question mark</span></span>|
|@|<span data-ttu-id="7199b-174">tecknet</span><span class="sxs-lookup"><span data-stu-id="7199b-174">at sign</span></span>|
|<span data-ttu-id="7199b-175">' | tillbaka skalstreck (allvarligt accent)</span><span class="sxs-lookup"><span data-stu-id="7199b-175">\`|back tick (grave accent)</span></span>|
|*|<span data-ttu-id="7199b-176">asterisk</span><span class="sxs-lookup"><span data-stu-id="7199b-176">asterisk</span></span>|
|%|<span data-ttu-id="7199b-177">procenttecken</span><span class="sxs-lookup"><span data-stu-id="7199b-177">percent sign</span></span>|
|+|<span data-ttu-id="7199b-178">plustecken</span><span class="sxs-lookup"><span data-stu-id="7199b-178">plus sign</span></span>|
|=|<span data-ttu-id="7199b-179">likhetstecken</span><span class="sxs-lookup"><span data-stu-id="7199b-179">equals sign</span></span>|
|~|<span data-ttu-id="7199b-180">tilde</span><span class="sxs-lookup"><span data-stu-id="7199b-180">tilde</span></span>|

### <a name="parameters-names-that-cannot-be-used-rd03"></a><span data-ttu-id="7199b-181">Namn på parametrar som inte får återanvändas (RD03)</span><span class="sxs-lookup"><span data-stu-id="7199b-181">Parameters Names that cannot be Used (RD03)</span></span>

<span data-ttu-id="7199b-182">Windows PowerShell tillhandahåller en gemensam uppsättning en parametrar i alla cmdletar plus ytterligare parametrar som har lagts till i vissa situationer.</span><span class="sxs-lookup"><span data-stu-id="7199b-182">Windows PowerShell provides a common set a parameters to all cmdlets plus additional parameters that are added in specific situations.</span></span> <span data-ttu-id="7199b-183">När du utformar dina egna cmdletar kan inte du använda följande namn: Bekräfta, felsökning, ErrorAction, -ErrorVariable, OutBuffer OutVariable, WarningAction, WarningVariable, WhatIf, UseTransaction, och utförlig.</span><span class="sxs-lookup"><span data-stu-id="7199b-183">When designing your own cmdlets you cannot use the following names: Confirm, Debug, ErrorAction, ErrorVariable, OutBuffer, OutVariable, WarningAction, WarningVariable, WhatIf, UseTransaction, and Verbose.</span></span> <span data-ttu-id="7199b-184">Mer information om dessa parametrar finns i [vanliga parameternamn](./common-parameter-names.md).</span><span class="sxs-lookup"><span data-stu-id="7199b-184">For more information about these parameters, see [Common Parameter Names](./common-parameter-names.md).</span></span>

### <a name="support-confirmation-requests-rd04"></a><span data-ttu-id="7199b-185">Bekräftelse supportärenden (RD04)</span><span class="sxs-lookup"><span data-stu-id="7199b-185">Support Confirmation Requests (RD04)</span></span>

<span data-ttu-id="7199b-186">För cmdlet: ar som utför en åtgärd som ändrar systemet, ska de anropa den [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) metod för att begära bekräftelse och i särskilda fall anropa den [ System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) metod.</span><span class="sxs-lookup"><span data-stu-id="7199b-186">For cmdlets that perform an operation that modifies the system, they should call the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method to request confirmation, and in special cases call the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method.</span></span> <span data-ttu-id="7199b-187">(Den [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) metoden ska anropas förrän den [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) metoden anropas.)</span><span class="sxs-lookup"><span data-stu-id="7199b-187">(The [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method should be called only after the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method is called.)</span></span>

<span data-ttu-id="7199b-188">Att göra dessa anrop som cmdlet: en måste ange att den stöder begäranden om händelsebekräftelse genom att ange den `SupportsShouldProcess` nyckelord för attributet Cmdlet.</span><span class="sxs-lookup"><span data-stu-id="7199b-188">To make these calls the cmdlet must specify that it supports confirmation requests by setting the `SupportsShouldProcess` keyword of the Cmdlet attribute.</span></span> <span data-ttu-id="7199b-189">Läs mer om att ställa in det här attributet [Cmdlet attributet deklarationen](./cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="7199b-189">For more information about setting this attribute, see [Cmdlet Attribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

> [!NOTE]
> <span data-ttu-id="7199b-190">Om Cmdlet-attributet i cmdlet-klassen anger att cmdleten har stöd för anrop till den [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) metod och cmdleten inte kan göra anrop till den [ System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) metoden användaren kan ändra systemet oväntat.</span><span class="sxs-lookup"><span data-stu-id="7199b-190">If the Cmdlet attribute of the cmdlet class indicates that the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, and the cmdlet fails to make the call to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, the user could modify the system unexpectedly.</span></span>

<span data-ttu-id="7199b-191">Använd den [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) metod för ändringar system.</span><span class="sxs-lookup"><span data-stu-id="7199b-191">Use the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method for any system modification.</span></span> <span data-ttu-id="7199b-192">En användarinställning och `WhatIf` parameterkontroll den [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) metod.</span><span class="sxs-lookup"><span data-stu-id="7199b-192">A user preference and the `WhatIf` parameter control the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="7199b-193">Däremot den [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) anrop utför ytterligare en kontroll efter potentiellt skadliga ändringar.</span><span class="sxs-lookup"><span data-stu-id="7199b-193">In contrast, the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) call performs an additional check for potentially dangerous modifications.</span></span> <span data-ttu-id="7199b-194">Den här metoden inte kontrolleras av alla ANVÄNDARPREFERENSER eller `WhatIf` parametern.</span><span class="sxs-lookup"><span data-stu-id="7199b-194">This method is not controlled by any user preference or the `WhatIf` parameter.</span></span> <span data-ttu-id="7199b-195">Om cmdlet: anropar den [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) metod, som den ska ha en `Force` parameter som förbigår anrop till dessa två metoder och som fortsätter med åtgärden.</span><span class="sxs-lookup"><span data-stu-id="7199b-195">If your cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method, it should have a `Force` parameter that bypasses the calls to these two methods and that proceeds with the operation.</span></span> <span data-ttu-id="7199b-196">Detta är viktigt eftersom den tillåter din cmdlet som ska användas i icke-interaktivt skript och värdar.</span><span class="sxs-lookup"><span data-stu-id="7199b-196">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span>

<span data-ttu-id="7199b-197">Om dina cmdletar stöder dessa anrop, kan användaren avgöra om åtgärden faktiskt ska utföras.</span><span class="sxs-lookup"><span data-stu-id="7199b-197">If your cmdlets support these calls, the user can determine whether the action should actually be performed.</span></span> <span data-ttu-id="7199b-198">Till exempel den [Stop-Process](/powershell/module/microsoft.powershell.management/stop-process) cmdlet-anrop i [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) metoden innan den stoppar en uppsättning viktiga processer, inklusive System, Winlogon, och Spoolsv processer.</span><span class="sxs-lookup"><span data-stu-id="7199b-198">For example, the [Stop-Process](/powershell/module/microsoft.powershell.management/stop-process) cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method before it stops a set of critical processes, including the System, Winlogon, and Spoolsv processes.</span></span>

<span data-ttu-id="7199b-199">Läs mer om att stödja dessa metoder, [begär bekräftelse](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="7199b-199">For more information about supporting these methods, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="support-force-parameter-for-interactive-sessions-rd05"></a><span data-ttu-id="7199b-200">Stöd för parametern Force för interaktiva sessioner (RD05)</span><span class="sxs-lookup"><span data-stu-id="7199b-200">Support Force Parameter for Interactive Sessions (RD05)</span></span>

<span data-ttu-id="7199b-201">Om du använder cmdlet: interaktivt, alltid ange ett Force-parametern om du vill åsidosätta de interaktiva åtgärderna, till exempel anvisningarna eller läsa rader av indata).</span><span class="sxs-lookup"><span data-stu-id="7199b-201">If your cmdlet is used interactively, always provide a Force parameter to override the interactive actions, such as prompts or reading lines of input).</span></span> <span data-ttu-id="7199b-202">Detta är viktigt eftersom den tillåter din cmdlet som ska användas i icke-interaktivt skript och värdar.</span><span class="sxs-lookup"><span data-stu-id="7199b-202">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span> <span data-ttu-id="7199b-203">Följande metoder kan implementeras med en interaktiv värd.</span><span class="sxs-lookup"><span data-stu-id="7199b-203">The following methods can be implemented by an interactive host.</span></span>

- [<span data-ttu-id="7199b-204">System.Management.Automation.Host.PSHostUserInterface.Prompt\*</span><span class="sxs-lookup"><span data-stu-id="7199b-204">System.Management.Automation.Host.PSHostUserInterface.Prompt\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.Prompt)

- [<span data-ttu-id="7199b-205">System.Management.Automation.Host.Pshostuserinterface.PromptForChoice</span><span class="sxs-lookup"><span data-stu-id="7199b-205">System.Management.Automation.Host.Pshostuserinterface.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForChoice)

- [<span data-ttu-id="7199b-206">System.Management.Automation.Host.Ihostuisupportsmultiplechoiceselection.PromptForChoice</span><span class="sxs-lookup"><span data-stu-id="7199b-206">System.Management.Automation.Host.Ihostuisupportsmultiplechoiceselection.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.IHostUISupportsMultipleChoiceSelection.PromptForChoice)

- [<span data-ttu-id="7199b-207">System.Management.Automation.Host.Pshostuserinterface.PromptForCredential\*</span><span class="sxs-lookup"><span data-stu-id="7199b-207">System.Management.Automation.Host.Pshostuserinterface.PromptForCredential\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForCredential)

- [<span data-ttu-id="7199b-208">System.Management.Automation.Host.Pshostuserinterface.ReadLine\*</span><span class="sxs-lookup"><span data-stu-id="7199b-208">System.Management.Automation.Host.Pshostuserinterface.ReadLine\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLine)

- [<span data-ttu-id="7199b-209">System.Management.Automation.Host.Pshostuserinterface.ReadLineAsSecureString\*</span><span class="sxs-lookup"><span data-stu-id="7199b-209">System.Management.Automation.Host.Pshostuserinterface.ReadLineAsSecureString\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLineAsSecureString)

### <a name="document-output-objects-rd06"></a><span data-ttu-id="7199b-210">Utdata-Dokumentobjekt (RD06)</span><span class="sxs-lookup"><span data-stu-id="7199b-210">Document Output Objects (RD06)</span></span>

<span data-ttu-id="7199b-211">Windows PowerShell använder objekt som har skrivits till pipelinen.</span><span class="sxs-lookup"><span data-stu-id="7199b-211">Windows PowerShell uses the objects that are written to the pipeline.</span></span> <span data-ttu-id="7199b-212">För användare att dra nytta av de objekt som returneras av varje cmdlet, måste du dokumentera de objekt som returneras och måste du dokumentera medlemmarna i dessa returnerade objekt som används för.</span><span class="sxs-lookup"><span data-stu-id="7199b-212">In order for users to take advantage of the objects that are returned by each cmdlet, you must document the objects that are returned, and you must document what the members of those returned objects are used for.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="7199b-213">Riktlinjer för kod</span><span class="sxs-lookup"><span data-stu-id="7199b-213">Code Guidelines</span></span>

<span data-ttu-id="7199b-214">Följande riktlinjer måste följas när du skriver kod för cmdlet.</span><span class="sxs-lookup"><span data-stu-id="7199b-214">The following guidelines must be followed when writing cmdlet code.</span></span> <span data-ttu-id="7199b-215">När du har hittat en kod riktlinje som gäller för din situation bör du titta på designriktlinjer för liknande riktlinjer.</span><span class="sxs-lookup"><span data-stu-id="7199b-215">When you find a Code guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="derive-from-the-cmdlet-or-pscmdlet-classes-rc01"></a><span data-ttu-id="7199b-216">Härledd från Cmdlet eller PSCmdlet klasser (RC01)</span><span class="sxs-lookup"><span data-stu-id="7199b-216">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>

<span data-ttu-id="7199b-217">En cmdlet måste komma från antingen den [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) eller [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) basklassen.</span><span class="sxs-lookup"><span data-stu-id="7199b-217">A cmdlet must derive from either the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) or [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="7199b-218">Cmdlet: ar som härleds från den [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) klass inte beror på en Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7199b-218">Cmdlets that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class do not depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="7199b-219">De kan anropas direkt från alla Microsoft .NET Framework-språk.</span><span class="sxs-lookup"><span data-stu-id="7199b-219">They can be called directly from any Microsoft .NET Framework language.</span></span> <span data-ttu-id="7199b-220">Cmdlet: ar som härleds från den [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) klass beror på en Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7199b-220">Cmdlets that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="7199b-221">Därför kan köras de inom ett körningsutrymme.</span><span class="sxs-lookup"><span data-stu-id="7199b-221">Therefore, they execute within a runspace.</span></span>

<span data-ttu-id="7199b-222">Alla cmdlet-klasser som du implementerar måste vara offentliga klasser.</span><span class="sxs-lookup"><span data-stu-id="7199b-222">All cmdlet classes that you implement must be public classes.</span></span> <span data-ttu-id="7199b-223">Mer information om dessa cmdlet-klasserna finns [cmdlet: en översikt över](./cmdlet-overview.md).</span><span class="sxs-lookup"><span data-stu-id="7199b-223">For more information about these cmdlet classes, see [Cmdlet Overview](./cmdlet-overview.md).</span></span>

### <a name="specify-the-cmdlet-attribute-rc02"></a><span data-ttu-id="7199b-224">Ange Cmdlet-attribut (RC02)</span><span class="sxs-lookup"><span data-stu-id="7199b-224">Specify the Cmdlet Attribute (RC02)</span></span>

<span data-ttu-id="7199b-225">.NET Framework klass måste vara dekorerad med Cmdlet-attribut för en cmdlet ska kunna identifieras av Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7199b-225">For a cmdlet to be recognized by Windows PowerShell, its .NET Framework class must be decorated with the Cmdlet attribute.</span></span> <span data-ttu-id="7199b-226">Det här attributet anger följande funktioner i cmdleten.</span><span class="sxs-lookup"><span data-stu-id="7199b-226">This attribute specifies the following features of the cmdlet.</span></span>

- <span data-ttu-id="7199b-227">Verb och substantiv-paret som identifierar cmdlet: en.</span><span class="sxs-lookup"><span data-stu-id="7199b-227">The verb-and-noun pair that identifies the cmdlet.</span></span>

- <span data-ttu-id="7199b-228">Standarduppsättningen som används när flera parameteruppsättningar har angetts för parametern.</span><span class="sxs-lookup"><span data-stu-id="7199b-228">The default parameter set that is used when multiple parameter sets are specified.</span></span> <span data-ttu-id="7199b-229">Standard-parameteruppsättningen används när Windows PowerShell inte har tillräckligt med information för att fastställa vilka parametern inställd på att använda.</span><span class="sxs-lookup"><span data-stu-id="7199b-229">The default parameter set is used when Windows PowerShell does not have enough information to determine which parameter set to use.</span></span>

- <span data-ttu-id="7199b-230">Anger om cmdleten stöder anrop till den [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) metod.</span><span class="sxs-lookup"><span data-stu-id="7199b-230">Indicates if the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="7199b-231">Den här metoden visas en bekräftelse till användaren innan cmdleten gör en ändring i systemet.</span><span class="sxs-lookup"><span data-stu-id="7199b-231">This method displays a confirmation message to the user before the cmdlet makes a change to the system.</span></span> <span data-ttu-id="7199b-232">Läs mer om hur begäranden om händelsebekräftelse görs [begär bekräftelse](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="7199b-232">For more information about how confirmation requests are made, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

- <span data-ttu-id="7199b-233">Ange den åtgärd som är associerade med bekräftelsemeddelandet effektnivå (eller allvarlighetsgrad).</span><span class="sxs-lookup"><span data-stu-id="7199b-233">Indicate the impact level (or severity) of the action associated with the confirmation message.</span></span> <span data-ttu-id="7199b-234">I de flesta fall bör du används standardvärdet medium.</span><span class="sxs-lookup"><span data-stu-id="7199b-234">In most cases, the default value of Medium should be used.</span></span> <span data-ttu-id="7199b-235">Läs mer om hur effektnivå påverkar bekräftelse-begäranden som visas för användaren, [begär bekräftelse](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="7199b-235">For more information about how the impact level affects the confirmation requests that are displayed to the user, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

<span data-ttu-id="7199b-236">Läs mer om hur du deklarera cmdlet-attributet [CmdletAttribute deklarationen](./cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="7199b-236">For more information about how to declare the cmdlet attribute, see [CmdletAttribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

### <a name="override-an-input-processing-method-rc03"></a><span data-ttu-id="7199b-237">Åsidosätt indata som bearbetar metod (RC03)</span><span class="sxs-lookup"><span data-stu-id="7199b-237">Override an Input Processing Method (RC03)</span></span>

<span data-ttu-id="7199b-238">För cmdleten att delta i Windows PowerShell-miljö, måste den åsidosätter minst en av följande *inkommande bearbetningsmetoder*.</span><span class="sxs-lookup"><span data-stu-id="7199b-238">For the cmdlet to participate in the Windows PowerShell environment, it must override at least one of the following *input processing methods*.</span></span>

<span data-ttu-id="7199b-239">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) den här metoden anropas en gång och används för att tillhandahålla förväg bearbetnings funktioner.</span><span class="sxs-lookup"><span data-stu-id="7199b-239">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) This method is called one time, and it is used to provide pre-processing functionality.</span></span>

<span data-ttu-id="7199b-240">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) den här metoden anropas flera gånger och används för att tillhandahålla post med funktioner.</span><span class="sxs-lookup"><span data-stu-id="7199b-240">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) This method is called multiple times, and it is used to provide record-by-record functionality.</span></span>

<span data-ttu-id="7199b-241">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) den här metoden anropas en gång och används för att tillhandahålla efterbearbetning funktioner.</span><span class="sxs-lookup"><span data-stu-id="7199b-241">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) This method is called one time, and it is used to provide post-processing functionality.</span></span>

### <a name="specify-the-outputtype-attribute-rc04"></a><span data-ttu-id="7199b-242">Ange OutputType-attributet (RC04)</span><span class="sxs-lookup"><span data-stu-id="7199b-242">Specify the OutputType Attribute (RC04)</span></span>

<span data-ttu-id="7199b-243">OutputType-attributet (introducerades i Windows PowerShell 2.0) anger den typ av .NET Framework som din cmdlet returnerar till pipelinen.</span><span class="sxs-lookup"><span data-stu-id="7199b-243">The OutputType attribute (introduced in Windows PowerShell 2.0) specifies the .NET Framework type that your cmdlet returns to the pipeline.</span></span> <span data-ttu-id="7199b-244">Genom att ange utdatatypen för dina cmdlets du objekten som returneras av cmdlet: mer synliga för andra cmdletar.</span><span class="sxs-lookup"><span data-stu-id="7199b-244">By specifying the output type of your cmdlets you make the objects returned by your cmdlet more discoverable by other cmdlets.</span></span> <span data-ttu-id="7199b-245">Läs mer om att dekorera cmdlet-klassen med det här attributet [OutputType-attributet deklarationen](./outputtype-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="7199b-245">For more information about decorating the cmdlet class with this attribute, see [OutputType Attribute Declaration](./outputtype-attribute-declaration.md).</span></span>

### <a name="do-not-retain-handles-to-output-objects-rc05"></a><span data-ttu-id="7199b-246">Spara inte referenser till utdata-objekt (RC05)</span><span class="sxs-lookup"><span data-stu-id="7199b-246">Do Not Retain Handles to Output Objects (RC05)</span></span>

<span data-ttu-id="7199b-247">Cmdlet: ska inte behålla alla referenser till objekt som skickas till den [System.Management.Automation.Cmdlet.WriteObject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) metod.</span><span class="sxs-lookup"><span data-stu-id="7199b-247">Your cmdlet should not retain any handles to the objects that are passed to the [System.Management.Automation.Cmdlet.WriteObject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="7199b-248">De här objekten skickas till cmdleten nästa i pipelinen, eller de används av ett skript.</span><span class="sxs-lookup"><span data-stu-id="7199b-248">These objects are passed to the next cmdlet in the pipeline, or they are used by a script.</span></span> <span data-ttu-id="7199b-249">Om du behåller referenser till objekten som två entiteter äger varje objektet, vilket leder till fel.</span><span class="sxs-lookup"><span data-stu-id="7199b-249">If you retain the handles to the objects, two entities will own each object, which causes errors.</span></span>

### <a name="handle-errors-robustly-rc06"></a><span data-ttu-id="7199b-250">Hantera fel kraftigare (RC06)</span><span class="sxs-lookup"><span data-stu-id="7199b-250">Handle Errors Robustly (RC06)</span></span>

<span data-ttu-id="7199b-251">En miljö för administration identifierar sin natur och gör viktiga ändringar i systemet som du administrerar.</span><span class="sxs-lookup"><span data-stu-id="7199b-251">An administration environment inherently detects and makes important changes to the system that you are administering.</span></span> <span data-ttu-id="7199b-252">Därför är det viktigt att cmdletar hantera fel på rätt sätt.</span><span class="sxs-lookup"><span data-stu-id="7199b-252">Therefore, it is vital that cmdlets handle errors correctly.</span></span> <span data-ttu-id="7199b-253">Mer information om felposter finns i [felrapportering för Windows PowerShell](./error-reporting-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="7199b-253">For more information about error records, see [Windows PowerShell Error Reporting](./error-reporting-concepts.md).</span></span>

- <span data-ttu-id="7199b-254">När ett fel förhindrar att en cmdlet fortsätter att bearbeta några fler poster, är det ett avslutande fel.</span><span class="sxs-lookup"><span data-stu-id="7199b-254">When an error prevents a cmdlet from continuing to process any more records, it is a terminating error.</span></span> <span data-ttu-id="7199b-255">Cmdlet: en måste anropa den [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) metod som refererar till en [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) objekt.</span><span class="sxs-lookup"><span data-stu-id="7199b-255">The cmdlet must call the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="7199b-256">Om ett undantag inte påträffades av cmdlet: en, utlöser Windows PowerShell-runtime själva ett avslutande fel med mindre information.</span><span class="sxs-lookup"><span data-stu-id="7199b-256">If an exception is not caught by the cmdlet, the Windows PowerShell runtime itself throws a terminating error that contains less information.</span></span>

- <span data-ttu-id="7199b-257">För ett icke-avslutande fel som inte hindrar igen vid nästa post som kommer från pipelinen (till exempel en post skapas av en annan process) cmdlet: en måste anropa den [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) metod som refererar till en [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) objekt.</span><span class="sxs-lookup"><span data-stu-id="7199b-257">For a non-terminating error that does not stop operation on the next record that is coming from the pipeline (for example, a record produced by a different process), the cmdlet must call the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="7199b-258">Ett exempel på ett icke-avslutande fel är fel som uppstår om en viss process som inte går att stoppa.</span><span class="sxs-lookup"><span data-stu-id="7199b-258">An example of a non-terminating error is the error that occurs if a particular process fails to stop.</span></span> <span data-ttu-id="7199b-259">Anropa den [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) metoden kan användaren konsekvent utföra åtgärder som begärts och att lagra information för specifika åtgärder som misslyckas.</span><span class="sxs-lookup"><span data-stu-id="7199b-259">Calling the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method allows the user to consistently perform the actions requested and to retain the information for particular actions that fail.</span></span> <span data-ttu-id="7199b-260">Cmdlet: bör hantera varje post oberoende som möjligt.</span><span class="sxs-lookup"><span data-stu-id="7199b-260">Your cmdlet should handle each record as independently as possible.</span></span>

- <span data-ttu-id="7199b-261">Den [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) objekt som refererar till den [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) och [ System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) metoder kräver ett undantag kärnpunkter.</span><span class="sxs-lookup"><span data-stu-id="7199b-261">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object that is referenced by the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) and [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) methods requires an exception at its core.</span></span> <span data-ttu-id="7199b-262">Följ riktlinjerna för .NET Framework-design när du bestämmer undantaget att använda.</span><span class="sxs-lookup"><span data-stu-id="7199b-262">Follow the .NET Framework design guidelines when you determine the exception to use.</span></span> <span data-ttu-id="7199b-263">Om felet är från samma som ett befintligt undantag kan använda detta undantag eller härledd från detta undantag.</span><span class="sxs-lookup"><span data-stu-id="7199b-263">If the error is semantically the same as an existing exception, use that exception or derive from that exception.</span></span> <span data-ttu-id="7199b-264">Annars kan härleda ett nytt undantag eller undantag hierarki direkt från den [System.Exception](/dotnet/api/System.Exception) typen.</span><span class="sxs-lookup"><span data-stu-id="7199b-264">Otherwise, derive a new exception or exception hierarchy directly from the [System.Exception](/dotnet/api/System.Exception) type.</span></span>

<span data-ttu-id="7199b-265">En [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) objekt kräver också en felkategori som grupperar fel för användaren.</span><span class="sxs-lookup"><span data-stu-id="7199b-265">An [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object also requires an error category that groups errors for the user.</span></span> <span data-ttu-id="7199b-266">Du kan visa fel baserat på kategori genom att ange värdet för den `$ErrorView` gränssnittsvariabeln till CategoryView.</span><span class="sxs-lookup"><span data-stu-id="7199b-266">The user can view errors based on the category by setting the value of the `$ErrorView` shell variable to CategoryView.</span></span> <span data-ttu-id="7199b-267">Möjliga grupper definieras av den [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) uppräkning.</span><span class="sxs-lookup"><span data-stu-id="7199b-267">The possible categories are defined by the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) enumeration.</span></span>

- <span data-ttu-id="7199b-268">Om en cmdlet skapar en ny tråd, och om den kod som körs i den tråden kastar ett ohanterat undantag, kommer inte att fånga felet i Windows PowerShell och kommer att avsluta processen.</span><span class="sxs-lookup"><span data-stu-id="7199b-268">If a cmdlet creates a new thread, and if the code that is running in that thread throws an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span>

- <span data-ttu-id="7199b-269">Om ett objekt har kod i dess destruktorn som orsakar ett ohanterat undantag, kommer inte att fånga felet i Windows PowerShell och kommer att avsluta processen.</span><span class="sxs-lookup"><span data-stu-id="7199b-269">If an object has code in its destructor that causes an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span> <span data-ttu-id="7199b-270">Detta inträffar även om ett objekt anropar Dispose metoder som orsakar ett ohanterat undantag.</span><span class="sxs-lookup"><span data-stu-id="7199b-270">This also occurs if an object calls Dispose methods that cause an unhandled exception.</span></span>

### <a name="use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07"></a><span data-ttu-id="7199b-271">Använda en Windows PowerShell-modul för att distribuera dina Cmdlets (RC07)</span><span class="sxs-lookup"><span data-stu-id="7199b-271">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>

<span data-ttu-id="7199b-272">Skapa en Windows PowerShell-modul för att paketera och distribuera dina cmdlets.</span><span class="sxs-lookup"><span data-stu-id="7199b-272">Create a Windows PowerShell module to package and deploy your cmdlets.</span></span> <span data-ttu-id="7199b-273">Stöd för moduler som introducerades i Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="7199b-273">Support for modules is introduced in Windows PowerShell 2.0.</span></span> <span data-ttu-id="7199b-274">Du kan använda de paket som innehåller cmdlet-klasser direkt som modulen binära filer (detta är användbart när du testar dina cmdlets) eller du kan skapa ett modulmanifest som refererar till cmdlet-sammansättningar.</span><span class="sxs-lookup"><span data-stu-id="7199b-274">You can use the assemblies that contain your cmdlet classes directly as binary module files (this is very useful when testing your cmdlets), or you can create a module manifest that references the cmdlet assemblies.</span></span> <span data-ttu-id="7199b-275">(Du kan också lägga till befintliga snapin-modulen sammansättningar när du använder moduler.) Läs mer om moduler [skriva en Windows PowerShell-modul](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="7199b-275">(You can also add existing snap-in assemblies when using modules.) For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="7199b-276">Se även</span><span class="sxs-lookup"><span data-stu-id="7199b-276">See Also</span></span>

[<span data-ttu-id="7199b-277">Vi rekommenderar utveckling riktlinjer</span><span class="sxs-lookup"><span data-stu-id="7199b-277">Strongly Encouraged Development Guidelines</span></span>](./strongly-encouraged-development-guidelines.md)

[<span data-ttu-id="7199b-278">Riktlinjer för rådgivande utveckling</span><span class="sxs-lookup"><span data-stu-id="7199b-278">Advisory Development Guidelines</span></span>](./advisory-development-guidelines.md)

[<span data-ttu-id="7199b-279">Skriva en Windows PowerShell-Cmdlet</span><span class="sxs-lookup"><span data-stu-id="7199b-279">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)

---
title: Skapa en Windows PowerShell-egenskap-Provider | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- property providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], property provider
ms.assetid: a6adca44-b94b-4103-9970-a9b414355e60
caps.latest.revision: 5
ms.openlocfilehash: ade8fbd38e4f4a675e825b0d8850af0379c9d211
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 02/03/2019
ms.locfileid: "56848841"
---
# <a name="creating-a-windows-powershell-property-provider"></a><span data-ttu-id="50e41-102">Skapa en Windows PowerShell-egenskapsprovider</span><span class="sxs-lookup"><span data-stu-id="50e41-102">Creating a Windows PowerShell Property Provider</span></span>

<span data-ttu-id="50e41-103">Det här avsnittet beskriver hur du skapar en provider som gör att användaren kan ändra egenskaperna för objekt i ett datalager.</span><span class="sxs-lookup"><span data-stu-id="50e41-103">This topic describes how to create a provider that enables the user to manipulate the properties of items in a data store.</span></span> <span data-ttu-id="50e41-104">Följaktligen kommer kallas den här typen av providern en provider för Windows PowerShell-egenskapen.</span><span class="sxs-lookup"><span data-stu-id="50e41-104">As a consequence, this type of provider is referred to as a Windows PowerShell property provider.</span></span> <span data-ttu-id="50e41-105">Till exempel en register-provider som tillhandahålls av Windows PowerShell hanterar registernyckelvärden som egenskaper för viktiga registerobjekt.</span><span class="sxs-lookup"><span data-stu-id="50e41-105">For example, the Registry provider provided by Windows PowerShell handles registry key values as properties of the registry key item.</span></span> <span data-ttu-id="50e41-106">Den här typen av providern måste lägga till den [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) gränssnitt för implementeringen av .NET-klass.</span><span class="sxs-lookup"><span data-stu-id="50e41-106">This type of provider must add the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface to the implementation of the .NET class.</span></span>

> [!NOTE]
> <span data-ttu-id="50e41-107">Windows PowerShell innehåller en mallfil som du kan använda för att utveckla en Windows PowerShell-providern.</span><span class="sxs-lookup"><span data-stu-id="50e41-107">Windows PowerShell provides a template file that you can use to develop a Windows PowerShell provider.</span></span> <span data-ttu-id="50e41-108">TemplateProvider.cs-filen är tillgänglig på Microsoft Windows Software Development Kit för Windows Vista och .NET Framework 3.0 Runtime-komponenter.</span><span class="sxs-lookup"><span data-stu-id="50e41-108">The TemplateProvider.cs file is available on the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="50e41-109">Hämta anvisningar finns i [hur du installerar Windows PowerShell och ladda ned Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="50e41-109">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="50e41-110">Windows PowerShell innehåller en mallfil som du kan använda för att utveckla en Windows PowerShell-providern.</span><span class="sxs-lookup"><span data-stu-id="50e41-110">Windows PowerShell provides a template file that you can use to develop a Windows PowerShell provider.</span></span> <span data-ttu-id="50e41-111">TemplateProvider.cs-filen är tillgänglig på Microsoft Windows Software Development Kit för Windows Vista och .NET Framework 3.0 Runtime-komponenter.</span><span class="sxs-lookup"><span data-stu-id="50e41-111">The TemplateProvider.cs file is available on the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="50e41-112">Hämta anvisningar finns i [hur du installerar Windows PowerShell och ladda ned Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="50e41-112">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="50e41-113">Den nedladdningsbara mallen finns i den  **\<PowerShell-exempel >** directory.</span><span class="sxs-lookup"><span data-stu-id="50e41-113">The downloaded template is available in the **\<PowerShell Samples>** directory.</span></span> <span data-ttu-id="50e41-114">Du bör göra en kopia av den här filen och använder kopian för att skapa en ny Windows PowerShell-provider, ta bort funktioner som du inte behöver.</span><span class="sxs-lookup"><span data-stu-id="50e41-114">You should make a copy of this file and use the copy for creating a new Windows PowerShell provider, removing any functionality that you do not need.</span></span>
>
> <span data-ttu-id="50e41-115">Läs mer om andra Windows PowerShell-providern implementeringar [designa din Windows PowerShell-providern](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="50e41-115">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

> [!CAUTION]
> <span data-ttu-id="50e41-116">Metoderna i egenskapen-providern ska skriva eventuella objekt med hjälp av den [System.Management.Automation.Provider.Cmdletprovider.Writepropertyobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WritePropertyObject) metod.</span><span class="sxs-lookup"><span data-stu-id="50e41-116">The methods of your property provider should write any objects using the [System.Management.Automation.Provider.Cmdletprovider.Writepropertyobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WritePropertyObject) method.</span></span>

<span data-ttu-id="50e41-117">I följande lista innehåller avsnitt i det här avsnittet.</span><span class="sxs-lookup"><span data-stu-id="50e41-117">The following list contains the sections in this topic.</span></span> <span data-ttu-id="50e41-118">Om du är bekant med att skriva en provider för Windows PowerShell-egenskapen kan läsa den här informationen i den ordning som det visas.</span><span class="sxs-lookup"><span data-stu-id="50e41-118">If you are unfamiliar with writing a Windows PowerShell property provider, read this information in the order that it appears.</span></span> <span data-ttu-id="50e41-119">Men om du är bekant med att skriva en provider för Windows PowerShell-egenskapen, gå direkt till den information du behöver.</span><span class="sxs-lookup"><span data-stu-id="50e41-119">However, if you are familiar with writing a Windows PowerShell property provider, please go directly to the information that you need.</span></span>

- [<span data-ttu-id="50e41-120">Definiera Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="50e41-120">Defining the Windows PowerShell Provider</span></span>](#Defining-the-Windows-PowerShell-provider)

- [<span data-ttu-id="50e41-121">Definiera grundfunktionen</span><span class="sxs-lookup"><span data-stu-id="50e41-121">Defining Base Functionality</span></span>](#Defining-Base-Functionality)

- [<span data-ttu-id="50e41-122">Hämta egenskaper</span><span class="sxs-lookup"><span data-stu-id="50e41-122">Retrieving Properties</span></span>](#Retrieving-Properties)

- [<span data-ttu-id="50e41-123">Koppla dynamiska parametrar till den `Get-ItemProperty` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="50e41-123">Attaching Dynamic Parameters to the `Get-ItemProperty` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Get-ItemProperty-Cmdlet)

- [<span data-ttu-id="50e41-124">Ange egenskaper</span><span class="sxs-lookup"><span data-stu-id="50e41-124">Setting Properties</span></span>](#Setting-Properties)

- [<span data-ttu-id="50e41-125">Koppla dynamiska parametrar till den `Set-ItemProperty` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="50e41-125">Attaching Dynamic Parameters to the `Set-ItemProperty` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-for-the-Set-ItemProperty-Cmdlet)

- [<span data-ttu-id="50e41-126">Tar bort en egenskapen</span><span class="sxs-lookup"><span data-stu-id="50e41-126">Clearing a Property</span></span>](#Clearing-Properties)

- [<span data-ttu-id="50e41-127">Koppla dynamiska parametrar till den `Clear-ItemProperty` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="50e41-127">Attaching Dynamic Parameters to the `Clear-ItemProperty` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Clear-ItemProperty-Cmdlet)

- [<span data-ttu-id="50e41-128">Att skapa Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="50e41-128">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-provider)

## <a name="defining-the-windows-powershell-provider"></a><span data-ttu-id="50e41-129">Definiera Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="50e41-129">Defining the Windows PowerShell provider</span></span>

<span data-ttu-id="50e41-130">En Egenskapsprovider måste skapa en .NET-klass som har stöd för den [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) gränssnitt.</span><span class="sxs-lookup"><span data-stu-id="50e41-130">A property provider must create a .NET class that supports the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface.</span></span> <span data-ttu-id="50e41-131">Här är standard klassdeklarationen från filen TemplateProvider.cs som tillhandahålls av Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="50e41-131">Here is the default class declaration from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclassdeclaration](Msh_samplestestcmdlets#testcmdletspropertyproviderclassdeclaration)]  -->

## <a name="defining-base-functionality"></a><span data-ttu-id="50e41-132">Definiera grundfunktionen</span><span class="sxs-lookup"><span data-stu-id="50e41-132">Defining Base Functionality</span></span>

<span data-ttu-id="50e41-133">Den [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) gränssnitt kan kopplas till någon av provider-basklasser, med undantag för den [ System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) klass.</span><span class="sxs-lookup"><span data-stu-id="50e41-133">The [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface can be attached to any of the provider base classes, with the exception of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) class.</span></span> <span data-ttu-id="50e41-134">Lägg till grundläggande funktioner som krävs av den basklass som du använder.</span><span class="sxs-lookup"><span data-stu-id="50e41-134">Add the base functionality that is required by the base class you are using.</span></span> <span data-ttu-id="50e41-135">Läs mer om basklasser [designa din Windows PowerShell-providern](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="50e41-135">For more information about base classes, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

## <a name="retrieving-properties"></a><span data-ttu-id="50e41-136">Hämta egenskaper</span><span class="sxs-lookup"><span data-stu-id="50e41-136">Retrieving Properties</span></span>

<span data-ttu-id="50e41-137">Om du vill hämta egenskaper för providern måste implementera de [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) metod för att stödja anrop från den `Get-ItemProperty` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="50e41-137">To retrieve properties, the provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method to support calls from the `Get-ItemProperty` cmdlet.</span></span> <span data-ttu-id="50e41-138">Den här metoden hämtar egenskaperna för objekt som finns på den angivna provider interna sökvägen (fullständigt).</span><span class="sxs-lookup"><span data-stu-id="50e41-138">This method retrieves the properties of the item located at the specified provider-internal path (fully-qualified).</span></span>

<span data-ttu-id="50e41-139">Den `providerSpecificPickList` parametern anger vilka egenskaper du vill hämta.</span><span class="sxs-lookup"><span data-stu-id="50e41-139">The `providerSpecificPickList` parameter indicates which properties to retrieve.</span></span> <span data-ttu-id="50e41-140">Om den här parametern `null` eller tom, metoden bör hämta alla egenskaper.</span><span class="sxs-lookup"><span data-stu-id="50e41-140">If this parameter is `null` or empty, the method should retrieve all properties.</span></span> <span data-ttu-id="50e41-141">Dessutom [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) skriver en instans av en [System.Management.Automation.Psobject](/dotnet/api/System.Management.Automation.PSObject) objekt som representerar en Egenskapsuppsättning för egenskaperna hämtades.</span><span class="sxs-lookup"><span data-stu-id="50e41-141">In addition, [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) writes an instance of a [System.Management.Automation.Psobject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the retrieved properties.</span></span> <span data-ttu-id="50e41-142">Metoden ska returnera ingenting.</span><span class="sxs-lookup"><span data-stu-id="50e41-142">The method should return nothing.</span></span>

<span data-ttu-id="50e41-143">Vi rekommenderar att implementeringen av [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) stöder jokertecken utökningen av egenskapsnamn för varje element i listan.</span><span class="sxs-lookup"><span data-stu-id="50e41-143">It is recommended that the implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) supports the wildcard expansion of property names for each element in the pick list.</span></span> <span data-ttu-id="50e41-144">Gör detta genom att använda den [System.Management.Automation.Wildcardpattern](/dotnet/api/System.Management.Automation.WildcardPattern) klassen för att utföra den jokerteckensmönster.</span><span class="sxs-lookup"><span data-stu-id="50e41-144">To do this, use the [System.Management.Automation.Wildcardpattern](/dotnet/api/System.Management.Automation.WildcardPattern) class to perform the wildcard pattern matching.</span></span>

<span data-ttu-id="50e41-145">Här är standardimplementering av [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) från filen TemplateProvider.cs som tillhandahålls av Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="50e41-145">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidergetproperty](Msh_samplestestcmdlets#testcmdletspropertyprovidergetproperty)]  -->

#### <a name="things-to-remember-about-implementing-getproperty"></a><span data-ttu-id="50e41-146">Kom ihåg följande om hur du implementerar GetProperty</span><span class="sxs-lookup"><span data-stu-id="50e41-146">Things to Remember About Implementing GetProperty</span></span>

<span data-ttu-id="50e41-147">Följande villkor kan tillkomma för din implementering av [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty):</span><span class="sxs-lookup"><span data-stu-id="50e41-147">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty):</span></span>

- <span data-ttu-id="50e41-148">När du definierar providerklassen, en provider för Windows PowerShell-egenskapen kan deklarera provider-funktionerna i ExpandWildcards, Filter, inkludera eller exkludera, från den [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) uppräkning.</span><span class="sxs-lookup"><span data-stu-id="50e41-148">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="50e41-149">I dessa fall är implementeringen av den [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) metod måste se till att sökvägen skickas till metoden uppfyller kraven för den angivna funktioner.</span><span class="sxs-lookup"><span data-stu-id="50e41-149">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="50e41-150">Gör detta genom metoden ska komma åt egenskapen lämplig, till exempel, [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) och [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) egenskaper.</span><span class="sxs-lookup"><span data-stu-id="50e41-150">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="50e41-151">Som standard åsidosättningar av den här metoden ska inte att hämta en läsare för objekt som är dolda från användaren, såvida inte den [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) är inställd på `true`.</span><span class="sxs-lookup"><span data-stu-id="50e41-151">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="50e41-152">Ett fel ska skrivas om sökvägen representerar ett objekt som är dolda från användaren och [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) är inställd på `false`.</span><span class="sxs-lookup"><span data-stu-id="50e41-152">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-itemproperty-cmdlet"></a><span data-ttu-id="50e41-153">Bifoga dynamiska parametrar till cmdleten Get-itemproperty-egenskap</span><span class="sxs-lookup"><span data-stu-id="50e41-153">Attaching Dynamic Parameters to the Get-ItemProperty Cmdlet</span></span>

<span data-ttu-id="50e41-154">Den `Get-ItemProperty` cmdlet kan kräva ytterligare parametrar som anges dynamiskt vid körning.</span><span class="sxs-lookup"><span data-stu-id="50e41-154">The `Get-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="50e41-155">För att ge dessa dynamiska parametrar, Windows PowerShell-egenskapen leverantören måste implementera de [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) metod.</span><span class="sxs-lookup"><span data-stu-id="50e41-155">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) method.</span></span> <span data-ttu-id="50e41-156">Den `path` parametern indikerar en fullständiga provider-internt sökväg, medan den `providerSpecificPickList` parametern anger provider-specifik-egenskaper som anges på kommandoraden.</span><span class="sxs-lookup"><span data-stu-id="50e41-156">The `path` parameter indicates a fully-qualified provider-internal path, while the `providerSpecificPickList` parameter specifies the provider-specific properties entered on the command line.</span></span> <span data-ttu-id="50e41-157">Den här parametern kan vara `null` eller tom om egenskaperna är skickas till cmdleten.</span><span class="sxs-lookup"><span data-stu-id="50e41-157">This parameter might be `null` or empty if the properties are piped to the cmdlet.</span></span> <span data-ttu-id="50e41-158">I det här fallet den här metoden returnerar ett objekt med egenskaper och fält med parsning attribut som liknar en cmdlet-klass eller en [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objekt.</span><span class="sxs-lookup"><span data-stu-id="50e41-158">In this case, this method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="50e41-159">Windows PowerShell-runtime använder det returnerade objektet för att lägga till parametrar till cmdleten.</span><span class="sxs-lookup"><span data-stu-id="50e41-159">The Windows PowerShell runtime uses the returned object to add the parameters to the cmdlet.</span></span>

<span data-ttu-id="50e41-160">Här är standardimplementering av [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) från filen TemplateProvider.cs som tillhandahålls av Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="50e41-160">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidergetpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyprovidergetpropertydynamicparameters)]  -->

## <a name="setting-properties"></a><span data-ttu-id="50e41-161">Ange egenskaper</span><span class="sxs-lookup"><span data-stu-id="50e41-161">Setting Properties</span></span>

<span data-ttu-id="50e41-162">Om du vill ange egenskaper för Windows PowerShell-egenskapen leverantören måste implementera de [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) metod för att stödja anrop från den `Set-ItemProperty` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="50e41-162">To set properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method to support calls from the `Set-ItemProperty` cmdlet.</span></span> <span data-ttu-id="50e41-163">Den här metoden anger en eller flera egenskaper för objektet på den angivna sökvägen och skriver över de angivna egenskaperna som krävs.</span><span class="sxs-lookup"><span data-stu-id="50e41-163">This method sets one or more properties of the item at the specified path, and overwrites the supplied properties as required.</span></span> <span data-ttu-id="50e41-164">[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) skriver också en instans av en [System.Management.Automation.Psobject](/dotnet/api/System.Management.Automation.PSObject) objekt som representerar en egenskapsuppsättning för den uppdaterade Egenskaper.</span><span class="sxs-lookup"><span data-stu-id="50e41-164">[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) also writes an instance of a [System.Management.Automation.Psobject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the updated properties.</span></span>

<span data-ttu-id="50e41-165">Här är standardimplementering av [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) från filen TemplateProvider.cs som tillhandahålls av Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="50e41-165">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidersetproperty](Msh_samplestestcmdlets#testcmdletspropertyprovidersetproperty)]  -->

#### <a name="things-to-remember-about-implementing-set-itemproperty"></a><span data-ttu-id="50e41-166">Kom ihåg följande om hur du implementerar Set-itemproperty-egenskap</span><span class="sxs-lookup"><span data-stu-id="50e41-166">Things to Remember About Implementing Set-ItemProperty</span></span>

<span data-ttu-id="50e41-167">Följande villkor kan gälla för en implementering av [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty):</span><span class="sxs-lookup"><span data-stu-id="50e41-167">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty):</span></span>

- <span data-ttu-id="50e41-168">När du definierar providerklassen, en provider för Windows PowerShell-egenskapen kan deklarera provider-funktionerna i ExpandWildcards, Filter, inkludera eller exkludera, från den [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) uppräkning.</span><span class="sxs-lookup"><span data-stu-id="50e41-168">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="50e41-169">I dessa fall är implementeringen av den [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) metod måste se till att sökvägen skickas till metoden uppfyller kraven för den angivna funktioner.</span><span class="sxs-lookup"><span data-stu-id="50e41-169">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="50e41-170">Gör detta genom metoden ska komma åt egenskapen lämplig, till exempel, [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) och [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) egenskaper.</span><span class="sxs-lookup"><span data-stu-id="50e41-170">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="50e41-171">Som standard åsidosättningar av den här metoden ska inte att hämta en läsare för objekt som är dolda från användaren, såvida inte den [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) är inställd på `true`.</span><span class="sxs-lookup"><span data-stu-id="50e41-171">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="50e41-172">Ett fel ska skrivas om sökvägen representerar ett objekt som är dolda från användaren och [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) är inställd på `false`.</span><span class="sxs-lookup"><span data-stu-id="50e41-172">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="50e41-173">Implementeringen av den [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) metoden ska anropa [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\* ](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) och verifiera dess returvärdet innan du gör några ändringar i datalagret.</span><span class="sxs-lookup"><span data-stu-id="50e41-173">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="50e41-174">Den här metoden används för att bekräfta körning av en åtgärd när en ändring görs i systemtillståndet, till exempel byta namn på filer.</span><span class="sxs-lookup"><span data-stu-id="50e41-174">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span> <span data-ttu-id="50e41-175">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) skickar namnet på resursen som ska ändras till användaren med Windows PowerShell-runtime och hantering av alla kommandoradsinställningar eller variabler i bestämma vad som ska visas.</span><span class="sxs-lookup"><span data-stu-id="50e41-175">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime and handling any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="50e41-176">Efter anropet till [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returnerar `true`om potentiellt skadliga system ändringar kan göras, den [ System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) metoden ska anropa den [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) metod.</span><span class="sxs-lookup"><span data-stu-id="50e41-176">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="50e41-177">Den här metoden skickar en bekräftelse till användaren så att ytterligare feedback att indikera att åtgärden bör fortsätta.</span><span class="sxs-lookup"><span data-stu-id="50e41-177">This method sends a confirmation message to the user to allow additional feedback to indicate that the operation should be continued.</span></span>

## <a name="attaching-dynamic-parameters-for-the-set-itemproperty-cmdlet"></a><span data-ttu-id="50e41-178">Koppla dynamiska parametrar för cmdleten Set-itemproperty-egenskap</span><span class="sxs-lookup"><span data-stu-id="50e41-178">Attaching Dynamic Parameters for the Set-ItemProperty Cmdlet</span></span>

<span data-ttu-id="50e41-179">Den `Set-ItemProperty` cmdlet kan kräva ytterligare parametrar som anges dynamiskt vid körning.</span><span class="sxs-lookup"><span data-stu-id="50e41-179">The `Set-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="50e41-180">För att ge dessa dynamiska parametrar, Windows PowerShell-egenskapen leverantören måste implementera de [System.Management.Automation.Provider.Ipropertycmdletprovider.Setpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetPropertyDynamicParameters) metod.</span><span class="sxs-lookup"><span data-stu-id="50e41-180">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetPropertyDynamicParameters) method.</span></span> <span data-ttu-id="50e41-181">Den här metoden returnerar ett objekt med egenskaper och fält med parsning attribut som liknar en cmdlet-klass eller en [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objekt.</span><span class="sxs-lookup"><span data-stu-id="50e41-181">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="50e41-182">Den `null` värde kan returneras om inga dynamiska parametrar som ska läggas till.</span><span class="sxs-lookup"><span data-stu-id="50e41-182">The `null` value can be returned if no dynamic parameters are to be added.</span></span>

<span data-ttu-id="50e41-183">Här är standardimplementering av [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) från filen TemplateProvider.cs som tillhandahålls av Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="50e41-183">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidersetpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyprovidersetpropertydynamicparameters)]  -->

## <a name="clearing-properties"></a><span data-ttu-id="50e41-184">Rensa egenskaper</span><span class="sxs-lookup"><span data-stu-id="50e41-184">Clearing Properties</span></span>

<span data-ttu-id="50e41-185">Om du vill rensa egenskaper för Windows PowerShell-egenskapen leverantören måste implementera de [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) metod för att stödja anrop från den `Clear-ItemProperty` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="50e41-185">To clear properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method to support calls from the `Clear-ItemProperty` cmdlet.</span></span> <span data-ttu-id="50e41-186">Den här metoden anger en eller flera egenskaper för objekt som finns på den angivna sökvägen.</span><span class="sxs-lookup"><span data-stu-id="50e41-186">This method sets one or more properties for the item located at the specified path.</span></span>

<span data-ttu-id="50e41-187">Här är standardimplementering av [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) från filen TemplateProvider.cs som tillhandahålls av Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="50e41-187">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclearproperty](Msh_samplestestcmdlets#testcmdletspropertyproviderclearproperty)]  -->

#### <a name="thing-to-remember-about-implementing-clearproperty"></a><span data-ttu-id="50e41-188">Viktigt att komma ihåg om hur du implementerar ClearProperty</span><span class="sxs-lookup"><span data-stu-id="50e41-188">Thing to Remember About Implementing ClearProperty</span></span>

<span data-ttu-id="50e41-189">Följande villkor kan tillkomma för din implementering av [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty):</span><span class="sxs-lookup"><span data-stu-id="50e41-189">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty):</span></span>

- <span data-ttu-id="50e41-190">När du definierar providerklassen, en provider för Windows PowerShell-egenskapen kan deklarera provider-funktionerna i ExpandWildcards, Filter, inkludera eller exkludera, från den [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) uppräkning.</span><span class="sxs-lookup"><span data-stu-id="50e41-190">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="50e41-191">I dessa fall är implementeringen av den [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) metod måste se till att sökvägen skickas till metoden uppfyller kraven för den angivna funktioner.</span><span class="sxs-lookup"><span data-stu-id="50e41-191">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="50e41-192">Gör detta genom metoden ska komma åt egenskapen lämplig, till exempel, [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) och [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) egenskaper.</span><span class="sxs-lookup"><span data-stu-id="50e41-192">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="50e41-193">Som standard åsidosättningar av den här metoden ska inte att hämta en läsare för objekt som är dolda från användaren, såvida inte den [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) är inställd på `true`.</span><span class="sxs-lookup"><span data-stu-id="50e41-193">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="50e41-194">Ett fel ska skrivas om sökvägen representerar ett objekt som är dolda från användaren och [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) är inställd på `false`.</span><span class="sxs-lookup"><span data-stu-id="50e41-194">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="50e41-195">Implementeringen av den [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) metoden ska anropa [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\* ](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) och verifiera dess returvärdet innan du gör några ändringar i datalagret.</span><span class="sxs-lookup"><span data-stu-id="50e41-195">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="50e41-196">Den här metoden används för att bekräfta körning av en åtgärd innan en ändring görs i systemtillstånd, t.ex Rensa innehåll.</span><span class="sxs-lookup"><span data-stu-id="50e41-196">This method is used to confirm execution of an operation before a change is made to system state, such as clearing content.</span></span> <span data-ttu-id="50e41-197">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) skickar namnet på resursen som ska ändras till användaren, med hänsyn till alla inställningar för kommandoraden eller variabler i Windows PowerShell-körningsmiljön bestämma vad som ska visas.</span><span class="sxs-lookup"><span data-stu-id="50e41-197">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="50e41-198">Efter anropet till [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returnerar `true`om potentiellt skadliga system ändringar kan göras, den [ System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) metoden ska anropa den [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) metod.</span><span class="sxs-lookup"><span data-stu-id="50e41-198">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="50e41-199">Den här metoden skickar en bekräftelse till användaren så att ytterligare feedback att indikera att potentiellt skadliga åtgärden bör fortsätta.</span><span class="sxs-lookup"><span data-stu-id="50e41-199">This method sends a confirmation message to the user to allow additional feedback to indicate that the potentially dangerous operation should be continued.</span></span>

## <a name="attaching-dynamic-parameters-to-the-clear-itemproperty-cmdlet"></a><span data-ttu-id="50e41-200">Bifoga dynamiska parametrar till cmdleten Clear-itemproperty-egenskap</span><span class="sxs-lookup"><span data-stu-id="50e41-200">Attaching Dynamic Parameters to the Clear-ItemProperty Cmdlet</span></span>

<span data-ttu-id="50e41-201">Den `Clear-ItemProperty` cmdlet kan kräva ytterligare parametrar som anges dynamiskt vid körning.</span><span class="sxs-lookup"><span data-stu-id="50e41-201">The `Clear-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="50e41-202">För att ge dessa dynamiska parametrar, Windows PowerShell-egenskapen leverantören måste implementera de [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) metod.</span><span class="sxs-lookup"><span data-stu-id="50e41-202">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) method.</span></span> <span data-ttu-id="50e41-203">Den här metoden returnerar ett objekt med egenskaper och fält med parsning attribut som liknar en cmdlet-klass eller en [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objekt.</span><span class="sxs-lookup"><span data-stu-id="50e41-203">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="50e41-204">Den `null` värde kan returneras om inga dynamiska parametrar som ska läggas till.</span><span class="sxs-lookup"><span data-stu-id="50e41-204">The `null` value can be returned if no dynamic parameters are to be added.</span></span>

<span data-ttu-id="50e41-205">Här är standardimplementering av [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) från filen TemplateProvider.cs som tillhandahålls av Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="50e41-205">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclearpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyproviderclearpropertydynamicparameters)]  -->

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="50e41-206">Att skapa Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="50e41-206">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="50e41-207">Se [hur du registrerar Cmdlets, Providers och vara värd för program](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="50e41-207">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>
<span data-ttu-id="50e41-208">Se [hur du registrerar Cmdlets, Providers och vara värd för program](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="50e41-208">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="see-also"></a><span data-ttu-id="50e41-209">Se även</span><span class="sxs-lookup"><span data-stu-id="50e41-209">See Also</span></span>

[<span data-ttu-id="50e41-210">Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="50e41-210">Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="50e41-211">Utforma din Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="50e41-211">Design Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="50e41-212">Utöka objekttyper och formatering</span><span class="sxs-lookup"><span data-stu-id="50e41-212">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="50e41-213">Utöka objekttyper och formatering</span><span class="sxs-lookup"><span data-stu-id="50e41-213">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="50e41-214">Hur du registrerar Cmdlets, Providers och vara värd för program</span><span class="sxs-lookup"><span data-stu-id="50e41-214">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="50e41-215">Hur du registrerar Cmdlets, Providers och vara värd för program</span><span class="sxs-lookup"><span data-stu-id="50e41-215">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)
---
title: Skapa en Windows PowerShell-providern för behållare | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- providers [PowerShell Programmer's Guide], container provider
- container providers [PowerShell Programmer's Guide]
ms.assetid: a7926647-0d18-45b2-967e-b31f92004bc4
caps.latest.revision: 5
ms.openlocfilehash: 8c111f8f2943043e4ad2a6a8677db4afe1b3cdab
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 02/03/2019
ms.locfileid: "56851830"
---
# <a name="creating-a-windows-powershell-container-provider"></a><span data-ttu-id="1d162-102">Skapa en Windows PowerShell-containerprovider</span><span class="sxs-lookup"><span data-stu-id="1d162-102">Creating a Windows PowerShell Container Provider</span></span>

<span data-ttu-id="1d162-103">Det här avsnittet beskriver hur du skapar en Windows PowerShell-providern som fungerar på flera lager datalager.</span><span class="sxs-lookup"><span data-stu-id="1d162-103">This topic describes how to create a Windows PowerShell provider that can work on multi-layer data stores.</span></span> <span data-ttu-id="1d162-104">Den översta nivån i arkivet innehåller rot-objekt för den här typen av datalager och varje efterföljande nivå kallas för en nod i underordnade objekt.</span><span class="sxs-lookup"><span data-stu-id="1d162-104">For this type of data store, the top level of the store contains the root items and each subsequent level is referred to as a node of child items.</span></span> <span data-ttu-id="1d162-105">Genom att tillåta användare att arbeta på dessa underordnade noder, kan en användare interagera hierarkiskt via datalagret.</span><span class="sxs-lookup"><span data-stu-id="1d162-105">By allowing the user to work on these child nodes, a user can interact hierarchically through the data store.</span></span>

<span data-ttu-id="1d162-106">Leverantörer som fungerar på flera nivåer datalager kallas providers för Windows PowerShell-behållare.</span><span class="sxs-lookup"><span data-stu-id="1d162-106">Providers that can work on multi-level data stores are referred to as Windows PowerShell container providers.</span></span> <span data-ttu-id="1d162-107">Men tänk på att en Windows PowerShell-providern för behållare kan användas endast när det är en behållare (inga kapslade behållare) med objekt i den.</span><span class="sxs-lookup"><span data-stu-id="1d162-107">However, be aware that a Windows PowerShell container provider can be used only when there is one container (no nested containers) with items in it.</span></span> <span data-ttu-id="1d162-108">Om det finns kapslade behållare, måste du implementera en Windows PowerShell-providern för navigering.</span><span class="sxs-lookup"><span data-stu-id="1d162-108">If there are nested containers, then you must implement a Windows PowerShell navigation provider.</span></span> <span data-ttu-id="1d162-109">Mer information om hur du implementerar Windows PowerShell navigering-providern finns i [skapar en Windows PowerShell-providern för navigering](./creating-a-windows-powershell-navigation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="1d162-109">For more information about implementing Windows PowerShell navigation provider, see [Creating a Windows PowerShell Navigation Provider](./creating-a-windows-powershell-navigation-provider.md).</span></span>

> [!NOTE]
> <span data-ttu-id="1d162-110">Du kan ladda ned den C# källfilen (AccessDBSampleProvider04.cs) för den här providern med hjälp av Microsoft Windows Software Development Kit för Windows Vista och .NET Framework 3.0 Runtime-komponenter.</span><span class="sxs-lookup"><span data-stu-id="1d162-110">You can download the C# source file (AccessDBSampleProvider04.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="1d162-111">Hämta anvisningar finns i [hur du installerar Windows PowerShell och ladda ned Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="1d162-111">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="1d162-112">Du kan ladda ned den C# källfilen (AccessDBSampleProvider04.cs) för den här providern med hjälp av Microsoft Windows Software Development Kit för Windows Vista och .NET Framework 3.0 Runtime-komponenter.</span><span class="sxs-lookup"><span data-stu-id="1d162-112">You can download the C# source file (AccessDBSampleProvider04.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="1d162-113">Hämta anvisningar finns i [hur du installerar Windows PowerShell och ladda ned Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="1d162-113">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="1d162-114">Hämtade källfilerna är tillgängliga i den  **\<PowerShell-exempel >** directory.</span><span class="sxs-lookup"><span data-stu-id="1d162-114">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="1d162-115">Läs mer om andra Windows PowerShell-providern implementeringar [designa din Windows PowerShell-providern](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="1d162-115">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="1d162-116">Windows PowerShell-container-providern som beskrivs här definierar databasen som den enda behållaren med tabeller och rader för den databas som har definierats som objekt i behållaren.</span><span class="sxs-lookup"><span data-stu-id="1d162-116">The Windows PowerShell container provider described here defines the database as its single container, with the tables and rows of the database defined as items of the container.</span></span>

> [!CAUTION]
> <span data-ttu-id="1d162-117">Tänk på att den här designen förutsätter en databas som har ett fält med namn-ID och att fältet är LongInteger.</span><span class="sxs-lookup"><span data-stu-id="1d162-117">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

<span data-ttu-id="1d162-118">Här är en lista över avsnitt i det här avsnittet.</span><span class="sxs-lookup"><span data-stu-id="1d162-118">Here is a list of the sections in this topic.</span></span> <span data-ttu-id="1d162-119">Läs informationen i den ordning som det visas om du inte är bekant med att skriva en Windows PowerShell-providern för behållaren.</span><span class="sxs-lookup"><span data-stu-id="1d162-119">If you are unfamiliar with writing a Windows PowerShell container provider, please read this information in the order that it appears.</span></span> <span data-ttu-id="1d162-120">Men om du är bekant med att skriva en Windows PowerShell-providern för behållare, gå direkt till den information du behöver.</span><span class="sxs-lookup"><span data-stu-id="1d162-120">However, if you are familiar with writing a Windows PowerShell container provider, please go directly to the information that you need.</span></span>

- [<span data-ttu-id="1d162-121">Definiera en providerklass för Windows PowerShell-behållare</span><span class="sxs-lookup"><span data-stu-id="1d162-121">Defining a Windows PowerShell Container Provider Class</span></span>](#Defining-a-Windows-PowerShell-Container-Provider-Class)

- [<span data-ttu-id="1d162-122">Definiera grundfunktionen</span><span class="sxs-lookup"><span data-stu-id="1d162-122">Defining Base Functionality</span></span>]()

- [<span data-ttu-id="1d162-123">Hämtning av underordnade objekt</span><span class="sxs-lookup"><span data-stu-id="1d162-123">Retrieving Child Items</span></span>](#Retrieving-Child-Items)

- [<span data-ttu-id="1d162-124">Koppla dynamiska parametrar till den `Get-ChildItem` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="1d162-124">Attaching Dynamic Parameters to the `Get-ChildItem` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet)

- [<span data-ttu-id="1d162-125">Hämtning av underordnade objektnamn</span><span class="sxs-lookup"><span data-stu-id="1d162-125">Retrieving Child Item Names</span></span>](#Retrieving-Child-Item-Names)

- <span data-ttu-id="1d162-126">[Koppla dynamiska parametrar till den `Get-ChildItem` Cmdlet (namn)](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet-(Name))</span><span class="sxs-lookup"><span data-stu-id="1d162-126">[Attaching Dynamic Parameters to the `Get-ChildItem` Cmdlet (Name)](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet-(Name))</span></span>

- [<span data-ttu-id="1d162-127">Byta namn på objekt</span><span class="sxs-lookup"><span data-stu-id="1d162-127">Renaming Items</span></span>](#Renaming-Items)

- [<span data-ttu-id="1d162-128">Koppla dynamiska parametrar till den `Rename-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="1d162-128">Attaching Dynamic Parameters to the  `Rename-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Rename-Item-Cmdlet)

- [<span data-ttu-id="1d162-129">Skapa nya objekt</span><span class="sxs-lookup"><span data-stu-id="1d162-129">Creating New Items</span></span>](#Creating-New-Items)

- [<span data-ttu-id="1d162-130">Koppla dynamiska parametrar till den `New-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="1d162-130">Attaching Dynamic Parameters to the `New-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-New-Item-Cmdlet)

- [<span data-ttu-id="1d162-131">Tar bort ett objekt</span><span class="sxs-lookup"><span data-stu-id="1d162-131">Removing a Items</span></span>](#Removing-Items)

- [<span data-ttu-id="1d162-132">Koppla dynamiska parametrar till den `Remove-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="1d162-132">Attaching Dynamic Parameters to the `Remove-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Remove-Item-Cmdlet)

- [<span data-ttu-id="1d162-133">Fråga efter underordnade objekt</span><span class="sxs-lookup"><span data-stu-id="1d162-133">Querying for Child Items</span></span>](#Querying-for-Child-Items)

- [<span data-ttu-id="1d162-134">Klara objekt</span><span class="sxs-lookup"><span data-stu-id="1d162-134">Coping Items</span></span>](#Copying-Items)

- [<span data-ttu-id="1d162-135">Koppla dynamiska parametrar till den `Copy-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="1d162-135">Attaching Dynamic Parameters to the  `Copy-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Copy-Item-Cmdlet)

- [<span data-ttu-id="1d162-136">Kodexempel</span><span class="sxs-lookup"><span data-stu-id="1d162-136">Code Sample</span></span>](#Code-Sample)

- [<span data-ttu-id="1d162-137">Definiera objekttyper och formatering</span><span class="sxs-lookup"><span data-stu-id="1d162-137">Defining Object Types and Formatting</span></span>]()

- [<span data-ttu-id="1d162-138">Att skapa Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="1d162-138">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-Provider)

- [<span data-ttu-id="1d162-139">Testa Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="1d162-139">Testing the Windows PowerShell Provider</span></span>](#Testing-the-Windows-PowerShell-Provider)

## <a name="defining-a-windows-powershell-container-provider-class"></a><span data-ttu-id="1d162-140">Definiera en providerklass för Windows PowerShell-behållare</span><span class="sxs-lookup"><span data-stu-id="1d162-140">Defining a Windows PowerShell Container Provider Class</span></span>

<span data-ttu-id="1d162-141">En Windows PowerShell-providern för behållaren måste definiera en .NET-klass som härleds från den [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) basklassen.</span><span class="sxs-lookup"><span data-stu-id="1d162-141">A Windows PowerShell container provider must define a .NET class that derives from the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="1d162-142">Här är klassdefinitionen för Windows PowerShell-container-providern som beskrivs i det här avsnittet.</span><span class="sxs-lookup"><span data-stu-id="1d162-142">Here is the class definition for the Windows PowerShell container provider described in this section.</span></span>

```csharp
   [CmdletProvider("AccessDB", ProviderCapabilities.None)]
   public class AccessDBProvider : ContainerCmdletProvider
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L34-L35 "AccessDBProviderSample04.cs")]

<span data-ttu-id="1d162-143">Observera att i det här klassdefinitionen, den [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribut innehåller två parametrar.</span><span class="sxs-lookup"><span data-stu-id="1d162-143">Notice that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="1d162-144">Den första parametern anger ett användarvänligt namn för providern som används av Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1d162-144">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="1d162-145">Den andra parametern anger de specifika funktioner i Windows PowerShell som providern visar Windows PowerShell-runtime under bearbetning av kommandot.</span><span class="sxs-lookup"><span data-stu-id="1d162-145">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="1d162-146">Det finns inga specifika Windows PowerShell-funktioner som har lagts till för den här providern.</span><span class="sxs-lookup"><span data-stu-id="1d162-146">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="1d162-147">Definiera grundfunktionen</span><span class="sxs-lookup"><span data-stu-id="1d162-147">Defining Base Functionality</span></span>

<span data-ttu-id="1d162-148">Mer information finns i [designa din Windows PowerShell-providern](./designing-your-windows-powershell-provider.md), [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) klassen härleds från flera klasser som angetts annan provider-funktionalitet.</span><span class="sxs-lookup"><span data-stu-id="1d162-148">As described in [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="1d162-149">En provider för Windows PowerShell-behållare, måste därför definiera alla funktioner som tillhandahålls av dessa klasser.</span><span class="sxs-lookup"><span data-stu-id="1d162-149">A Windows PowerShell container provider, therefore, needs to define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="1d162-150">Om du vill implementera funktioner för att lägga till sessionen-specifika initieringsinformation och för att frisläppa resurser som används av providern, se [skapar en grundläggande Windows PowerShell-providern](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="1d162-150">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="1d162-151">De flesta leverantörer (inklusive providern som beskrivs här) kan dock använda standardimplementering av den här funktionen som tillhandahålls av Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1d162-151">However, most providers (including the provider described here) can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="1d162-152">För att få åtkomst till datalagret för providern måste implementera-metoderna i den [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) basklassen.</span><span class="sxs-lookup"><span data-stu-id="1d162-152">To get access to the data store, the provider must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="1d162-153">Läs mer om hur du implementerar dessa metoder, [skapar en Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="1d162-153">For more information about implementing these methods, see [Creating an Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="1d162-154">Om du vill manipulera objekten i ett datalager, till exempel komma, inställningen och rensar objekt providern måste implementera de metoder som tillhandahålls av den [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) basklassen.</span><span class="sxs-lookup"><span data-stu-id="1d162-154">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="1d162-155">Läs mer om hur du implementerar dessa metoder, [skapa en Windows PowerShell-Provider för objektet](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="1d162-155">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

## <a name="retrieving-child-items"></a><span data-ttu-id="1d162-156">Hämtning av underordnade objekt</span><span class="sxs-lookup"><span data-stu-id="1d162-156">Retrieving Child Items</span></span>

<span data-ttu-id="1d162-157">Om du vill hämta ett underordnat objekt av Windows PowerShell-providern för behållaren måste åsidosätta de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metod för att stödja anrop från den `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="1d162-157">To retrieve a child item, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method to support calls from the `Get-ChildItem` cmdlet.</span></span> <span data-ttu-id="1d162-158">Den här metoden hämtar underordnade objekt från datalagret och skriver dem till pipelinen som objekt.</span><span class="sxs-lookup"><span data-stu-id="1d162-158">This method retrieves child items from the data store and writes them to the pipeline as objects.</span></span> <span data-ttu-id="1d162-159">Om den `recurse` parametern för cmdlet har angetts, metoden hämtar alla underordnade oavsett vilken nivå som de är på.</span><span class="sxs-lookup"><span data-stu-id="1d162-159">If the `recurse` parameter of the cmdlet is specified, the method retrieves all children regardless of what level they are at.</span></span> <span data-ttu-id="1d162-160">Om den `recurse` parametern inte anges, metoden hämtar bara en enda nivå med underordnade.</span><span class="sxs-lookup"><span data-stu-id="1d162-160">If the `recurse` parameter is not specified, the method retrieves only a single level of children.</span></span>

<span data-ttu-id="1d162-161">Här är implementeringen av den [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metod för den här providern.</span><span class="sxs-lookup"><span data-stu-id="1d162-161">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method for this provider.</span></span> <span data-ttu-id="1d162-162">Observera att den här metoden hämtar de underordnade objekten i alla databastabeller när sökvägen anger Access-databas och hämtar de underordnade objekten från raderna i tabellen om sökvägen indikerar en datatabell.</span><span class="sxs-lookup"><span data-stu-id="1d162-162">Notice that this method retrieves the child items in all database tables when the path indicates the Access database, and retrieves the child items from the rows of that table if the path indicates a data table.</span></span>

```csharp
protected override void GetChildItems(string path, bool recurse)
{
    // If path represented is a drive then the children in the path are
    // tables. Hence all tables in the drive represented will have to be
    // returned
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table, path, true);

            // if the specified item exists and recurse has been set then
            // all child items within it have to be obtained as well
            if (ItemExists(path) && recurse)
            {
                GetChildItems(path + pathSeparator + table.Name, recurse);
            }
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get the table name, row number and type of path from the
        // path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Obtain all the rows within the table
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);
            WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
        }
        else
        {
            // In this case, the path specified is not valid
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L311-L362 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchilditems"></a><span data-ttu-id="1d162-163">Kom ihåg följande om hur du implementerar GetChildItems</span><span class="sxs-lookup"><span data-stu-id="1d162-163">Things to Remember About Implementing GetChildItems</span></span>

<span data-ttu-id="1d162-164">Följande villkor kan tillkomma för din implementering av [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="1d162-164">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="1d162-165">När du definierar providerklassen, en Windows PowerShell-providern för behållare kan deklarera provider-funktionerna i ExpandWildcards, Filter, inkludera eller exkludera, från den [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) uppräkning.</span><span class="sxs-lookup"><span data-stu-id="1d162-165">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="1d162-166">I dessa fall är implementeringen av den [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metod måste se till att sökvägen skickas till metoden uppfyller kraven för den angivna funktioner.</span><span class="sxs-lookup"><span data-stu-id="1d162-166">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="1d162-167">Gör detta genom metoden ska komma åt egenskapen lämplig, till exempel, [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) och [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) egenskaper.</span><span class="sxs-lookup"><span data-stu-id="1d162-167">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="1d162-168">Implementeringen av den här metoden bör beakta någon form av åtkomst till objekt som kan göra objektet som är synliga för användaren.</span><span class="sxs-lookup"><span data-stu-id="1d162-168">The implementation of this method should take into account any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="1d162-169">Till exempel om en användare har skrivbehörighet till en fil via filsystemet provider (som tillhandahålls av Windows PowerShell), men inte läsbehörighet kan filen fortfarande finns och [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returnerar `true`.</span><span class="sxs-lookup"><span data-stu-id="1d162-169">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="1d162-170">Implementeringen kan kräva kontroll av en överordnad artikel för att se om underordnat kan ingå.</span><span class="sxs-lookup"><span data-stu-id="1d162-170">Your implementation might require the checking of a parent item to see if the child can be enumerated.</span></span>

- <span data-ttu-id="1d162-171">När du skriver flera objekt i [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metod kan ta lite tid.</span><span class="sxs-lookup"><span data-stu-id="1d162-171">When writing multiple items, the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method can take some time.</span></span> <span data-ttu-id="1d162-172">Du kan utforma din provider för att skriva artiklar som använder den [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) metoden en i taget.</span><span class="sxs-lookup"><span data-stu-id="1d162-172">You can design your provider to write the items using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method one at a time.</span></span> <span data-ttu-id="1d162-173">Med den här tekniken kommer att presentera objekten till användare i en ström.</span><span class="sxs-lookup"><span data-stu-id="1d162-173">Using this technique will present the items to the user in a stream.</span></span>

- <span data-ttu-id="1d162-174">Implementeringen av [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) ansvarar för att förhindra oändlig rekursion när Cirkulära länkar och liknande.</span><span class="sxs-lookup"><span data-stu-id="1d162-174">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="1d162-175">Ett lämpligt avslutande undantag måste undantagsfel för att återspegla dessa villkor.</span><span class="sxs-lookup"><span data-stu-id="1d162-175">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet"></a><span data-ttu-id="1d162-176">Bifoga dynamiska parametrar till cmdleten Get-ChildItem</span><span class="sxs-lookup"><span data-stu-id="1d162-176">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet</span></span>

<span data-ttu-id="1d162-177">Ibland den `Get-ChildItem` cmdlet: en som anropar [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) kräver ytterligare parametrar som anges dynamiskt vid körning.</span><span class="sxs-lookup"><span data-stu-id="1d162-177">Sometimes the `Get-ChildItem` cmdlet that calls [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="1d162-178">För att ge dessa dynamiska parametrar, Windows PowerShell container-providern måste implementera de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) metod.</span><span class="sxs-lookup"><span data-stu-id="1d162-178">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) method.</span></span> <span data-ttu-id="1d162-179">Den här metoden hämtar dynamiska parametrar för objektet på den angivna sökvägen och returnerar ett objekt med egenskaper och fält med parsning attribut som liknar en cmdlet-klass eller en [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objekt.</span><span class="sxs-lookup"><span data-stu-id="1d162-179">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="1d162-180">Windows PowerShell-runtime använder det returnerade objektet för att lägga till parametrar till den `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="1d162-180">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="1d162-181">Den här behållaren Windows PowerShell-providern implementerar inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="1d162-181">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="1d162-182">Följande kod är dock standardimplementering av den här metoden.</span><span class="sxs-lookup"><span data-stu-id="1d162-182">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters](Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters)]  -->

## <a name="retrieving-child-item-names"></a><span data-ttu-id="1d162-183">Hämtning av underordnade objektnamn</span><span class="sxs-lookup"><span data-stu-id="1d162-183">Retrieving Child Item Names</span></span>

<span data-ttu-id="1d162-184">Om du vill hämta namnen på underordnade objekt av Windows PowerShell-providern för behållaren måste åsidosätta de [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) metod för att stödja anrop från `Get-ChildItem`cmdlet när dess `Name` parameter har angetts.</span><span class="sxs-lookup"><span data-stu-id="1d162-184">To retrieve the names of child items, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method to support calls from the `Get-ChildItem` cmdlet when its `Name` parameter is specified.</span></span> <span data-ttu-id="1d162-185">Den här metoden hämtar namnen på de underordnade objekten för de angivna sökvägen eller underordnad objektnamn för alla behållare om den `returnAllContainers` parametern för cmdlet har angetts.</span><span class="sxs-lookup"><span data-stu-id="1d162-185">This method retrieves the names of the child items for the specified path or child item names for all containers if the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="1d162-186">Ett underordnade namn är den lägsta delen av en sökväg.</span><span class="sxs-lookup"><span data-stu-id="1d162-186">A child name is the leaf portion of a path.</span></span> <span data-ttu-id="1d162-187">Namnet på underordnade för sökvägen c:\windows\system32\abc.dll är till exempel ”abc.dll”.</span><span class="sxs-lookup"><span data-stu-id="1d162-187">For example, the child name for the path c:\windows\system32\abc.dll is "abc.dll".</span></span> <span data-ttu-id="1d162-188">Namnet på underordnade för directory c:\windows\system32 är ”system32”.</span><span class="sxs-lookup"><span data-stu-id="1d162-188">The child name for the directory c:\windows\system32 is "system32".</span></span>

<span data-ttu-id="1d162-189">Här är implementeringen av den [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) metod för den här providern.</span><span class="sxs-lookup"><span data-stu-id="1d162-189">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method for this provider.</span></span> <span data-ttu-id="1d162-190">Observera att metoden hämtar tabellnamn om den angivna sökvägen visar Access-databas (enhet) och radnummer om sökvägen visar en tabell.</span><span class="sxs-lookup"><span data-stu-id="1d162-190">Notice that the method retrieves table names if the specified path indicates the Access database (drive) and row numbers if the path indicates a table.</span></span>

```csharp
protected override void GetChildNames(string path,
                            ReturnContainers returnContainers)
{
    // If the path represented is a drive, then the child items are
    // tables. get the names of all the tables in the drive.
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table.Name, path, true);
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get type, table name and row number from path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Get all the rows in the table and then write out the
            // row numbers.
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row.RowNumber, path, false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);

            WriteItemObject(row.RowNumber, path, false);
        }
        else
        {
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildNames
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L369-L411 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchildnames"></a><span data-ttu-id="1d162-191">Kom ihåg följande om hur du implementerar GetChildNames</span><span class="sxs-lookup"><span data-stu-id="1d162-191">Things to Remember About Implementing GetChildNames</span></span>

<span data-ttu-id="1d162-192">Följande villkor kan tillkomma för din implementering av [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="1d162-192">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="1d162-193">När du definierar providerklassen, en Windows PowerShell-providern för behållare kan deklarera provider-funktionerna i ExpandWildcards, Filter, inkludera eller exkludera, från den [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) uppräkning.</span><span class="sxs-lookup"><span data-stu-id="1d162-193">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="1d162-194">I dessa fall är implementeringen av den [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metod måste se till att sökvägen skickas till metoden uppfyller kraven för den angivna funktioner.</span><span class="sxs-lookup"><span data-stu-id="1d162-194">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="1d162-195">Gör detta genom metoden ska komma åt egenskapen lämplig, till exempel, [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) och [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) egenskaper.</span><span class="sxs-lookup"><span data-stu-id="1d162-195">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

  > [!NOTE]
  > <span data-ttu-id="1d162-196">Ett undantag till den här regeln inträffar när den `returnAllContainers` parametern för cmdlet har angetts.</span><span class="sxs-lookup"><span data-stu-id="1d162-196">An exception to this rule occurs when the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="1d162-197">I det här fallet metoden bör hämta alla underordnade namn för en behållare, även om det inte matchar värdena för den [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), eller [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) egenskaper.</span><span class="sxs-lookup"><span data-stu-id="1d162-197">In this case, the method should retrieve any child name for a container, even if it does not match the values of the [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), or [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) properties.</span></span>

- <span data-ttu-id="1d162-198">Som standard åsidosättningar av den här metoden ska inte att hämta namnen på objekten som vanligtvis är dolda från användaren, såvida inte den [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) egenskapen har angetts.</span><span class="sxs-lookup"><span data-stu-id="1d162-198">By default, overrides of this method should not retrieve names of objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="1d162-199">Om den angivna sökvägen indikerar en behållare i [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) egenskapen är inte obligatoriskt.</span><span class="sxs-lookup"><span data-stu-id="1d162-199">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="1d162-200">Implementeringen av [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) ansvarar för att förhindra oändlig rekursion när Cirkulära länkar och liknande.</span><span class="sxs-lookup"><span data-stu-id="1d162-200">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="1d162-201">Ett lämpligt avslutande undantag måste undantagsfel för att återspegla dessa villkor.</span><span class="sxs-lookup"><span data-stu-id="1d162-201">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet-name"></a><span data-ttu-id="1d162-202">Bifoga dynamiska parametrar till cmdleten Get-ChildItem (namn)</span><span class="sxs-lookup"><span data-stu-id="1d162-202">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet (Name)</span></span>

<span data-ttu-id="1d162-203">Ibland den `Get-ChildItem` cmdlet (med den `Name` parametern) kräver ytterligare parametrar som anges dynamiskt vid körning.</span><span class="sxs-lookup"><span data-stu-id="1d162-203">Sometimes the `Get-ChildItem` cmdlet (with the `Name` parameter) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="1d162-204">För att ge dessa dynamiska parametrar, Windows PowerShell container-providern måste implementera de [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) metod.</span><span class="sxs-lookup"><span data-stu-id="1d162-204">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) method.</span></span> <span data-ttu-id="1d162-205">Den här metoden hämtar de dynamiska parametrarna för objektet på den angivna sökvägen och returnerar ett objekt med egenskaper och fält med parsning attribut som liknar en cmdlet-klass eller en [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objekt.</span><span class="sxs-lookup"><span data-stu-id="1d162-205">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="1d162-206">Windows PowerShell-runtime använder det returnerade objektet för att lägga till parametrar till den `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="1d162-206">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="1d162-207">Den här providern implementerar inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="1d162-207">This provider does not implement this method.</span></span> <span data-ttu-id="1d162-208">Följande kod är dock standardimplementering av den här metoden.</span><span class="sxs-lookup"><span data-stu-id="1d162-208">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters](Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters)]  -->

## <a name="renaming-items"></a><span data-ttu-id="1d162-209">Byta namn på objekt</span><span class="sxs-lookup"><span data-stu-id="1d162-209">Renaming Items</span></span>

<span data-ttu-id="1d162-210">Om du vill byta namn på ett objekt, en Windows PowerShell-providern för behållaren måste åsidosätta de [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) metod för att stödja anrop från den `Rename-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="1d162-210">To rename an item, a Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method to support calls from the `Rename-Item` cmdlet.</span></span> <span data-ttu-id="1d162-211">Den här metoden ändrar namnet på objektet på den angivna sökvägen till det nya namnet som angetts.</span><span class="sxs-lookup"><span data-stu-id="1d162-211">This method changes the name of the item at the specified path to the new name provided.</span></span> <span data-ttu-id="1d162-212">Det nya namnet måste alltid vara i förhållande till den överordnade artikeln (behållare).</span><span class="sxs-lookup"><span data-stu-id="1d162-212">The new name must always be relative to the parent item (container).</span></span>

<span data-ttu-id="1d162-213">Den här providern inte åsidosätter den [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) metod.</span><span class="sxs-lookup"><span data-stu-id="1d162-213">This provider does not override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method.</span></span> <span data-ttu-id="1d162-214">Följande är dock standardimplementering.</span><span class="sxs-lookup"><span data-stu-id="1d162-214">However, the following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitem](Msh_samplestestcmdlets#testproviderrenameitem)]  -->

#### <a name="things-to-remember-about-implementing-renameitem"></a><span data-ttu-id="1d162-215">Kom ihåg följande om hur du implementerar RenameItem</span><span class="sxs-lookup"><span data-stu-id="1d162-215">Things to Remember About Implementing RenameItem</span></span>

<span data-ttu-id="1d162-216">Följande villkor kan tillkomma för din implementering av [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span><span class="sxs-lookup"><span data-stu-id="1d162-216">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span></span>

- <span data-ttu-id="1d162-217">När du definierar providerklassen, en Windows PowerShell-providern för behållare kan deklarera provider-funktionerna i ExpandWildcards, Filter, inkludera eller exkludera, från den [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) uppräkning.</span><span class="sxs-lookup"><span data-stu-id="1d162-217">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="1d162-218">I dessa fall är implementeringen av den [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metod måste se till att sökvägen skickas till metoden uppfyller kraven för den angivna funktioner.</span><span class="sxs-lookup"><span data-stu-id="1d162-218">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="1d162-219">Gör detta genom metoden ska komma åt egenskapen lämplig, till exempel, [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) och [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) egenskaper.</span><span class="sxs-lookup"><span data-stu-id="1d162-219">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="1d162-220">Den [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) metoden är avsedd för ändring av namnet på ett objekt bara och inte för flyttåtgärder.</span><span class="sxs-lookup"><span data-stu-id="1d162-220">The [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method is intended for the modification of the name of an item only, and not for move operations.</span></span> <span data-ttu-id="1d162-221">Implementeringen av metoden ska skriva ett fel om de `newName` parametern innehåller avgränsarna eller på annat sätt kan orsaka objektet du vill ändra den överordnade platsen.</span><span class="sxs-lookup"><span data-stu-id="1d162-221">Your implementation of the method should write an error if the `newName` parameter contains path separators, or might otherwise cause the item to change its parent location.</span></span>

- <span data-ttu-id="1d162-222">Som standard åsidosättningar av den här metoden bör inte byta namn på objekt, såvida inte den [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) egenskapen har angetts.</span><span class="sxs-lookup"><span data-stu-id="1d162-222">By default, overrides of this method should not rename objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="1d162-223">Om den angivna sökvägen indikerar en behållare i [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) egenskapen är inte obligatoriskt.</span><span class="sxs-lookup"><span data-stu-id="1d162-223">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="1d162-224">Implementeringen av den [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) metoden ska anropa [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) och kontrollera dess returvärdet innan du gör några ändringar i datalagret.</span><span class="sxs-lookup"><span data-stu-id="1d162-224">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="1d162-225">Den här metoden används för att bekräfta körning av en åtgärd när en ändring görs i systemtillståndet, till exempel byta namn på filer.</span><span class="sxs-lookup"><span data-stu-id="1d162-225">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span> <span data-ttu-id="1d162-226">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) skickar namnet på resursen som ska ändras till användaren, med hänsyn till alla inställningar för kommandoraden eller variabler i Windows PowerShell-körningsmiljön bestämma vad som ska visas.</span><span class="sxs-lookup"><span data-stu-id="1d162-226">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="1d162-227">Efter anropet till [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returnerar `true`, [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) metoden ska anropa den [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) metod.</span><span class="sxs-lookup"><span data-stu-id="1d162-227">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="1d162-228">Den här metoden skickar ett meddelande ett bekräftelsemeddelande visas för användaren så att ytterligare feedback att säga om åtgärden bör behållas.</span><span class="sxs-lookup"><span data-stu-id="1d162-228">This method sends a message a confirmation message to the user to allow additional feedback to say if the operation should be continued.</span></span> <span data-ttu-id="1d162-229">En provider ska anropa [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) som ytterligare en kontroll efter ändringar av potentiellt skadliga system.</span><span class="sxs-lookup"><span data-stu-id="1d162-229">A provider should call [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-rename-item-cmdlet"></a><span data-ttu-id="1d162-230">Bifoga dynamiska parametrar till Cmdlet Rename-objekt</span><span class="sxs-lookup"><span data-stu-id="1d162-230">Attaching Dynamic Parameters to the Rename-Item Cmdlet</span></span>

<span data-ttu-id="1d162-231">Ibland den `Rename-Item` cmdlet kräver ytterligare parametrar som anges dynamiskt vid körning.</span><span class="sxs-lookup"><span data-stu-id="1d162-231">Sometimes the `Rename-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="1d162-232">För att ge dessa dynamiska parametrar, Windows PowerShell behållare leverantören måste implementera de [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) metod.</span><span class="sxs-lookup"><span data-stu-id="1d162-232">To provide these dynamic parameters, Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) method.</span></span> <span data-ttu-id="1d162-233">Den här metoden hämtar parametrarna för objektet på den angivna sökvägen och returnerar ett objekt med egenskaper och fält med parsning attribut som liknar en cmdlet-klass eller en [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objekt.</span><span class="sxs-lookup"><span data-stu-id="1d162-233">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="1d162-234">Windows PowerShell-runtime använder det returnerade objektet för att lägga till parametrar till den `Rename-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="1d162-234">The Windows PowerShell runtime uses the returned object to add the parameters to the `Rename-Item` cmdlet.</span></span>

<span data-ttu-id="1d162-235">Den här behållaren providern implementerar inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="1d162-235">This container provider does not implement this method.</span></span> <span data-ttu-id="1d162-236">Följande kod är dock standardimplementering av den här metoden.</span><span class="sxs-lookup"><span data-stu-id="1d162-236">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters](Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters)]  -->

## <a name="creating-new-items"></a><span data-ttu-id="1d162-237">Skapa nya objekt</span><span class="sxs-lookup"><span data-stu-id="1d162-237">Creating New Items</span></span>

<span data-ttu-id="1d162-238">Om du vill skapa nya objekt, en behållare leverantören måste implementera de [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metod för att stödja anrop från den `New-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="1d162-238">To create new items, a container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method to support calls from the `New-Item` cmdlet.</span></span> <span data-ttu-id="1d162-239">Den här metoden skapar ett dataobjekt som finns på den angivna sökvägen.</span><span class="sxs-lookup"><span data-stu-id="1d162-239">This method creates a data item located at the specified path.</span></span> <span data-ttu-id="1d162-240">Den `type` parametern för cmdlet: en innehåller typen provider-definierade för det nya objektet.</span><span class="sxs-lookup"><span data-stu-id="1d162-240">The `type` parameter of the cmdlet contains the provider-defined type for the new item.</span></span> <span data-ttu-id="1d162-241">Till exempel filsystem-providern använder en `type` parametern med värdet ”fil” eller ”directory”.</span><span class="sxs-lookup"><span data-stu-id="1d162-241">For example, the FileSystem provider uses a `type` parameter with a value of "file" or "directory".</span></span> <span data-ttu-id="1d162-242">Den `newItemValue` parametern för cmdlet: en anger ett värde för provider-specifik för det nya objektet.</span><span class="sxs-lookup"><span data-stu-id="1d162-242">The `newItemValue` parameter of the cmdlet specifies a provider-specific value for the new item.</span></span>

<span data-ttu-id="1d162-243">Här är implementeringen av den [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metod för den här providern.</span><span class="sxs-lookup"><span data-stu-id="1d162-243">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method for this provider.</span></span>

```csharp
protected override void NewItem( string path, string type,
                                 object newItemValue )
{
    // Create the new item here after
    // performing necessary validations
    //
    // WriteItemObject(newItemValue, path, false);

    // Example
    //
    // if (ShouldProcess(path, "new item"))
    // {
    //      // Create a new item and then call WriteObject
    //      WriteObject(newItemValue, path, false);
    // }

} // NewItem
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L939-L955 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-newitem"></a><span data-ttu-id="1d162-244">Kom ihåg följande om hur du implementerar NewItem</span><span class="sxs-lookup"><span data-stu-id="1d162-244">Things to Remember About Implementing NewItem</span></span>

<span data-ttu-id="1d162-245">Följande villkor kan tillkomma för din implementering av [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="1d162-245">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="1d162-246">Den [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metoden bör utföra en skiftlägeskänslig jämförelse av den sträng som har skickats i de `type` parametern.</span><span class="sxs-lookup"><span data-stu-id="1d162-246">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should perform a case-insensitive comparison of the string passed in the `type` parameter.</span></span> <span data-ttu-id="1d162-247">Det bör också tillåta för minst tvetydig matchningar.</span><span class="sxs-lookup"><span data-stu-id="1d162-247">It should also allow for least ambiguous matches.</span></span> <span data-ttu-id="1d162-248">För typer ”fil” och ”directory”, till exempel krävs bara den första bokstaven att undvika.</span><span class="sxs-lookup"><span data-stu-id="1d162-248">For example, for the types "file" and "directory", only the first letter is required to disambiguate.</span></span> <span data-ttu-id="1d162-249">Om den `type` parametern anger en typ som leverantören inte kan skapa den [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metoden ska skriva en ArgumentException med ett meddelande som anger vilka kan providern skapa.</span><span class="sxs-lookup"><span data-stu-id="1d162-249">If the `type` parameter indicates a type your provider cannot create, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should write an ArgumentException with a message indicating the types the provider can create.</span></span>

- <span data-ttu-id="1d162-250">För den `newItemValue` parametern, implementering av den [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metoden rekommenderas att acceptera strängar minst.</span><span class="sxs-lookup"><span data-stu-id="1d162-250">For the `newItemValue` parameter, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method is recommended to accept strings at a minimum.</span></span> <span data-ttu-id="1d162-251">Det bör också godkänna typ av objekt som hämtas av den [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) metod för samma sökväg.</span><span class="sxs-lookup"><span data-stu-id="1d162-251">It should also accept the type of object that is retrieved by the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the same path.</span></span> <span data-ttu-id="1d162-252">Den [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metod kan använda den [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) metod för att konvertera programdistributionstyperna som ska den önskade typen.</span><span class="sxs-lookup"><span data-stu-id="1d162-252">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method can use the [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) method to convert types to the desired type.</span></span>

- <span data-ttu-id="1d162-253">Implementeringen av den [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metoden ska anropa [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) och kontrollera dess returvärdet innan du gör några ändringar i datalagret.</span><span class="sxs-lookup"><span data-stu-id="1d162-253">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="1d162-254">Efter anropet till [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returnerar true, den [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) metoden ska anropa den [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) metod som ytterligare en kontroll efter ändringar av potentiellt skadliga system.</span><span class="sxs-lookup"><span data-stu-id="1d162-254">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-new-item-cmdlet"></a><span data-ttu-id="1d162-255">Koppla dynamiska parametrar till nytt objekt-Cmdlet</span><span class="sxs-lookup"><span data-stu-id="1d162-255">Attaching Dynamic Parameters to the New-Item Cmdlet</span></span>

<span data-ttu-id="1d162-256">Ibland den `New-Item` cmdlet kräver ytterligare parametrar som anges dynamiskt vid körning.</span><span class="sxs-lookup"><span data-stu-id="1d162-256">Sometimes the `New-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="1d162-257">För att ge dessa dynamiska parametrar, container-leverantören måste implementera de [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) metod.</span><span class="sxs-lookup"><span data-stu-id="1d162-257">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) method.</span></span> <span data-ttu-id="1d162-258">Den här metoden hämtar parametrarna för objektet på den angivna sökvägen och returnerar ett objekt med egenskaper och fält med parsning attribut som liknar en cmdlet-klass eller en [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objekt.</span><span class="sxs-lookup"><span data-stu-id="1d162-258">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="1d162-259">Windows PowerShell-runtime använder det returnerade objektet för att lägga till parametrar till den `New-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="1d162-259">The Windows PowerShell runtime uses the returned object to add the parameters to the `New-Item` cmdlet.</span></span>

<span data-ttu-id="1d162-260">Den här providern implementerar inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="1d162-260">This provider does not implement this method.</span></span> <span data-ttu-id="1d162-261">Följande kod är dock standardimplementering av den här metoden.</span><span class="sxs-lookup"><span data-stu-id="1d162-261">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernewitemdynamicparameters](Msh_samplestestcmdlets#testprovidernewitemdynamicparameters)]  -->

## <a name="removing-items"></a><span data-ttu-id="1d162-262">Tar bort objekt</span><span class="sxs-lookup"><span data-stu-id="1d162-262">Removing Items</span></span>

<span data-ttu-id="1d162-263">Om du vill ta bort objekt, Windows PowerShell-providern måste åsidosätta de [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) metod för att stödja anrop från den `Remove-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="1d162-263">To remove items, the Windows PowerShell provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method to support calls from the `Remove-Item` cmdlet.</span></span> <span data-ttu-id="1d162-264">Den här metoden tar bort ett objekt från datalagret i den angivna sökvägen.</span><span class="sxs-lookup"><span data-stu-id="1d162-264">This method deletes an item from the data store at the specified path.</span></span> <span data-ttu-id="1d162-265">Om den `recurse` -parametern för den `Remove-Item` cmdlet har angetts till `true`, metoden tar bort alla underordnade objekt oavsett.</span><span class="sxs-lookup"><span data-stu-id="1d162-265">If the `recurse` parameter of the `Remove-Item` cmdlet is set to `true`, the method removes all child items regardless of their level.</span></span> <span data-ttu-id="1d162-266">Om parametern är inställd `false`, metoden tar bort ett enskilt objekt i den angivna sökvägen.</span><span class="sxs-lookup"><span data-stu-id="1d162-266">If the parameter is set to `false`, the method removes only a single item at the specified path.</span></span>

<span data-ttu-id="1d162-267">Den här providern stöder inte objekt tas bort.</span><span class="sxs-lookup"><span data-stu-id="1d162-267">This provider does not support item removal.</span></span> <span data-ttu-id="1d162-268">Följande kod är dock standardimplementering av [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span><span class="sxs-lookup"><span data-stu-id="1d162-268">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitem](Msh_samplestestcmdlets#testproviderremoveitem)]  -->

#### <a name="things-to-remember-about-implementing-removeitem"></a><span data-ttu-id="1d162-269">Kom ihåg följande om hur du implementerar RemoveItem</span><span class="sxs-lookup"><span data-stu-id="1d162-269">Things to Remember About Implementing RemoveItem</span></span>

<span data-ttu-id="1d162-270">Följande villkor kan tillkomma för din implementering av [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="1d162-270">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="1d162-271">När du definierar providerklassen, en Windows PowerShell-providern för behållare kan deklarera provider-funktionerna i ExpandWildcards, Filter, inkludera eller exkludera, från den [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) uppräkning.</span><span class="sxs-lookup"><span data-stu-id="1d162-271">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="1d162-272">I dessa fall är implementeringen av den [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metod måste se till att sökvägen skickas till metoden uppfyller kraven för den angivna funktioner.</span><span class="sxs-lookup"><span data-stu-id="1d162-272">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="1d162-273">Gör detta genom metoden ska komma åt egenskapen lämplig, till exempel, [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) och [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) egenskaper.</span><span class="sxs-lookup"><span data-stu-id="1d162-273">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="1d162-274">Som standard åsidosättningar av den här metoden bör inte ta bort objekt om de [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) är inställd till true.</span><span class="sxs-lookup"><span data-stu-id="1d162-274">By default, overrides of this method should not remove objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to true.</span></span> <span data-ttu-id="1d162-275">Om den angivna sökvägen indikerar en behållare i [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) egenskapen är inte obligatoriskt.</span><span class="sxs-lookup"><span data-stu-id="1d162-275">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="1d162-276">Implementeringen av [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) ansvarar för att förhindra oändlig rekursion när Cirkulära länkar och liknande.</span><span class="sxs-lookup"><span data-stu-id="1d162-276">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="1d162-277">Ett lämpligt avslutande undantag måste undantagsfel för att återspegla dessa villkor.</span><span class="sxs-lookup"><span data-stu-id="1d162-277">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="1d162-278">Implementeringen av den [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) metoden ska anropa [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) och kontrollera dess returvärdet innan du gör några ändringar i datalagret.</span><span class="sxs-lookup"><span data-stu-id="1d162-278">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="1d162-279">Efter anropet till [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returnerar `true`, [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) metoden ska anropa den [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) metod som ytterligare en kontroll efter ändringar av potentiellt skadliga system.</span><span class="sxs-lookup"><span data-stu-id="1d162-279">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-remove-item-cmdlet"></a><span data-ttu-id="1d162-280">Bifoga dynamiska parametrar till cmdleten Remove-objekt</span><span class="sxs-lookup"><span data-stu-id="1d162-280">Attaching Dynamic Parameters to the Remove-Item Cmdlet</span></span>

<span data-ttu-id="1d162-281">Ibland den `Remove-Item` cmdlet kräver ytterligare parametrar som anges dynamiskt vid körning.</span><span class="sxs-lookup"><span data-stu-id="1d162-281">Sometimes the `Remove-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="1d162-282">För att ge dessa dynamiska parametrar, container-leverantören måste implementera de [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) metod för att hantera dessa parametrar.</span><span class="sxs-lookup"><span data-stu-id="1d162-282">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="1d162-283">Den här metoden hämtar de dynamiska parametrarna för objektet på den angivna sökvägen och returnerar ett objekt med egenskaper och fält med parsning attribut som liknar en cmdlet-klass eller en [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objekt.</span><span class="sxs-lookup"><span data-stu-id="1d162-283">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="1d162-284">Windows PowerShell-runtime använder det returnerade objektet för att lägga till parametrar till den `Remove-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="1d162-284">The Windows PowerShell runtime uses the returned object to add the parameters to the `Remove-Item` cmdlet.</span></span>

<span data-ttu-id="1d162-285">Den här behållaren providern implementerar inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="1d162-285">This container provider does not implement this method.</span></span> <span data-ttu-id="1d162-286">Följande kod är dock standardimplementering av [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="1d162-286">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters](Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters)]  -->

## <a name="querying-for-child-items"></a><span data-ttu-id="1d162-287">Fråga efter underordnade objekt</span><span class="sxs-lookup"><span data-stu-id="1d162-287">Querying for Child Items</span></span>

<span data-ttu-id="1d162-288">Om du vill kontrollera om du vill se om det finns underordnade objekt i den angivna sökvägen av Windows PowerShell-providern för behållaren måste åsidosätta de [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) metod.</span><span class="sxs-lookup"><span data-stu-id="1d162-288">To check to see if child items exist at the specified path, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="1d162-289">Den här metoden returnerar `true` om objektet har barn, och `false` annars.</span><span class="sxs-lookup"><span data-stu-id="1d162-289">This method returns `true` if the item has children, and `false` otherwise.</span></span> <span data-ttu-id="1d162-290">För en null eller tom sökväg, metoden tar hänsyn till alla objekt i datalager vara underordnade och returnerar `true`.</span><span class="sxs-lookup"><span data-stu-id="1d162-290">For a null or empty path, the method considers any items in the data store to be children and returns `true`.</span></span>

<span data-ttu-id="1d162-291">Här är åsidosättning för den [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) metod.</span><span class="sxs-lookup"><span data-stu-id="1d162-291">Here is the override for the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="1d162-292">Om det finns fler än två delar av filsökväg som skapats av hjälpmetoden ChunkPath, returnerar-metoden `false`, eftersom bara en databasbehållare och en tabellbehållare har definierats.</span><span class="sxs-lookup"><span data-stu-id="1d162-292">If there are more than two path parts created by the ChunkPath helper method, the method returns `false`, since only a database container and a table container are defined.</span></span> <span data-ttu-id="1d162-293">Mer information om den här helper-metoden finns i metoden ChunkPath beskrivs i [skapar en Windows PowerShell-providern för objektet](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="1d162-293">For more information about this helper method, see the ChunkPath method is discussed in [Creating a Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

```csharp
protected override bool HasChildItems( string path )
{
    return false;
} // HasChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L1094-L1097 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-haschilditems"></a><span data-ttu-id="1d162-294">Kom ihåg följande om hur du implementerar HasChildItems</span><span class="sxs-lookup"><span data-stu-id="1d162-294">Things to Remember About Implementing HasChildItems</span></span>

<span data-ttu-id="1d162-295">Följande villkor kan tillkomma för din implementering av [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span><span class="sxs-lookup"><span data-stu-id="1d162-295">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span></span>

- <span data-ttu-id="1d162-296">Om container providern Exponerar en rotcertifikatutfärdare som innehåller intressanta monteringspunkter, implementering av den [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) ska metoden returnera `true`när ett null-värde eller en tom sträng skickas för sökvägen.</span><span class="sxs-lookup"><span data-stu-id="1d162-296">If the container provider exposes a root that contains interesting mount points, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method should return `true` when a null or an empty string is passed in for the path.</span></span>

## <a name="copying-items"></a><span data-ttu-id="1d162-297">Kopiera objekt</span><span class="sxs-lookup"><span data-stu-id="1d162-297">Copying Items</span></span>

<span data-ttu-id="1d162-298">Om du vill kopiera objekt container-leverantören måste implementera de [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) metod för att stödja anrop från den `Copy-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="1d162-298">To copy items, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method to support calls from the `Copy-Item` cmdlet.</span></span> <span data-ttu-id="1d162-299">Den här metoden kopierar ett dataobjekt från den plats som anges av den `path` parametern för cmdlet: en till den plats som anges av den `copyPath` parametern.</span><span class="sxs-lookup"><span data-stu-id="1d162-299">This method copies a data item from the location indicated by the `path` parameter of the cmdlet to the location indicated by the `copyPath` parameter.</span></span> <span data-ttu-id="1d162-300">Om den `recurse` parameter har angetts, metoden kopierar alla underordnade behållare.</span><span class="sxs-lookup"><span data-stu-id="1d162-300">If the `recurse` parameter is specified, the method copies all sub-containers.</span></span> <span data-ttu-id="1d162-301">Om parametern inte anges, kopierar metoden endast en enda nivå av objekt.</span><span class="sxs-lookup"><span data-stu-id="1d162-301">If the parameter is not specified, the method copies only a single level of items.</span></span>

<span data-ttu-id="1d162-302">Den här providern implementerar inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="1d162-302">This provider does not implement this method.</span></span> <span data-ttu-id="1d162-303">Följande kod är dock standardimplementering av [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span><span class="sxs-lookup"><span data-stu-id="1d162-303">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitem](Msh_samplestestcmdlets#testprovidercopyitem)]  -->

#### <a name="things-to-remember-about-implementing-copyitem"></a><span data-ttu-id="1d162-304">Kom ihåg följande om hur du implementerar CopyItem</span><span class="sxs-lookup"><span data-stu-id="1d162-304">Things to Remember About Implementing CopyItem</span></span>

<span data-ttu-id="1d162-305">Följande villkor kan tillkomma för din implementering av [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span><span class="sxs-lookup"><span data-stu-id="1d162-305">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span></span>

- <span data-ttu-id="1d162-306">När du definierar providerklassen, en Windows PowerShell-providern för behållare kan deklarera provider-funktionerna i ExpandWildcards, Filter, inkludera eller exkludera, från den [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) uppräkning.</span><span class="sxs-lookup"><span data-stu-id="1d162-306">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="1d162-307">I dessa fall är implementeringen av den [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) metod måste se till att sökvägen skickas till metoden uppfyller kraven för den angivna funktioner.</span><span class="sxs-lookup"><span data-stu-id="1d162-307">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="1d162-308">Gör detta genom metoden ska komma åt egenskapen lämplig, till exempel, [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) och [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) egenskaper.</span><span class="sxs-lookup"><span data-stu-id="1d162-308">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="1d162-309">Som standard åsidosättningar av den här metoden bör inte kopiera objekt över befintliga objekt, såvida inte den [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) är inställd på `true`.</span><span class="sxs-lookup"><span data-stu-id="1d162-309">By default, overrides of this method should not copy objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="1d162-310">Till exempel filsystem providern kopierar inte c:\temp\abc.txt över en befintlig c:\abc.txt-fil, såvida inte den [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) är inställd på `true`.</span><span class="sxs-lookup"><span data-stu-id="1d162-310">For example, the FileSystem provider will not copy c:\temp\abc.txt over an existing c:\abc.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="1d162-311">Om sökvägen som angetts i den `copyPath` parametern finns och anger en behållare i [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) egenskapen är inte obligatoriskt.</span><span class="sxs-lookup"><span data-stu-id="1d162-311">If the path specified in the `copyPath` parameter exists and indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="1d162-312">I det här fallet [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) bör kopiera objektet som anges av den `path` parametern till behållaren som anges av den `copyPath` parametern som en underordnad.</span><span class="sxs-lookup"><span data-stu-id="1d162-312">In this case, [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) should copy the item indicated by the `path` parameter to the container indicated by the `copyPath` parameter as a child.</span></span>

- <span data-ttu-id="1d162-313">Implementeringen av [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) ansvarar för att förhindra oändlig rekursion när Cirkulära länkar och liknande.</span><span class="sxs-lookup"><span data-stu-id="1d162-313">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="1d162-314">Ett lämpligt avslutande undantag måste undantagsfel för att återspegla dessa villkor.</span><span class="sxs-lookup"><span data-stu-id="1d162-314">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="1d162-315">Implementeringen av den [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) metoden ska anropa [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) och kontrollera dess returvärdet innan du gör några ändringar i datalagret.</span><span class="sxs-lookup"><span data-stu-id="1d162-315">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="1d162-316">Efter anropet till [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returnerar true, den [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) metoden ska anropa den [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) metod som ytterligare en kontroll efter ändringar av potentiellt skadliga system.</span><span class="sxs-lookup"><span data-stu-id="1d162-316">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span> <span data-ttu-id="1d162-317">Läs mer om att anropa metoderna [Byt namn på objekt](#Renaming-Items).</span><span class="sxs-lookup"><span data-stu-id="1d162-317">For more information about calling these methods, see [Rename Items](#Renaming-Items).</span></span>

## <a name="attaching-dynamic-parameters-to-the-copy-item-cmdlet"></a><span data-ttu-id="1d162-318">Bifoga dynamiska parametrar till Cmdlet Copy-Item</span><span class="sxs-lookup"><span data-stu-id="1d162-318">Attaching Dynamic Parameters to the Copy-Item Cmdlet</span></span>

<span data-ttu-id="1d162-319">Ibland den `Copy-Item` cmdlet kräver ytterligare parametrar som anges dynamiskt vid körning.</span><span class="sxs-lookup"><span data-stu-id="1d162-319">Sometimes the `Copy-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="1d162-320">För att ge dessa dynamiska parametrar, Windows PowerShell container-providern måste implementera de [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) metod för att hantera dessa parametrar.</span><span class="sxs-lookup"><span data-stu-id="1d162-320">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="1d162-321">Den här metoden hämtar parametrarna för objektet på den angivna sökvägen och returnerar ett objekt med egenskaper och fält med parsning attribut som liknar en cmdlet-klass eller en [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objekt.</span><span class="sxs-lookup"><span data-stu-id="1d162-321">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="1d162-322">Windows PowerShell-runtime använder det returnerade objektet för att lägga till parametrar till den `Copy-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="1d162-322">The Windows PowerShell runtime uses the returned object to add the parameters to the `Copy-Item` cmdlet.</span></span>

<span data-ttu-id="1d162-323">Den här providern implementerar inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="1d162-323">This provider does not implement this method.</span></span> <span data-ttu-id="1d162-324">Följande kod är dock standardimplementering av [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="1d162-324">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters](Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters)]  -->

## <a name="code-sample"></a><span data-ttu-id="1d162-325">Kodexempel</span><span class="sxs-lookup"><span data-stu-id="1d162-325">Code Sample</span></span>

<span data-ttu-id="1d162-326">Komplett exempel finns i [AccessDbProviderSample04 kodexempel](./accessdbprovidersample04-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="1d162-326">For complete sample code, see [AccessDbProviderSample04 Code Sample](./accessdbprovidersample04-code-sample.md).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="1d162-327">Att skapa Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="1d162-327">Building the Windows PowerShell Provider</span></span>

<span data-ttu-id="1d162-328">Se [hur du registrerar Cmdlets, Providers och vara värd för program](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="1d162-328">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>
<span data-ttu-id="1d162-329">Se [hur du registrerar Cmdlets, Providers och vara värd för program](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="1d162-329">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="1d162-330">Testa Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="1d162-330">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="1d162-331">När din Windows PowerShell-provider har registrerats med Windows PowerShell kan testa du den genom att köra cmdletarna stöds på kommandoraden.</span><span class="sxs-lookup"><span data-stu-id="1d162-331">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="1d162-332">Tänk på att följande Exempelutdata använder en fiktiva Access-databas.</span><span class="sxs-lookup"><span data-stu-id="1d162-332">Be aware that the following example output uses a fictitious Access database.</span></span>

1. <span data-ttu-id="1d162-333">Kör den `Get-ChildItem` cmdlet för att hämta listan över underordnade objekt från en kundtabell i Access-databasen.</span><span class="sxs-lookup"><span data-stu-id="1d162-333">Run the `Get-ChildItem` cmdlet to retrieve the list of child items from a Customers table in the Access database.</span></span>

   ```powershell
   Get-ChildItem mydb:customers
   ```

   <span data-ttu-id="1d162-334">Följande utdata visas.</span><span class="sxs-lookup"><span data-stu-id="1d162-334">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : True
   Data          : System.Data.DataRow
   Name          : Customers
   RowCount      : 91
   Columns       :
   ```

2. <span data-ttu-id="1d162-335">Kör den `Get-ChildItem` cmdleten igen för att hämta data i en tabell.</span><span class="sxs-lookup"><span data-stu-id="1d162-335">Run the `Get-ChildItem` cmdlet again to retrieve the data of a table.</span></span>

   ```powershell
   (Get-ChildItem mydb:customers).data
   ```

   <span data-ttu-id="1d162-336">Följande utdata visas.</span><span class="sxs-lookup"><span data-stu-id="1d162-336">The following output appears.</span></span>

   ```output
   TABLE_CAT   : c:\PS\northwind
   TABLE_SCHEM :
   TABLE_NAME  : Customers
   TABLE_TYPE  : TABLE
   REMARKS     :
   ```

3. <span data-ttu-id="1d162-337">Nu använda den `Get-Item` cmdlet för att hämta elementen på rad 0 i tabellen.</span><span class="sxs-lookup"><span data-stu-id="1d162-337">Now use the `Get-Item` cmdlet to retrieve the items at row 0 in the data table.</span></span>

   ```powershell
   Get-Item mydb:\customers\0
   ```

   <span data-ttu-id="1d162-338">Följande utdata visas.</span><span class="sxs-lookup"><span data-stu-id="1d162-338">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers\0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data          : System.Data.DataRow
   RowNumber     : 0
   ```

4. <span data-ttu-id="1d162-339">Återanvända `Get-Item` att hämta data för objekten i rad 0.</span><span class="sxs-lookup"><span data-stu-id="1d162-339">Reuse `Get-Item` to retrieve the data for the items in row 0.</span></span>

   ```powershell
   (Get-Item mydb:\customers\0).data
   ```

   <span data-ttu-id="1d162-340">Följande utdata visas.</span><span class="sxs-lookup"><span data-stu-id="1d162-340">The following output appears.</span></span>

   ```output
   CustomerID   : 1234
   CompanyName  : Fabrikam
   ContactName  : Eric Gruber
   ContactTitle : President
   Address      : 4567 Main Street
   City         : Buffalo
   Region       : NY
   PostalCode   : 98052
   Country      : USA
   Phone        : (425) 555-0100
   Fax          : (425) 555-0101
   ```

5. <span data-ttu-id="1d162-341">Nu använda den `New-Item` cmdlet för att lägga till en rad i en befintlig tabell.</span><span class="sxs-lookup"><span data-stu-id="1d162-341">Now use the `New-Item` cmdlet to add a row to an existing table.</span></span> <span data-ttu-id="1d162-342">Den `Path` parametern anger den fullständiga sökvägen till raden och måste ange ett radnummer som är större än det befintliga antalet rader i tabellen.</span><span class="sxs-lookup"><span data-stu-id="1d162-342">The `Path` parameter specifies the full path to the row, and must indicate a row number that is greater than the existing number of rows in the table.</span></span> <span data-ttu-id="1d162-343">Den `Type` parametern anger ”rad” för att ange den typ av objekt som ska läggas.</span><span class="sxs-lookup"><span data-stu-id="1d162-343">The `Type` parameter indicates "row" to specify that type of item to add.</span></span> <span data-ttu-id="1d162-344">Slutligen den `Value` parametern anger en kommaavgränsad lista med kolumnvärdena för raden.</span><span class="sxs-lookup"><span data-stu-id="1d162-344">Finally, the `Value` parameter specifies a comma-delimited list of column values for the row.</span></span>

   ```powershell
   New-Item -Path mydb:\Customers\3 -ItemType "row" -Value "3,CustomerFirstName,CustomerLastName,CustomerEmailAdress,CustomerTitle,CustomerCompany,CustomerPhone, CustomerAddress,CustomerCity,CustomerState,CustomerZip,CustomerCountry"
   ```

6. <span data-ttu-id="1d162-345">Kontrollera för nya objekt igen på följande sätt.</span><span class="sxs-lookup"><span data-stu-id="1d162-345">Verify the correctness of the new item operation as follows.</span></span>

   ```none
   PS mydb:\> cd Customers
   PS mydb:\Customers> (Get-Item 3).data
   ```

   <span data-ttu-id="1d162-346">Följande utdata visas.</span><span class="sxs-lookup"><span data-stu-id="1d162-346">The following output appears.</span></span>

   ```output
   ID        : 3
   FirstName : Eric
   LastName  : Gruber
   Email     : ericgruber@fabrikam.com
   Title     : President
   Company   : Fabrikam
   WorkPhone : (425) 555-0100
   Address   : 4567 Main Street
   City      : Buffalo
   State     : NY
   Zip       : 98052
   Country   : USA
   ```

## <a name="see-also"></a><span data-ttu-id="1d162-347">Se även</span><span class="sxs-lookup"><span data-stu-id="1d162-347">See Also</span></span>

[<span data-ttu-id="1d162-348">Skapa Windows PowerShell-Providers</span><span class="sxs-lookup"><span data-stu-id="1d162-348">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="1d162-349">Designa din Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="1d162-349">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="1d162-350">Implementera en objekt Windows PowerShell-Provider</span><span class="sxs-lookup"><span data-stu-id="1d162-350">Implementing an Item Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-item-provider.md)

[<span data-ttu-id="1d162-351">Implementera en navigering Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="1d162-351">Implementing a Navigation Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-navigation-provider.md)

[<span data-ttu-id="1d162-352">Hur du registrerar Cmdlets, Providers och vara värd för program</span><span class="sxs-lookup"><span data-stu-id="1d162-352">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="1d162-353">Hur du registrerar Cmdlets, Providers och vara värd för program</span><span class="sxs-lookup"><span data-stu-id="1d162-353">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="1d162-354">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="1d162-354">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="1d162-355">Programmeringsguide för Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="1d162-355">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)
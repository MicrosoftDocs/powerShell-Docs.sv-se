---
title: Skapa en grundläggande Windows PowerShell-Provider | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- base provider [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], base provider
ms.assetid: 11eeea41-15c8-47ad-9016-0f4b72573305
caps.latest.revision: 7
ms.openlocfilehash: 5ebc22067b20f0e1d35d31d5f33e599f50cb7564
ms.sourcegitcommit: 01b81317029b28dd9b61d167045fd31f1ec7bc06
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 05/17/2019
ms.locfileid: "65855069"
---
# <a name="creating-a-basic-windows-powershell-provider"></a><span data-ttu-id="2fbc1-102">Skapa en grundläggande Windows PowerShell-provider</span><span class="sxs-lookup"><span data-stu-id="2fbc1-102">Creating a Basic Windows PowerShell Provider</span></span>

<span data-ttu-id="2fbc1-103">Det här avsnittet är startpunkten för att lära dig hur du skapar en Windows PowerShell-providern.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-103">This topic is the starting point for learning how to create a Windows PowerShell provider.</span></span> <span data-ttu-id="2fbc1-104">Grundläggande providern som beskrivs här ger metoder för att starta och stoppa providern, och även om den här leverantören inte ger ett sätt att få åtkomst till ett datalager eller för att hämta eller ange data i datalagret kan det tillhandahåller grundläggande funktioner som krävs av alla leverantörer.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-104">The basic provider described here provides methods for starting and stopping the provider, and although this provider does not provide a means to access a data store or to get or set the data in the data store, it does provide the basic functionality that is required by all providers.</span></span>

<span data-ttu-id="2fbc1-105">Som nämnts tidigare grundläggande providern som beskrivs här implementerar metoderna för att starta och stoppa providern.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-105">As mentioned previously, the basic provider described here implements methods for starting and stopping the provider.</span></span> <span data-ttu-id="2fbc1-106">Windows PowerShell-runtime anropar dessa metoder för att initiera och uninitialize providern.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-106">The Windows PowerShell runtime calls these methods to initialize and uninitialize the provider.</span></span>

> [!NOTE]
> <span data-ttu-id="2fbc1-107">Du hittar ett exempel på den här providern i filen AccessDBSampleProvider01.cs som tillhandahålls av Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-107">You can find a sample of this provider in the AccessDBSampleProvider01.cs file provided by Windows PowerShell.</span></span>

## <a name="defining-the-windows-powershell-provider-class"></a><span data-ttu-id="2fbc1-108">Definiera klassen Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="2fbc1-108">Defining the Windows PowerShell Provider Class</span></span>

<span data-ttu-id="2fbc1-109">Det första steget i att skapa en Windows PowerShell-providern är att definiera dess .NET-klass.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-109">The first step in creating a Windows PowerShell provider is to define its .NET class.</span></span> <span data-ttu-id="2fbc1-110">Den här grundläggande providern definierar en klass med namnet `AccessDBProvider` som härleds från den [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) basklassen.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-110">This basic provider defines a class called `AccessDBProvider` that derives from the [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class.</span></span>

<span data-ttu-id="2fbc1-111">Vi rekommenderar att du placerar dina providerklasser i en `Providers` namnområdet för ditt API-namnområde, till exempel xxx. PowerShell.Providers.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-111">It is recommended that you place your provider classes in a `Providers` namespace of your API namespace, for example, xxx.PowerShell.Providers.</span></span> <span data-ttu-id="2fbc1-112">Den här providern använder det `Microsoft.Samples.PowerShell.Provider` namnområdet, där alla exempel i Windows PowerShell-providern körs.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-112">This provider uses the `Microsoft.Samples.PowerShell.Provider` namespace, in which all Windows PowerShell provider samples run.</span></span>

> [!NOTE]
> <span data-ttu-id="2fbc1-113">Klass för en Windows PowerShell-providern måste uttryckligen markeras som offentliga.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-113">The class for a Windows PowerShell provider must be explicitly marked as public.</span></span> <span data-ttu-id="2fbc1-114">Klasser som inte har markerats som offentliga som standard till interna och kommer inte att hitta av Windows PowerShell-körningen.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-114">Classes not marked as public will default to internal and will not be found by the Windows PowerShell runtime.</span></span>

<span data-ttu-id="2fbc1-115">Här är klassdefinitionen för den här grundläggande providern:</span><span class="sxs-lookup"><span data-stu-id="2fbc1-115">Here is the class definition for this basic provider:</span></span>

[!code-csharp[AccessDBProviderSample01.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample01/AccessDBProviderSample01.cs#L23-L24 "AccessDBProviderSample01.cs")]

<span data-ttu-id="2fbc1-116">Precis före klassdefinitionen, måste du deklarera den [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attributet med syntaxen [CmdletProvider()].</span><span class="sxs-lookup"><span data-stu-id="2fbc1-116">Right before the class definition, you must declare the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute, with the syntax [CmdletProvider()].</span></span>

<span data-ttu-id="2fbc1-117">Du kan ange attributet nyckelord för ytterligare deklarera klassen om det behövs.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-117">You can set attribute keywords to further declare the class if necessary.</span></span> <span data-ttu-id="2fbc1-118">Observera att den [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribut som deklarerats här innehåller två parametrar.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-118">Notice that the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute declared here includes two parameters.</span></span> <span data-ttu-id="2fbc1-119">Den första parametern för attributet anger standard-eget namn för providern som användaren kan ändra senare.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-119">The first attribute parameter specifies the default-friendly name for the provider, which the user can modify later.</span></span> <span data-ttu-id="2fbc1-120">Den andra parametern anger de Windows PowerShell-definierade funktioner som providern visar Windows PowerShell-runtime under bearbetning av kommandot.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-120">The second parameter specifies the Windows PowerShell-defined capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="2fbc1-121">De möjliga värdena för funktioner för providern definieras av den [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) uppräkning.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-121">The possible values for the provider capabilities are defined by the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="2fbc1-122">Eftersom det här är en bas-provider stöder inga funktioner.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-122">Because this is a base provider, it supports no capabilities.</span></span>

> [!NOTE]
> <span data-ttu-id="2fbc1-123">Det fullständigt kvalificerade namnet på Windows PowerShell-providern innehåller sammansättningsnamnet och andra attribut som bestäms av Windows PowerShell vid registreringen av providern.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-123">The fully qualified name of the Windows PowerShell provider includes the assembly name and other attributes determined by Windows PowerShell upon registration of the provider.</span></span>

## <a name="defining-provider-specific-state-information"></a><span data-ttu-id="2fbc1-124">Definiera Provider-specifik statusinformation</span><span class="sxs-lookup"><span data-stu-id="2fbc1-124">Defining Provider-Specific State Information</span></span>

<span data-ttu-id="2fbc1-125">Den [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) basklass och alla härledda klasser anses tillståndslösa eftersom Windows PowerShell-runtime skapar instanser av providern vid behov.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-125">The [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class and all derived classes are considered stateless because the Windows PowerShell runtime creates provider instances only as required.</span></span> <span data-ttu-id="2fbc1-126">Därför, om din leverantör kräver full kontroll och underhåll av tillstånd för provider-specifik data, den måste härleda en klass från den [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) klass.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-126">Therefore, if your provider requires full control and state maintenance for provider-specific data, it must derive a class from the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) class.</span></span> <span data-ttu-id="2fbc1-127">Den härledda klassen bör definiera medlemmarna som behövs för att upprätthålla tillståndet så att data provider-specifik kan användas när Windows PowerShell-runtime anropar den [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) metod för att initiera providern.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-127">Your derived class should define the members necessary to maintain the state so that the provider-specific data can be accessed when the Windows PowerShell runtime calls the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method to initialize the provider.</span></span>

<span data-ttu-id="2fbc1-128">En Windows PowerShell-providern kan också upprätthålla anslutningsbaserade tillstånd.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-128">A Windows PowerShell provider can also maintain connection-based state.</span></span> <span data-ttu-id="2fbc1-129">Läs mer om hur du underhåller anslutningsläge [skapar PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="2fbc1-129">For more information about maintaining connection state, see [Creating a PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

## <a name="initializing-the-provider"></a><span data-ttu-id="2fbc1-130">Initiering av providern</span><span class="sxs-lookup"><span data-stu-id="2fbc1-130">Initializing the Provider</span></span>

<span data-ttu-id="2fbc1-131">Att initiera providern, Windows PowerShell runtime-anrop i [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) metod när Windows PowerShell startas.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-131">To initialize the provider, the Windows PowerShell runtime calls the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method when Windows PowerShell is started.</span></span> <span data-ttu-id="2fbc1-132">För det mesta din provider kan använda standardimplementering av den här metoden returnerar bara den [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) objekt som beskriver din provider.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-132">For the most part, your provider can use the default implementation of this method, which simply returns the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that describes your provider.</span></span> <span data-ttu-id="2fbc1-133">Men i fall där du vill lägga till ytterligare initieringsinformation bör du implementera egna [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) metod som returnerar en modifierad version av [ System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) objekt som skickas till din provider.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-133">However, in the case where you want to add additional initialization information, you should implement your own [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method that returns a modified version of the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that is passed to your provider.</span></span> <span data-ttu-id="2fbc1-134">I allmänhet den här metoden ska returnera de angivna [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) objekt skickades till den eller en ändrad [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) objekt som innehåller initieringsinformation om andra.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-134">In general, this method should return the provided [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object passed to it or a modified [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that contains other initialization information.</span></span>

<span data-ttu-id="2fbc1-135">Den här grundläggande providern åsidosätts inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-135">This basic provider does not override this method.</span></span> <span data-ttu-id="2fbc1-136">Följande kod visar dock standardimplementering av den här metoden:</span><span class="sxs-lookup"><span data-stu-id="2fbc1-136">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderStart](Msh_samplesaccessdbprov01#accessdbprov01ProviderStart)]  -->

<span data-ttu-id="2fbc1-137">Providern kan upprätthålla tillståndet för provider-specifik information som beskrivs i [definiera Provider-specifik Data tillstånd](#defining-provider-specific-state-information).</span><span class="sxs-lookup"><span data-stu-id="2fbc1-137">The provider can maintain the state of provider-specific information as described in [Defining Provider-specific Data State](#defining-provider-specific-state-information).</span></span> <span data-ttu-id="2fbc1-138">I det här fallet din implementering måste åsidosätta de [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) metod för att returnera en instans av den härledda klassen.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-138">In this case, your implementation must override the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method to return an instance of the derived class.</span></span>

## <a name="start-dynamic-parameters"></a><span data-ttu-id="2fbc1-139">Starta dynamiska parametrar</span><span class="sxs-lookup"><span data-stu-id="2fbc1-139">Start Dynamic Parameters</span></span>

<span data-ttu-id="2fbc1-140">Din provider-implementering av den [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) metoden kan kräva ytterligare parametrar.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-140">Your provider implementation of the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method might require additional parameters.</span></span> <span data-ttu-id="2fbc1-141">I det här fallet providern ska åsidosätta den [System.Management.Automation.Provider.Cmdletprovider.Startdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.StartDynamicParameters) metoden och returnera ett objekt med egenskaper och fält med parsning attribut liknar en cmdlet: en klass eller en [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objekt.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-141">In this case, the provider should override the [System.Management.Automation.Provider.Cmdletprovider.Startdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.StartDynamicParameters) method and return an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span>

<span data-ttu-id="2fbc1-142">Den här grundläggande providern åsidosätts inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-142">This basic provider does not override this method.</span></span> <span data-ttu-id="2fbc1-143">Följande kod visar dock standardimplementering av den här metoden:</span><span class="sxs-lookup"><span data-stu-id="2fbc1-143">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderDynamicParameters](Msh_samplesaccessdbprov01#accessdbprov01ProviderDynamicParameters)]  -->

## <a name="uninitializing-the-provider"></a><span data-ttu-id="2fbc1-144">Avinitierar providern</span><span class="sxs-lookup"><span data-stu-id="2fbc1-144">Uninitializing the Provider</span></span>

<span data-ttu-id="2fbc1-145">Du kan frigöra resurser som använder Windows PowerShell-providern genom din leverantör bör implementera en egen [System.Management.Automation.Provider.Cmdletprovider.Stop\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Stop) metod.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-145">To free resources that the Windows PowerShell provider uses, your provider should implement its own [System.Management.Automation.Provider.Cmdletprovider.Stop\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Stop) method.</span></span> <span data-ttu-id="2fbc1-146">Den här metoden anropas av Windows PowerShell-körning för att uninitialize providern i avslutar en session.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-146">This method is called by the Windows PowerShell runtime to uninitialize the provider at the close of a session.</span></span>

<span data-ttu-id="2fbc1-147">Den här grundläggande providern åsidosätts inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-147">This basic provider does not override this method.</span></span> <span data-ttu-id="2fbc1-148">Följande kod visar dock standardimplementering av den här metoden:</span><span class="sxs-lookup"><span data-stu-id="2fbc1-148">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderStop](Msh_samplesaccessdbprov01#accessdbprov01ProviderStop)]  -->

## <a name="code-sample"></a><span data-ttu-id="2fbc1-149">Kodexempel</span><span class="sxs-lookup"><span data-stu-id="2fbc1-149">Code Sample</span></span>

<span data-ttu-id="2fbc1-150">Komplett exempel finns i [AccessDbProviderSample01 kodexempel](./accessdbprovidersample01-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="2fbc1-150">For complete sample code, see [AccessDbProviderSample01 Code Sample](./accessdbprovidersample01-code-sample.md).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="2fbc1-151">Testa Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="2fbc1-151">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="2fbc1-152">När din Windows PowerShell-provider har registrerats med Windows PowerShell kan testa du den genom att köra cmdletarna stöds på kommandoraden.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-152">Once your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="2fbc1-153">Kör det nya gränssnittet för den här grundläggande providern och använder den `Get-PSProvider` cmdlet för att hämta listan med providers och kontrollera att providern AccessDb finns.</span><span class="sxs-lookup"><span data-stu-id="2fbc1-153">For this basic provider, run the new shell and use the `Get-PSProvider` cmdlet to retrieve the list of providers and ensure that the AccessDb provider is present.</span></span>

```powershell
Get-PSProvider
```

<span data-ttu-id="2fbc1-154">Följande utdata visas:</span><span class="sxs-lookup"><span data-stu-id="2fbc1-154">The following output appears:</span></span>

```output
Name                 Capabilities                  Drives
----                 ------------                  ------
AccessDb             None                          {}
Alias                ShouldProcess                 {Alias}
Environment          ShouldProcess                 {Env}
FileSystem           Filter, ShouldProcess         {C, Z}
Function             ShouldProcess                 {function}
Registry             ShouldProcess                 {HKLM, HKCU}
```

## <a name="see-also"></a><span data-ttu-id="2fbc1-155">Se även</span><span class="sxs-lookup"><span data-stu-id="2fbc1-155">See Also</span></span>

[<span data-ttu-id="2fbc1-156">Skapa Windows PowerShell-Providers</span><span class="sxs-lookup"><span data-stu-id="2fbc1-156">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="2fbc1-157">Designa din Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="2fbc1-157">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)
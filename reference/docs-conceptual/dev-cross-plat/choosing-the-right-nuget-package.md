---
title: Välja rätt PowerShell NuGet-paket för ditt .NET-projekt
description: Tillsammans med de körbara paket som publiceras med varje PowerShell-utgåva, innehåller PowerShell-teamet också flera paket som är tillgängliga på NuGet. Med dessa paket kan du använda PowerShell som en API-plattform i .NET.
ms.date: 06/25/2020
ms.custom: rjmholt
ms.openlocfilehash: 39369ed872faa76ad2c41d813da5e0a98cf1c078
ms.sourcegitcommit: d0461273abb6db099c5e784ef00f57fd551be4a6
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 07/01/2020
ms.locfileid: "85795452"
---
# <a name="choosing-the-right-powershell-nuget-package-for-your-net-project"></a><span data-ttu-id="24d0d-104">Välja rätt PowerShell NuGet-paket för ditt .NET-projekt</span><span class="sxs-lookup"><span data-stu-id="24d0d-104">Choosing the right PowerShell NuGet package for your .NET project</span></span>

<span data-ttu-id="24d0d-105">Tillsammans `pwsh` med de körbara paket som publiceras med varje PowerShell-utgåva, innehåller PowerShell-teamet också flera paket som är tillgängliga på [NuGet][].</span><span class="sxs-lookup"><span data-stu-id="24d0d-105">Alongside the `pwsh` executable packages published with each PowerShell release, the PowerShell team also maintains several packages available on [NuGet][].</span></span> <span data-ttu-id="24d0d-106">Med dessa paket kan du använda PowerShell som en API-plattform i .NET.</span><span class="sxs-lookup"><span data-stu-id="24d0d-106">These packages allow targeting PowerShell as an API platform in .NET.</span></span>

<span data-ttu-id="24d0d-107">Som ett .NET-program som innehåller API: er och väntar på att läsa in .NET-bibliotek som implementerar egna (binära moduler) är det viktigt att PowerShell är tillgängligt i form av ett NuGet-paket.</span><span class="sxs-lookup"><span data-stu-id="24d0d-107">As a .NET application that provides APIs and expects to load .NET libraries implementing its own (binary modules), it's essential that PowerShell be available in the form of a NuGet package.</span></span>

<span data-ttu-id="24d0d-108">För närvarande finns det flera NuGet-paket som ger en del åter givning av området för PowerShell API-ytan.</span><span class="sxs-lookup"><span data-stu-id="24d0d-108">Currently there are several NuGet packages that provide some representation of the PowerShell API surface area.</span></span> <span data-ttu-id="24d0d-109">Vilket paket som ska användas med ett visst projekt har inte alltid gjorts klart.</span><span class="sxs-lookup"><span data-stu-id="24d0d-109">Which package to use with a particular project hasn't always been made clear.</span></span> <span data-ttu-id="24d0d-110">Den här artikeln tar en del av några vanliga scenarier för PowerShell-riktade .NET-projekt och hur du väljer rätt NuGet-paket som mål för ditt PowerShell-orienterade .NET-projekt.</span><span class="sxs-lookup"><span data-stu-id="24d0d-110">This article sheds some light on a few common scenarios for PowerShell-targeting .NET projects and how to choose the right NuGet package to target for your PowerShell-oriented .NET project.</span></span>

## <a name="hosting-vs-referencing"></a><span data-ttu-id="24d0d-111">Värd vs-referering</span><span class="sxs-lookup"><span data-stu-id="24d0d-111">Hosting vs referencing</span></span>

<span data-ttu-id="24d0d-112">Vissa .NET-projekt söker efter att skriva kod som ska läsas in i en befintlig PowerShell-körning (till exempel `pwsh` , `powershell.exe` den integrerade PowerShell-konsolen eller ISE), medan andra vill köra PowerShell i sina egna program.</span><span class="sxs-lookup"><span data-stu-id="24d0d-112">Some .NET projects seek to write code to be loaded into a pre-existing PowerShell runtime (such as `pwsh`, `powershell.exe`, the PowerShell Integrated Console or the ISE), while others want to run PowerShell in their own applications.</span></span>

- <span data-ttu-id="24d0d-113">**Referenser** är till för när ett projekt, vanligt vis en modul, är avsett att läsas in i PowerShell.</span><span class="sxs-lookup"><span data-stu-id="24d0d-113">**Referencing** is for when a project, usually a module, is intended to be loaded into PowerShell.</span></span>
  <span data-ttu-id="24d0d-114">Den måste kompileras mot de API: er som PowerShell tillhandahåller för att kunna interagera med den, men PowerShell-implementeringen tillhandahålls av PowerShell-processen som läser in den i.</span><span class="sxs-lookup"><span data-stu-id="24d0d-114">It must be compiled against the APIs that PowerShell provides in order to interact with it, but the PowerShell implementation is supplied by the PowerShell process loading it in.</span></span> <span data-ttu-id="24d0d-115">Vid referenser kan ett projekt använda [referens sammansättningar][] eller de faktiska körnings sammansättningarna som ett mål för kompilering, men de måste se till att de inte publicerar någon av dessa med dess build.</span><span class="sxs-lookup"><span data-stu-id="24d0d-115">For referencing, a project can use [reference assemblies][] or the actual runtime assemblies as a compilation target, but must ensure that it does not publish any of these with its build.</span></span>
- <span data-ttu-id="24d0d-116">**Värd** är när ett projekt behöver en egen implementering av PowerShell, vanligt vis eftersom det är ett fristående program som behöver köra PowerShell.</span><span class="sxs-lookup"><span data-stu-id="24d0d-116">**Hosting** is when a project needs its own implementation of PowerShell, usually because it is a standalone application that needs to run PowerShell.</span></span> <span data-ttu-id="24d0d-117">I det här fallet kan du inte använda rent referens sammansättningar.</span><span class="sxs-lookup"><span data-stu-id="24d0d-117">In this case, pure reference assemblies cannot be used.</span></span> <span data-ttu-id="24d0d-118">I stället måste en konkret PowerShell-implementering vara beroende av.</span><span class="sxs-lookup"><span data-stu-id="24d0d-118">Instead, a concrete PowerShell implementation must be depended upon.</span></span> <span data-ttu-id="24d0d-119">Eftersom en konkret PowerShell-implementering måste användas måste du välja en viss version av PowerShell för att vara värd för. ett enda värd program kan inte använda PowerShell-versioner med flera mål.</span><span class="sxs-lookup"><span data-stu-id="24d0d-119">Because a concrete PowerShell implementation must be used, a specific version of PowerShell must be chosen for hosting; a single host application cannot multi-target PowerShell versions.</span></span>

### <a name="publishing-projects-that-target-powershell-as-a-reference"></a><span data-ttu-id="24d0d-120">Publicera projekt som är riktade till PowerShell som en referens</span><span class="sxs-lookup"><span data-stu-id="24d0d-120">Publishing projects that target PowerShell as a reference</span></span>

> [!NOTE]
> <span data-ttu-id="24d0d-121">Vi använder termen **publicera** i den här artikeln för att referera till körning `dotnet publish` , som placerar ett .NET-bibliotek i en katalog med alla dess beroenden, redo för distribution till en viss körning.</span><span class="sxs-lookup"><span data-stu-id="24d0d-121">We use the term **publish** in this article to refer to running `dotnet publish`, which places a .NET library into a directory with all of its dependencies, ready for deployment to a particular runtime.</span></span>

<span data-ttu-id="24d0d-122">För att förhindra publicering av projekt beroenden som bara används som referens mål för kompilering, rekommenderar vi att du anger [attributet PrivateAssets][]:</span><span class="sxs-lookup"><span data-stu-id="24d0d-122">In order to prevent publishing project dependencies that are just being used as compilation reference targets, it is recommended to set the [PrivateAssets attribute][]:</span></span>

```xml
<PackageReference Include="PowerShellStandard.Library" Version="5.1.0.0" PrivateAssets="all" />
```

<span data-ttu-id="24d0d-123">Om du glömmer att göra detta och använda en referens sammansättning som mål kan du se problem som rör användning av referens sammansättningens standard implementering i stället för den faktiska implementeringen.</span><span class="sxs-lookup"><span data-stu-id="24d0d-123">If you forget to do this and use a reference assembly as your target, you may see issues related to using the reference assembly's default implementation instead of the actual implementation.</span></span> <span data-ttu-id="24d0d-124">Detta kan ske i form av ett `NullReferenceException` , eftersom referens sammansättningar ofta modellerar implementerings-API: n genom att bara returnera `null` .</span><span class="sxs-lookup"><span data-stu-id="24d0d-124">This may take the form of a `NullReferenceException`, since reference assemblies often mock the implementation API by simply returning `null`.</span></span>

## <a name="key-kinds-of-powershell-targeting-net-projects"></a><span data-ttu-id="24d0d-125">Viktiga typer av PowerShell-riktade .NET-projekt</span><span class="sxs-lookup"><span data-stu-id="24d0d-125">Key kinds of PowerShell-targeting .NET projects</span></span>

<span data-ttu-id="24d0d-126">Alla .NET-bibliotek eller program kan bädda in PowerShell, men det finns några vanliga scenarier som använder PowerShell-API: er:</span><span class="sxs-lookup"><span data-stu-id="24d0d-126">While any .NET library or application can embed PowerShell, there are some common scenarios that use PowerShell APIs:</span></span>

- <span data-ttu-id="24d0d-127">**Implementera en PowerShell-modul för binär**</span><span class="sxs-lookup"><span data-stu-id="24d0d-127">**Implementing a PowerShell binary module**</span></span>

  <span data-ttu-id="24d0d-128">PowerShell-binärfiler är .NET-bibliotek som läses in av PowerShell och som måste implementera PowerShell-API: er som [PSCmdlet][] -eller [CmdletProvider][] -typer för att kunna exponera cmdlets eller providers.</span><span class="sxs-lookup"><span data-stu-id="24d0d-128">PowerShell binary modules are .NET libraries loaded by PowerShell that must implement PowerShell APIs like the [PSCmdlet][] or [CmdletProvider][] types in order to expose cmdlets or providers respectively.</span></span> <span data-ttu-id="24d0d-129">Eftersom de läses in i söker moduler i syfte att kompilera mot referenser till PowerShell utan att publicera den i sin version.</span><span class="sxs-lookup"><span data-stu-id="24d0d-129">Because they are loaded in, modules seek to compile against references to PowerShell without publishing it in their build.</span></span> <span data-ttu-id="24d0d-130">Det är också vanligt för moduler som vill ha stöd för flera PowerShell-versioner och plattformar, helst med ett minimum av disk utrymme, komplexitet eller upprepad implementering.</span><span class="sxs-lookup"><span data-stu-id="24d0d-130">It's also common for modules to want to support multiple PowerShell versions and platforms, ideally with a minimum of overhead of disk space, complexity, or repeated implementation.</span></span> <span data-ttu-id="24d0d-131">Se [about_Modules][] för mer information om moduler.</span><span class="sxs-lookup"><span data-stu-id="24d0d-131">See [about_Modules][] for more information about modules.</span></span>

- <span data-ttu-id="24d0d-132">**Implementera en PowerShell-värd**</span><span class="sxs-lookup"><span data-stu-id="24d0d-132">**Implementing a PowerShell Host**</span></span>

  <span data-ttu-id="24d0d-133">En PowerShell-värd tillhandahåller ett interaktions lager för PowerShell-körningsmiljön.</span><span class="sxs-lookup"><span data-stu-id="24d0d-133">A PowerShell Host provides an interaction layer for the PowerShell runtime.</span></span> <span data-ttu-id="24d0d-134">Det är en speciell typ av _värd_där en [PSHost][] implementeras som ett nytt användar gränssnitt till PowerShell.</span><span class="sxs-lookup"><span data-stu-id="24d0d-134">It is a specific form of _hosting_, where a [PSHost][] is implemented as a new user interface to PowerShell.</span></span> <span data-ttu-id="24d0d-135">PowerShell-ConsoleHost innehåller till exempel ett Terminal-användargränssnitt för körbara PowerShell-filer, medan PowerShell-redigeraren Services-värden och ISE-värden båda ger ett redigerings program integrerat delvis grafiskt användar gränssnitt runt PowerShell.</span><span class="sxs-lookup"><span data-stu-id="24d0d-135">For example, the PowerShell ConsoleHost provides a terminal user interface for PowerShell executables, while the PowerShell Editor Services Host and the ISE Host both provide an editor-integrated partially graphical user interface around PowerShell.</span></span> <span data-ttu-id="24d0d-136">Även om det är möjligt att läsa in en värd på en befintlig PowerShell-process, är det mycket vanligare att en värd implementering fungerar som en fristående PowerShell-implementering som distribuerar om PowerShell-motorn.</span><span class="sxs-lookup"><span data-stu-id="24d0d-136">While it's possible to load a host onto an existing PowerShell process, it's much more common for a host implementation to act as a standalone PowerShell implementation that redistributes the PowerShell engine.</span></span>

- <span data-ttu-id="24d0d-137">**Anropar PowerShell från ett annat .NET-program**</span><span class="sxs-lookup"><span data-stu-id="24d0d-137">**Calling into PowerShell from another .NET application**</span></span>

  <span data-ttu-id="24d0d-138">Som med alla program kan PowerShell anropas som en under process för att köra arbets belastningar.</span><span class="sxs-lookup"><span data-stu-id="24d0d-138">As with any application, PowerShell can be called as a subprocess to run workloads.</span></span> <span data-ttu-id="24d0d-139">Men som .NET-program, är det också möjligt att anropa PowerShell i processen för att få tillbaka fullständiga .NET-objekt som ska användas i det anropande programmet.</span><span class="sxs-lookup"><span data-stu-id="24d0d-139">However, as a .NET application, it's also possible to invoke PowerShell in-process to get back full .NET objects for use within the calling application.</span></span> <span data-ttu-id="24d0d-140">Det här är en mer allmän typ av _värd_där programmet har sin egen PowerShell-implementering för intern användning.</span><span class="sxs-lookup"><span data-stu-id="24d0d-140">This is a more general form of _hosting_, where the application holds its own PowerShell implementation for internal use.</span></span> <span data-ttu-id="24d0d-141">Exempel på detta kan vara en tjänst eller daemon som kör PowerShell för att hantera dator tillstånd eller ett webb program som kör PowerShell på begäran för att göra något som till exempel hanterar moln distributioner.</span><span class="sxs-lookup"><span data-stu-id="24d0d-141">Examples of this might be a service or daemon running PowerShell to manage machine state or a web application that runs PowerShell on request to do something like manage cloud deployments.</span></span>

- <span data-ttu-id="24d0d-142">**Enhets testning PowerShell-moduler från .NET**</span><span class="sxs-lookup"><span data-stu-id="24d0d-142">**Unit testing PowerShell modules from .NET**</span></span>

  <span data-ttu-id="24d0d-143">Även om moduler och andra bibliotek som är utformade för att exponera funktioner till PowerShell bör testas i första hand från PowerShell (vi rekommenderar [pester][]), ibland är det nödvändigt att enhets test-API: er skrivs för en PowerShell-modul från .net.</span><span class="sxs-lookup"><span data-stu-id="24d0d-143">While modules and other libraries designed to expose functionality to PowerShell should be primarily tested from PowerShell (we recommend [Pester][]), sometimes it's necessary to unit test APIs written for a PowerShell module from .NET.</span></span> <span data-ttu-id="24d0d-144">Den här situationen innebär att modulens kod försöker rikta in sig på ett antal PowerShell-versioner, medan testningen ska köra den på specifika, konkreta implementeringar.</span><span class="sxs-lookup"><span data-stu-id="24d0d-144">This situation involves the module code trying to target a number of PowerShell versions, while testing should run it on specific, concrete implementations.</span></span>

## <a name="powershell-nuget-packages-at-a-glance"></a><span data-ttu-id="24d0d-145">PowerShell NuGet-paket snabbt</span><span class="sxs-lookup"><span data-stu-id="24d0d-145">PowerShell NuGet packages at a glance</span></span>

<span data-ttu-id="24d0d-146">I den här artikeln kommer vi att gå igenom följande NuGet-paket som visar PowerShell-API: er:</span><span class="sxs-lookup"><span data-stu-id="24d0d-146">In this article, we'll cover the following NuGet packages that expose PowerShell APIs:</span></span>

- <span data-ttu-id="24d0d-147">[PowerShellStandard. Library][], en referens sammansättning som gör det möjligt att skapa en enda sammansättning som kan läsas in med flera PowerShell-körningar.</span><span class="sxs-lookup"><span data-stu-id="24d0d-147">[PowerShellStandard.Library][], a reference assembly that enables building a single assembly that can be loaded by multiple PowerShell runtimes.</span></span>
- <span data-ttu-id="24d0d-148">[Microsoft. PowerShell. SDK][], hur du kan rikta in och vara värd för hela PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="24d0d-148">[Microsoft.PowerShell.SDK][], the way to target and rehost the whole PowerShell SDK</span></span>
- <span data-ttu-id="24d0d-149">Paketet [system. Management. Automation][] , PowerShell-körningen och motor implementeringen, som kan vara användbara i minimala värdbaserade implementeringar och för versions specifika mål scenarier.</span><span class="sxs-lookup"><span data-stu-id="24d0d-149">The [System.Management.Automation][] package, the core PowerShell runtime and engine implementation, that can be useful in minimal hosted implementations and for version-specific targeting scenarios.</span></span>
- <span data-ttu-id="24d0d-150">**Windows PowerShell Reference-sammansättningar**, sätt att rikta och faktiskt vara värd för Windows PowerShell (PowerShell-versioner 5,1 och senare).</span><span class="sxs-lookup"><span data-stu-id="24d0d-150">The **Windows PowerShell reference assemblies**, the way to target and effectively rehost Windows PowerShell (PowerShell versions 5.1 and below).</span></span>

> [!NOTE]
> <span data-ttu-id="24d0d-151">[PowerShell-NuGet][] -paketet är inte ett .NET-bibliotek alls, utan ger i stället PowerShell-verktyget för global användning av PowerShell dotNet.</span><span class="sxs-lookup"><span data-stu-id="24d0d-151">The [PowerShell NuGet][] package is not a .NET library package at all, but instead provides the PowerShell dotnet global tool implementation.</span></span> <span data-ttu-id="24d0d-152">Detta bör inte användas av några projekt eftersom det bara tillhandahåller en körbar fil.</span><span class="sxs-lookup"><span data-stu-id="24d0d-152">This should not be used by any projects, since it only provides an executable.</span></span>

## <a name="powershellstandardlibrary"></a><span data-ttu-id="24d0d-153">PowerShellStandard. Library</span><span class="sxs-lookup"><span data-stu-id="24d0d-153">PowerShellStandard.Library</span></span>

<span data-ttu-id="24d0d-154">PowerShell-standardbiblioteket är en referens sammansättning som samlar in skärnings punkten för API: erna i PowerShell-versionerna 7, 6 och 5,1.</span><span class="sxs-lookup"><span data-stu-id="24d0d-154">The PowerShell Standard library is a reference assembly that captures the intersection of the APIs of PowerShell versions 7, 6 and 5.1.</span></span> <span data-ttu-id="24d0d-155">Detta ger en sammanfattande API-yta för att kompilera .NET-kod mot, vilket gör det möjligt för .NET-projekt att använda PowerShell-versionerna 7, 6 och 5,1 utan att riskera att anropa ett API som inte finns där.</span><span class="sxs-lookup"><span data-stu-id="24d0d-155">This provides a compile-time-checked API surface to compile .NET code against, allowing .NET projects to target PowerShell versions 7, 6 and 5.1 without risking calling an API that won't be there.</span></span>

<span data-ttu-id="24d0d-156">PowerShell-standarden är avsedd för att skriva PowerShell-moduler eller annan kod som endast ska köras när den har lästs in i en PowerShell-process.</span><span class="sxs-lookup"><span data-stu-id="24d0d-156">PowerShell Standard is intended for writing PowerShell modules, or other code only intended to be run after loading it into a PowerShell process.</span></span> <span data-ttu-id="24d0d-157">Eftersom det är en referens sammansättning innehåller PowerShell-standarden ingen implementering, så ingen funktionalitet för fristående program.</span><span class="sxs-lookup"><span data-stu-id="24d0d-157">Because it is a reference assembly, PowerShell Standard contains no implementation itself, so provides no functionality for standalone applications.</span></span>

### <a name="using-powershell-standard-with-different-net-runtimes"></a><span data-ttu-id="24d0d-158">Använda PowerShell-standarden med olika .NET-körningar</span><span class="sxs-lookup"><span data-stu-id="24d0d-158">Using PowerShell Standard with different .NET runtimes</span></span>

<span data-ttu-id="24d0d-159">PowerShell-standarden riktar sig till [.net standard 2,0][] -mål körning, som är en fasad-körning utformad för att tillhandahålla ett gemensamt ytdiagram som delas av .NET Framework och .net Core.</span><span class="sxs-lookup"><span data-stu-id="24d0d-159">PowerShell Standard targets the [.NET Standard 2.0][] target runtime, which is a façade runtime designed to provide a common surface area shared by .NET Framework and .NET Core.</span></span> <span data-ttu-id="24d0d-160">Detta gör att du kan använda en enskild körning för att skapa en enda sammansättning som fungerar med flera PowerShell-versioner, men som har följande konsekvenser:</span><span class="sxs-lookup"><span data-stu-id="24d0d-160">This allows targeting a single runtime to produce a single assembly that will work with multiple PowerShell versions, but has the following consequences:</span></span>

- <span data-ttu-id="24d0d-161">PowerShell-inläsningen av modulen eller biblioteket måste köra minst .NET 4.6.1; .NET 4,6 och .NET 4.5.2 stöder inte .NET standard.</span><span class="sxs-lookup"><span data-stu-id="24d0d-161">The PowerShell loading the module or library must be running a minimum of .NET 4.6.1; .NET 4.6 and .NET 4.5.2 do not support .NET Standard.</span></span> <span data-ttu-id="24d0d-162">Observera att en nyare Windows PowerShell-version inte innebär en nyare .NET Framework version; Windows PowerShell 5,1 kan köras på .NET 4.5.2.</span><span class="sxs-lookup"><span data-stu-id="24d0d-162">Note that a newer Windows PowerShell version does not mean a newer .NET Framework version; Windows PowerShell 5.1 may run on .NET 4.5.2.</span></span>
- <span data-ttu-id="24d0d-163">För att kunna arbeta med en PowerShell som kör .NET Framework 4.7.1 eller lägre, krävs .NET 4.6.1 [netstandard. biblioteks][] implementering krävs för att tillhandahålla netstandard.dll och andra shim-sammansättningar i äldre .NET Framework versioner.</span><span class="sxs-lookup"><span data-stu-id="24d0d-163">In order to work with a PowerShell running .NET Framework 4.7.1 or below, the .NET 4.6.1 [NETStandard.Library][] implementation is required to provide the netstandard.dll and other shim assemblies in older .NET Framework versions.</span></span>

<span data-ttu-id="24d0d-164">PowerShell 6 + tillhandahåller egna shim-sammansättningar för typ vidarebefordring från .NET Framework 4.6.1 (och senare) till .NET Core.</span><span class="sxs-lookup"><span data-stu-id="24d0d-164">PowerShell 6+ provides its own shim assemblies for type forwarding from .NET Framework 4.6.1 (and above) to .NET Core.</span></span> <span data-ttu-id="24d0d-165">Det innebär att så länge en modul endast använder API: er som finns i .NET Core, kan PowerShell 6 + läsa in och köra den när den har skapats för .NET Framework 4.6.1 ( `net461` körnings målet).</span><span class="sxs-lookup"><span data-stu-id="24d0d-165">This means that as long as a module uses only APIs that exist in .NET Core, PowerShell 6+ can load and run it when it has been built for .NET Framework 4.6.1 (the `net461` runtime target).</span></span>

<span data-ttu-id="24d0d-166">Det innebär att binära moduler som använder PowerShell-standarden för att nå flera PowerShell-versioner med en enda publicerad DLL-fil har två alternativ:</span><span class="sxs-lookup"><span data-stu-id="24d0d-166">This means that binary modules using PowerShell Standard to target multiple PowerShell versions with a single published DLL have two options:</span></span>

1. <span data-ttu-id="24d0d-167">Publicera en sammansättning som skapats för `net461` mål körningen.</span><span class="sxs-lookup"><span data-stu-id="24d0d-167">Publishing an assembly built for the `net461` target runtime.</span></span> <span data-ttu-id="24d0d-168">Detta omfattar:</span><span class="sxs-lookup"><span data-stu-id="24d0d-168">This involves:</span></span>
   - <span data-ttu-id="24d0d-169">Publicera projektet för `net461` körning</span><span class="sxs-lookup"><span data-stu-id="24d0d-169">Publishing the project for the `net461` runtime</span></span>
   - <span data-ttu-id="24d0d-170">Kompilera även mot `netstandard2.0` körning (utan att använda dess build-utdata) för att säkerställa att alla API: er som används också finns i .net Core.</span><span class="sxs-lookup"><span data-stu-id="24d0d-170">Also compiling against the `netstandard2.0` runtime (without using its build output) to ensure that all APIs used are also present in .NET Core.</span></span>

1. <span data-ttu-id="24d0d-171">Publicera en sammansättnings version för `netstandard2.0` mål körningen.</span><span class="sxs-lookup"><span data-stu-id="24d0d-171">Publishing an assembly build for the `netstandard2.0` target runtime.</span></span> <span data-ttu-id="24d0d-172">Detta kräver:</span><span class="sxs-lookup"><span data-stu-id="24d0d-172">This requires:</span></span>
   - <span data-ttu-id="24d0d-173">Publicera projektet för `netstandard2.0` körning</span><span class="sxs-lookup"><span data-stu-id="24d0d-173">Publishing the project for the `netstandard2.0` runtime</span></span>
   - <span data-ttu-id="24d0d-174">Tar bort `net461` beroenden av netstandard. Library och kopierar dem till projekt sammansättningens publicerings plats så att sammansättningen korrigeras i .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="24d0d-174">Taking the `net461` dependencies of NETStandard.Library and copying them into the project assembly's publish location so that the assembly is type-forwarded corrected in .NET Framework.</span></span>

<span data-ttu-id="24d0d-175">Om du vill bygga PowerShell-moduler eller-bibliotek som är riktade till äldre .NET Framework-versioner kan det vara bättre att använda flera .NET-körningar.</span><span class="sxs-lookup"><span data-stu-id="24d0d-175">To build PowerShell modules or libraries targeting older .NET Framework versions, it may be preferable to target multiple .NET runtimes.</span></span> <span data-ttu-id="24d0d-176">Detta publicerar en sammansättning för varje mål körning och rätt sammansättning måste läsas in vid modulens inläsnings tid (till exempel med en liten psm1 som rotnod).</span><span class="sxs-lookup"><span data-stu-id="24d0d-176">This will publish an assembly for each target runtime, and the correct assembly will need to be loaded at module load time (for example with a small psm1 as the root module).</span></span>

### <a name="testing-powershell-standard-projects-in-net"></a><span data-ttu-id="24d0d-177">Testa PowerShell standard-projekt i .NET</span><span class="sxs-lookup"><span data-stu-id="24d0d-177">Testing PowerShell Standard projects in .NET</span></span>

<span data-ttu-id="24d0d-178">När det gäller att testa modulen i .NET-testlöpare som xUnit, kom ihåg att det bara går att utföra kompilerings kontrollerna.</span><span class="sxs-lookup"><span data-stu-id="24d0d-178">When it comes to testing your module in .NET test runners like xUnit, remember that compile-time checks can only go so far.</span></span> <span data-ttu-id="24d0d-179">Du måste testa modulen mot de relevanta PowerShell-plattformarna.</span><span class="sxs-lookup"><span data-stu-id="24d0d-179">You must test your module against the relevant PowerShell platforms.</span></span>

<span data-ttu-id="24d0d-180">För att testa API: er som bygger på PowerShell-standarden i .NET, bör du lägga till `Microsoft.Powershell.SDK` som ett test beroende med .net Core (med versionen inställd på att matcha den önskade PowerShell-versionen) och lämpliga referens sammansättningar för Windows PowerShell med .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="24d0d-180">To test APIs built against PowerShell Standard in .NET, you should add `Microsoft.Powershell.SDK` as a testing dependency with .NET Core (with the version set to match the desired PowerShell version), and the appropriate Windows PowerShell reference assemblies with .NET Framework.</span></span>

<span data-ttu-id="24d0d-181">Mer information om PowerShell-standarden och hur du använder den för att skriva en binär modul som fungerar i flera PowerShell-versioner finns i [det här blogg inlägget][].</span><span class="sxs-lookup"><span data-stu-id="24d0d-181">For more information on PowerShell Standard and using it to write a binary module that works in multiple PowerShell versions, see [this blog post][].</span></span> <span data-ttu-id="24d0d-182">Se även [PowerShell-standardlagringsplatsen][] på GitHub.</span><span class="sxs-lookup"><span data-stu-id="24d0d-182">Also see the [PowerShell Standard repository][] on GitHub.</span></span>

## <a name="microsoftpowershellsdk"></a><span data-ttu-id="24d0d-183">Microsoft. PowerShell. SDK</span><span class="sxs-lookup"><span data-stu-id="24d0d-183">Microsoft.PowerShell.SDK</span></span>

<span data-ttu-id="24d0d-184">`Microsoft.PowerShell.SDK` är ett meta-paket som drar samman alla komponenter i PowerShell SDK till ett enda NuGet-paket.</span><span class="sxs-lookup"><span data-stu-id="24d0d-184">`Microsoft.PowerShell.SDK` is a meta-package that pulls together all of the components of the PowerShell SDK into a single NuGet package.</span></span> <span data-ttu-id="24d0d-185">Ett fristående .NET-program kan använda Microsoft. PowerShell. SDK för att köra valfria PowerShell-funktioner utan beroende på externa PowerShell-installationer eller bibliotek.</span><span class="sxs-lookup"><span data-stu-id="24d0d-185">A self-contained .NET application can use Microsoft.PowerShell.SDK to run arbitrary PowerShell functionality without depending on any external PowerShell installations or libraries.</span></span>

> [!NOTE]
> <span data-ttu-id="24d0d-186">PowerShell SDK refererar bara till alla komponent paket som utgör PowerShell och som kan användas för .NET-utveckling med PowerShell.</span><span class="sxs-lookup"><span data-stu-id="24d0d-186">The PowerShell SDK just refers to all the component packages that make up PowerShell, and which can be used for .NET development with PowerShell.</span></span>

<span data-ttu-id="24d0d-187">En specifik `Microsoft.Powershell.SDK` version innehåller den konkreta implementeringen av samma version av PowerShell-programmet, version 7,0, som innehåller implementeringen av powershell 7,0 och körning av kommandon eller skript med den fungerar i stort sett likadant som att köra dem i PowerShell 7,0.</span><span class="sxs-lookup"><span data-stu-id="24d0d-187">A given `Microsoft.Powershell.SDK` version contains the concrete implementation of the same version of the PowerShell application; version 7.0 contains the implementation of PowerShell 7.0 and running commands or scripts with it will largely behave like running them in PowerShell 7.0.</span></span>

<span data-ttu-id="24d0d-188">Att köra PowerShell-kommandon från SDK: n är huvudsakligen, men inte helt, samma som att köra dem från `pwsh` .</span><span class="sxs-lookup"><span data-stu-id="24d0d-188">Running PowerShell commands from the SDK is mostly, but not totally, the same as running them from `pwsh`.</span></span> <span data-ttu-id="24d0d-189">Till exempel är [Start-Job][] beroende av att den `pwsh` körbara filen är tillgänglig och fungerar inte med `Microsoft.Powershell.SDK` som standard.</span><span class="sxs-lookup"><span data-stu-id="24d0d-189">For example, [Start-Job][] currently depends on the `pwsh` executable being available, and so will not work with `Microsoft.Powershell.SDK` by default.</span></span>

<span data-ttu-id="24d0d-190">Genom att rikta in `Microsoft.Powershell.SDK` dig på ett .NET-program kan du integrera med alla implementerings sammansättningar i PowerShell, till exempel, `System.Management.Automation` `Microsoft.PowerShell.Management` och andra modul sammansättningar.</span><span class="sxs-lookup"><span data-stu-id="24d0d-190">Targeting `Microsoft.Powershell.SDK` from a .NET application allows you to integrate with all of PowerShell's implementation assemblies, such as `System.Management.Automation`, `Microsoft.PowerShell.Management`, and other module assemblies.</span></span>

<span data-ttu-id="24d0d-191">Om du publicerar en program mål grupp `Microsoft.Powershell.SDK` ingår alla dessa sammansättningar och alla beroenden PowerShell kräver.</span><span class="sxs-lookup"><span data-stu-id="24d0d-191">Publishing an application targeting `Microsoft.Powershell.SDK` will include all these assemblies, and any dependencies PowerShell requires.</span></span> <span data-ttu-id="24d0d-192">Det inkluderar även andra till gångar som PowerShell kräver i dess version, till exempel modulen manifest för `Microsoft.PowerShell.*` moduler och `ref` katalogen som krävs av [Add-Type][].</span><span class="sxs-lookup"><span data-stu-id="24d0d-192">It will also include other assets that PowerShell required in its build, such as the module manifests for `Microsoft.PowerShell.*` modules and the `ref` directory required by [Add-Type][].</span></span>

<span data-ttu-id="24d0d-193">Med tanke på att `Microsoft.Powershell.SDK` det passar bäst för:</span><span class="sxs-lookup"><span data-stu-id="24d0d-193">Given the completeness of `Microsoft.Powershell.SDK`, it's best suited for:</span></span>

- <span data-ttu-id="24d0d-194">Implementering av PowerShell-värdar.</span><span class="sxs-lookup"><span data-stu-id="24d0d-194">Implementation of PowerShell hosts.</span></span>
- <span data-ttu-id="24d0d-195">xUnit-testning av bibliotek som riktar sig mot PowerShell Reference-sammansättningar.</span><span class="sxs-lookup"><span data-stu-id="24d0d-195">xUnit testing of libraries targeting PowerShell reference assemblies.</span></span>
- <span data-ttu-id="24d0d-196">Anropar PowerShell i processen från ett .NET-program.</span><span class="sxs-lookup"><span data-stu-id="24d0d-196">Invoking PowerShell in-process from a .NET application.</span></span>

<span data-ttu-id="24d0d-197">`Microsoft.PowerShell.SDK` kan också användas som referens mål när ett .NET-projekt är avsett att användas som en modul eller på annat sätt läses in av PowerShell, men är beroende av API: er som bara finns i en viss version av PowerShell.</span><span class="sxs-lookup"><span data-stu-id="24d0d-197">`Microsoft.PowerShell.SDK` may also be used as a reference target when a .NET project is intended to be used as a module or otherwise loaded by PowerShell, but depends on APIs only present in a particular version of PowerShell.</span></span> <span data-ttu-id="24d0d-198">Observera att en sammansättning som publicerats mot en speciell version av `Microsoft.PowerShell.SDK` endast är säker att läsa in och använda i den versionen av PowerShell.</span><span class="sxs-lookup"><span data-stu-id="24d0d-198">Note that an assembly published against a specific version of `Microsoft.PowerShell.SDK` will only be safe to load and use in that version of PowerShell.</span></span> <span data-ttu-id="24d0d-199">För att nå flera PowerShell-versioner med specifika API: er krävs flera versioner, varje mål version av `Microsoft.Powershell.SDK` .</span><span class="sxs-lookup"><span data-stu-id="24d0d-199">To target multiple PowerShell versions with specific APIs, multiple builds are required, each targeting their own version of `Microsoft.Powershell.SDK`.</span></span>

> [!NOTE]
> <span data-ttu-id="24d0d-200">PowerShell SDK är bara tillgängligt för PowerShell version 6 och senare.</span><span class="sxs-lookup"><span data-stu-id="24d0d-200">The PowerShell SDK is only available for PowerShell versions 6 and up.</span></span> <span data-ttu-id="24d0d-201">Använd referens sammansättningarna för Windows PowerShell som beskrivs nedan för att ge motsvarande funktionalitet med Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="24d0d-201">To provide equivalent functionality with Windows PowerShell, use the Windows PowerShell reference assemblies described below.</span></span>

## <a name="systemmanagementautomation"></a><span data-ttu-id="24d0d-202">System. Management. Automation</span><span class="sxs-lookup"><span data-stu-id="24d0d-202">System.Management.Automation</span></span>

<span data-ttu-id="24d0d-203">`System.Management.Automation`Paketet är kärnan i POWERSHELL SDK.</span><span class="sxs-lookup"><span data-stu-id="24d0d-203">The `System.Management.Automation` package is the heart of the PowerShell SDK.</span></span> <span data-ttu-id="24d0d-204">Den finns på NuGet, främst som en till gång för `Microsoft.Powershell.SDK` att hämta i.</span><span class="sxs-lookup"><span data-stu-id="24d0d-204">It exists on NuGet, primarily, as an asset for `Microsoft.Powershell.SDK` to pull in.</span></span> <span data-ttu-id="24d0d-205">Det kan dock också användas direkt som ett paket för mindre värd scenarier och moduler för versions mål.</span><span class="sxs-lookup"><span data-stu-id="24d0d-205">However, it can also be used directly as a package for smaller hosting scenarios and version-targeting modules.</span></span>

<span data-ttu-id="24d0d-206">Mer specifikt `System.Management.Automation` kan paketet vara en bättre leverantör av PowerShell-funktioner när:</span><span class="sxs-lookup"><span data-stu-id="24d0d-206">Specifically, the `System.Management.Automation` package may be a preferable provider of PowerShell functionality when:</span></span>

- <span data-ttu-id="24d0d-207">Du vill bara använda PowerShell-språkfunktioner (i `System.Management.Automation.Language` namn rymden) som PowerShell-parser, AST-och AST-besökets API: er (till exempel för statisk analys av PowerShell).</span><span class="sxs-lookup"><span data-stu-id="24d0d-207">You're only looking to use PowerShell language functionality (in the `System.Management.Automation.Language` namespace) like the PowerShell parser, AST, and AST visitor APIs (for example for static analysis of PowerShell).</span></span>
- <span data-ttu-id="24d0d-208">Du vill bara köra vissa kommandon från `Microsoft.PowerShell.Core` modulen och köra dem i ett sessionstillstånd som har skapats med [CreateDefault2][] Factory-metoden.</span><span class="sxs-lookup"><span data-stu-id="24d0d-208">You only wish to execute specific commands from the `Microsoft.PowerShell.Core` module and can execute them in a session state created with the [CreateDefault2][] factory method.</span></span>

<span data-ttu-id="24d0d-209">Dessutom `System.Management.Automation` är en användbar referens sammansättning när:</span><span class="sxs-lookup"><span data-stu-id="24d0d-209">Additionally, `System.Management.Automation` is a useful reference assembly when:</span></span>

- <span data-ttu-id="24d0d-210">Du vill ha mål-API: er som bara finns i en angiven PowerShell-version</span><span class="sxs-lookup"><span data-stu-id="24d0d-210">You wish to target APIs that are only present within a specific PowerShell version</span></span>
- <span data-ttu-id="24d0d-211">Du kommer inte att vara beroende av typer som inträffar utanför `System.Management.Automation` sammansättningen (till exempel typer som exporteras av cmdletar i `Microsoft.PowerShell.*` moduler).</span><span class="sxs-lookup"><span data-stu-id="24d0d-211">You won't be depending on types occurring outside the `System.Management.Automation` assembly (for example, types exported by cmdlets in `Microsoft.PowerShell.*` modules).</span></span>

## <a name="windows-powershell-reference-assemblies"></a><span data-ttu-id="24d0d-212">Referens sammansättningar för Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="24d0d-212">Windows PowerShell reference assemblies</span></span>

<span data-ttu-id="24d0d-213">För PowerShell-versionerna 5,1 och äldre (Windows PowerShell) finns det ingen SDK för att tillhandahålla en implementering av PowerShell, eftersom Windows PowerShell-implementeringen är en del av Windows.</span><span class="sxs-lookup"><span data-stu-id="24d0d-213">For PowerShell versions 5.1 and older (Windows PowerShell), there is no SDK to provide an implementation of PowerShell, since Windows PowerShell's implementation is a part of Windows.</span></span>

<span data-ttu-id="24d0d-214">I stället tillhandahåller referens sammansättningarna för Windows PowerShell båda referens målen och ett sätt att revara värd för Windows PowerShell, och fungerar på samma sätt som PowerShell SDK för version 6 och senare.</span><span class="sxs-lookup"><span data-stu-id="24d0d-214">Instead, the Windows PowerShell reference assemblies provide both reference targets and a way to rehost Windows PowerShell, acting the same as the PowerShell SDK does for versions 6 and up.</span></span>

<span data-ttu-id="24d0d-215">I stället för att differentieras av versionen har Windows PowerShell-referens sammansättningar ett annat paket för varje version av Windows PowerShell:</span><span class="sxs-lookup"><span data-stu-id="24d0d-215">Rather than being differentiated by version, Windows PowerShell reference assemblies have a different package for each version of Windows PowerShell:</span></span>

- [<span data-ttu-id="24d0d-216">PowerShell 5.1</span><span class="sxs-lookup"><span data-stu-id="24d0d-216">PowerShell 5.1</span></span>](https://www.nuget.org/packages/Microsoft.PowerShell.5.ReferenceAssemblies/)
- [<span data-ttu-id="24d0d-217">PowerShell 4</span><span class="sxs-lookup"><span data-stu-id="24d0d-217">PowerShell 4</span></span>](https://www.nuget.org/packages/Microsoft.PowerShell.4.ReferenceAssemblies/)
- [<span data-ttu-id="24d0d-218">PowerShell 3</span><span class="sxs-lookup"><span data-stu-id="24d0d-218">PowerShell 3</span></span>](https://www.nuget.org/packages/Microsoft.PowerShell.3.ReferenceAssemblies/)

<span data-ttu-id="24d0d-219">Information om hur du använder Windows PowerShell-referens sammansättningar finns i [Windows POWERSHELL SDK][].</span><span class="sxs-lookup"><span data-stu-id="24d0d-219">Information on how to use the Windows PowerShell reference assemblies can be found in the [Windows PowerShell SDK][].</span></span>

## <a name="real-world-examples-using-these-nuget-packages"></a><span data-ttu-id="24d0d-220">Verkliga exempel som använder dessa NuGet-paket</span><span class="sxs-lookup"><span data-stu-id="24d0d-220">Real-world examples using these NuGet packages</span></span>

<span data-ttu-id="24d0d-221">Olika PowerShell-verktyg för projekt riktar sig mot olika PowerShell NuGet-paket beroende på deras behov.</span><span class="sxs-lookup"><span data-stu-id="24d0d-221">Different PowerShell tooling projects target different PowerShell NuGet packages depending on their needs.</span></span> <span data-ttu-id="24d0d-222">Här visas några viktiga exempel.</span><span class="sxs-lookup"><span data-stu-id="24d0d-222">Listed here are some notable examples.</span></span>

### <a name="psreadline"></a><span data-ttu-id="24d0d-223">PSReadLine</span><span class="sxs-lookup"><span data-stu-id="24d0d-223">PSReadLine</span></span>

<span data-ttu-id="24d0d-224">[PSReadLine][], PowerShell-modulen som ger mycket av PowerShell: s omfattande konsol upplevelse, är riktad till PowerShell-standard som ett beroende snarare än en viss PowerShell-version och är riktad `net461` mot .net-körningen i dess [CSPROJ][].</span><span class="sxs-lookup"><span data-stu-id="24d0d-224">[PSReadLine][], the PowerShell module that provides much of PowerShell's rich console experience, targets PowerShell Standard as a dependency rather than a specific PowerShell version, and targets the `net461` .NET runtime in its [csproj][].</span></span>

<span data-ttu-id="24d0d-225">PowerShell 6 + tillhandahåller sina egna shim-sammansättningar som gör att en DLL som riktar `net461` sig mot körningen "fungerar" när den läses in (genom att bindningen dirigeras om till .NET Framework `mscorlib.dll` till den relevanta .net Core-sammansättningen).</span><span class="sxs-lookup"><span data-stu-id="24d0d-225">PowerShell 6+ supplies its own shim assemblies that allow a DLL targeting the `net461` runtime to "just work" when loaded in (by redirecting binding to .NET Framework's `mscorlib.dll` to the relevant .NET Core assembly).</span></span>

<span data-ttu-id="24d0d-226">Detta fören klar PSReadLine och leveransen av modulen avsevärt, eftersom PowerShell-standarden säkerställer att de enda API: erna som används finns i både PowerShell 5,1 och PowerShell 6 +, samtidigt som modulen också kan leverera med endast en enda sammansättning.</span><span class="sxs-lookup"><span data-stu-id="24d0d-226">This simplifies PSReadLine's module layout and delivery significantly, since PowerShell Standard ensures the only APIs used will be present in both PowerShell 5.1 and PowerShell 6+, while also allowing the module to ship with only a single assembly.</span></span>

<span data-ttu-id="24d0d-227">.NET 4.6.1-målet innebär att Windows PowerShell som körs på .NET 4.5.2 och .NET 4,6 inte stöds om.</span><span class="sxs-lookup"><span data-stu-id="24d0d-227">The .NET 4.6.1 target does mean that Windows PowerShell running on .NET 4.5.2 and .NET 4.6 is not supported though.</span></span>

### <a name="powershell-editor-services"></a><span data-ttu-id="24d0d-228">PowerShell-redigerare-tjänster</span><span class="sxs-lookup"><span data-stu-id="24d0d-228">PowerShell Editor Services</span></span>

<span data-ttu-id="24d0d-229">[PowerShell-redigeraren][] (PSES) är Server delen för [PowerShell-tillägget][] för [Visual Studio Code][], och är i själva verket en form av PowerShell-modul som läses in av en PowerShell-körbar fil och som sedan tar över den processen för att vara värd för PowerShell i sig samtidigt som även tillhandahåller språk tjänst protokoll och fel söknings funktioner.</span><span class="sxs-lookup"><span data-stu-id="24d0d-229">[PowerShell Editor Services][] (PSES) is the backend for the [PowerShell extension][] for [Visual Studio Code][], and is actually a form of PowerShell module that gets loaded by a PowerShell executable and then takes over that process to rehost PowerShell within itself while also providing Language Service Protocol and Debug Adapter features.</span></span>

<span data-ttu-id="24d0d-230">PSES tillhandahåller konkreta implementerings mål för `netcoreapp2.1` att nå PowerShell 6 + (sedan PowerShell 7 `netcoreapp3.1` : s körning är bakåtkompatibla) och `net461` för att rikta Windows PowerShell 5,1, men innehåller merparten av sin logik i en andra sammansättning som är riktad till `netstandard2.0` PowerShell-standard.</span><span class="sxs-lookup"><span data-stu-id="24d0d-230">PSES provides concrete implementation targets for `netcoreapp2.1` to target PowerShell 6+ (since PowerShell 7's `netcoreapp3.1` runtime is backwards compatible) and `net461` to target Windows PowerShell 5.1, but contains most of its logic in a second assembly that targets `netstandard2.0` and PowerShell Standard.</span></span> <span data-ttu-id="24d0d-231">Detta gör det möjligt att hämta beroenden som krävs för .NET Core-och .NET Framework-plattformar, samtidigt som det mesta av kodbasen för en enhetlig abstraktion blir enklare.</span><span class="sxs-lookup"><span data-stu-id="24d0d-231">This allows it to pull in dependencies required for .NET Core and .NET Framework platforms, while still simplifying most of the codebase behind a uniform abstraction.</span></span>

<span data-ttu-id="24d0d-232">Eftersom den är byggd för PowerShell-standarden kräver PSES en körnings implementering av PowerShell för att testas korrekt.</span><span class="sxs-lookup"><span data-stu-id="24d0d-232">Because it is built against PowerShell Standard, PSES requires a runtime implementation of PowerShell in order to be tested correctly.</span></span> <span data-ttu-id="24d0d-233">För att göra detta kan [PSES xUnit][] -tester Hämta `Microsoft.PowerShell.SDK` och `Microsoft.PowerShell.5.ReferenceAssemblies` i syfte att tillhandahålla en PowerShell-implementering i test miljön.</span><span class="sxs-lookup"><span data-stu-id="24d0d-233">To do this, [PSES's xUnit][] tests pull in `Microsoft.PowerShell.SDK` and `Microsoft.PowerShell.5.ReferenceAssemblies` in order to provide a PowerShell implementation in the test environment.</span></span>

<span data-ttu-id="24d0d-234">Som med PSReadLine har PSES inte stöd för .NET 4,6 och tidigare, men den [utför en kontroll][] vid körning innan du anropar något av API: erna som kan orsaka en krasch i de lägre .NET Framework körningarna.</span><span class="sxs-lookup"><span data-stu-id="24d0d-234">As with PSReadLine, PSES cannot support .NET 4.6 and below, but it [performs a check][] at runtime before calling any of the APIs that could cause a crash on the lower .NET Framework runtimes.</span></span>

### <a name="psscriptanalyzer"></a><span data-ttu-id="24d0d-235">PSScriptAnalyzer</span><span class="sxs-lookup"><span data-stu-id="24d0d-235">PSScriptAnalyzer</span></span>

<span data-ttu-id="24d0d-236">[PSScriptAnalyzer][], som är luddfri för PowerShell, måste vara riktade till syntaktiska element som endast introducerats i vissa versioner av PowerShell.</span><span class="sxs-lookup"><span data-stu-id="24d0d-236">[PSScriptAnalyzer][], the linter for PowerShell, must target syntactic elements only introduced in certain versions of PowerShell.</span></span> <span data-ttu-id="24d0d-237">Eftersom igenkänning av dessa syntaktiska element uppnås genom att implementera en [AstVisitor2][], går det inte att använda PowerShellStandard och implementerar även AST-besökets metoder för nyare PowerShell-syntax.</span><span class="sxs-lookup"><span data-stu-id="24d0d-237">Because recognition of these syntactic elements is accomplished by implementing an [AstVisitor2][], it's not possible to use PowerShellStandard and also implement AST visitor methods for newer PowerShell syntaxes.</span></span>

<span data-ttu-id="24d0d-238">I stället är PSScriptAnalyzer [riktad till varje PowerShell-version][] som en build-konfiguration och skapar en separat DLL för var och en av dem.</span><span class="sxs-lookup"><span data-stu-id="24d0d-238">Instead, PSScriptAnalyzer [targets each PowerShell version][] as a build configuration, and produces a separate DLL for each of them.</span></span> <span data-ttu-id="24d0d-239">Detta ökar storlek och komplexitet för byggen, men tillåter:</span><span class="sxs-lookup"><span data-stu-id="24d0d-239">This increases build size and complexity, but allows:</span></span>

- <span data-ttu-id="24d0d-240">Version – specifika API-mål</span><span class="sxs-lookup"><span data-stu-id="24d0d-240">Version-specific API targeting</span></span>
- <span data-ttu-id="24d0d-241">Versions funktioner som ska implementeras med i princip ingen körnings kostnad</span><span class="sxs-lookup"><span data-stu-id="24d0d-241">Version-specific functionality to be implemented with essentially no runtime cost</span></span>
- <span data-ttu-id="24d0d-242">Totalt stöd för Windows PowerShell hela vägen till .NET Framework 4.5.2</span><span class="sxs-lookup"><span data-stu-id="24d0d-242">Total support for Windows PowerShell all the way down to .NET Framework 4.5.2</span></span>

## <a name="summary"></a><span data-ttu-id="24d0d-243">Sammanfattning</span><span class="sxs-lookup"><span data-stu-id="24d0d-243">Summary</span></span>

<span data-ttu-id="24d0d-244">I den här artikeln har vi listat och diskuterat de NuGet-paket som är tillgängliga för mål när du implementerar ett .NET-projekt som använder PowerShell, och vilka orsaker du kan ha för att använda en över en annan.</span><span class="sxs-lookup"><span data-stu-id="24d0d-244">In this article, we've listed and discussed the NuGet packages available to target when implementing a .NET project that uses PowerShell, and the reasons you might have for using one over another.</span></span>

<span data-ttu-id="24d0d-245">Om du har hoppat över sammanfattningen är vissa breda rekommendationer:</span><span class="sxs-lookup"><span data-stu-id="24d0d-245">If you've skipped to the summary, some broad recommendations are:</span></span>

- <span data-ttu-id="24d0d-246">PowerShell- **moduler** bör kompileras mot PowerShell-standarden om de bara kräver API: er som är gemensamma för olika PowerShell-versioner.</span><span class="sxs-lookup"><span data-stu-id="24d0d-246">PowerShell **modules** should compile against PowerShell Standard if they only require APIs common to different PowerShell versions.</span></span>
- <span data-ttu-id="24d0d-247">PowerShell- **värdar och program** som behöver köra PowerShell internt bör rikta in sig på PowerShell SDK för PowerShell 6 + eller relevanta Windows PowerShell referens sammansättningar för Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="24d0d-247">PowerShell **hosts and applications** that need to run PowerShell internally should target the PowerShell SDK for PowerShell 6+ or the relevant Windows PowerShell reference assemblies for Windows PowerShell.</span></span>
- <span data-ttu-id="24d0d-248">PowerShell-moduler som behöver **versions specifika API: er** bör rikta in sig på referens sammansättningarna för PowerShell SDK eller Windows PowerShell för de nödvändiga PowerShell-versionerna, med hjälp av dem som referens sammansättningar (det vill säga inte publicera PowerShell-beroenden).</span><span class="sxs-lookup"><span data-stu-id="24d0d-248">PowerShell modules that need **version-specific APIs** should target the PowerShell SDK or Windows PowerShell reference assemblies for the required PowerShell versions, using them as reference assemblies (that is, not publishing the PowerShell dependencies).</span></span>

<!--link references -->

[.NET standard 2,0]: /dotnet/standard/net-standard
[.NET Standard 2.0]: /dotnet/standard/net-standard
[about_Modules]: /powershell/module/microsoft.powershell.core/about/about_modules
[Lägg till typ]: /powershell/module/microsoft.powershell.utility/add-type
[Add-Type]: /powershell/module/microsoft.powershell.utility/add-type
[AstVisitor2]: /dotnet/api/system.management.automation.language.astvisitor2
[CmdletProvider]: /dotnet/api/system.management.automation.provider.cmdletprovider
[CreateDefault2]: /dotnet/api/system.management.automation.runspaces.initialsessionstate.createdefault2
[CSPROJ]: https://github.com/PowerShell/PSReadLine/blob/master/PSReadLine/PSReadLine.csproj
[csproj]: https://github.com/PowerShell/PSReadLine/blob/master/PSReadLine/PSReadLine.csproj
[Microsoft. PowerShell. SDK]: https://www.nuget.org/packages/Microsoft.PowerShell.SDK/
[Microsoft.PowerShell.SDK]: https://www.nuget.org/packages/Microsoft.PowerShell.SDK/
[Netstandard. Library]: https://www.nuget.org/packages/NETStandard.Library/
[NETStandard.Library]: https://www.nuget.org/packages/NETStandard.Library/
[NuGet]: https://www.nuget.org/
[utför en kontroll]: https://github.com/PowerShell/PowerShellEditorServices/blob/8c500ee1752201d3c1cc2e5d90f1a2af3b1eb15d/src/PowerShellEditorServices.Hosting/EditorServicesLoader.cs#L231-L251
[performs a check]: https://github.com/PowerShell/PowerShellEditorServices/blob/8c500ee1752201d3c1cc2e5d90f1a2af3b1eb15d/src/PowerShellEditorServices.Hosting/EditorServicesLoader.cs#L231-L251
[Pester]: https://github.com/Pester/Pester
[PowerShell-redigerare-tjänster]: https://github.com/PowerShell/PowerShellEditorServices/
[PowerShell Editor Services]: https://github.com/PowerShell/PowerShellEditorServices/
[PowerShell-tillägg]: https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell
[PowerShell extension]: https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell
[PowerShell-NuGet]: https://www.nuget.org/packages/PowerShell/
[PowerShell NuGet]: https://www.nuget.org/packages/PowerShell/
[PowerShell standard-lagringsplats]: https://github.com/PowerShell/PowerShellStandard
[PowerShell Standard repository]: https://github.com/PowerShell/PowerShellStandard
[PowerShellStandard. Library]: https://www.nuget.org/packages/PowerShellStandard.Library/
[PowerShellStandard.Library]: https://www.nuget.org/packages/PowerShellStandard.Library/
[PSCmdlet]: /dotnet/api/system.management.automation.pscmdlet
[PSES-xUnit]: https://github.com/PowerShell/PowerShellEditorServices/blob/8c500ee1752201d3c1cc2e5d90f1a2af3b1eb15d/test/PowerShellEditorServices.Test/PowerShellEditorServices.Test.csproj#L15-L20
[PSES's xUnit]: https://github.com/PowerShell/PowerShellEditorServices/blob/8c500ee1752201d3c1cc2e5d90f1a2af3b1eb15d/test/PowerShellEditorServices.Test/PowerShellEditorServices.Test.csproj#L15-L20
[PSHost]: /dotnet/api/system.management.automation.host.pshost
[PrivateAssets-attribut]: /dotnet/core/tools/csproj#packagereference
[PrivateAssets attribute]: /dotnet/core/tools/csproj#packagereference
[PSReadLine]: https://github.com/PowerShell/PSReadLine
[PSScriptAnalyzer]: https://github.com/powershell/psscriptanalyzer
[referens sammansättningar]: https://github.com/dotnet/standard/blob/master/docs/history/evolution-of-design-time-assemblies.md#definitions
[reference assemblies]: https://github.com/dotnet/standard/blob/master/docs/history/evolution-of-design-time-assemblies.md#definitions
[Start – jobb]: /powershell/module/microsoft.powershell.core/start-job
[Start-Job]: /powershell/module/microsoft.powershell.core/start-job
[System. Management. Automation]: https://www.nuget.org/packages/System.Management.Automation/
[System.Management.Automation]: https://www.nuget.org/packages/System.Management.Automation/
[riktar mot varje PowerShell-version]: https://github.com/PowerShell/PSScriptAnalyzer/blob/master/Engine/Engine.csproj
[targets each PowerShell version]: https://github.com/PowerShell/PSScriptAnalyzer/blob/master/Engine/Engine.csproj
[blogginlägget]: https://devblogs.microsoft.com/powershell/powershell-standard-library-build-single-module-that-works-across-windows-powershell-and-powershell-core/
[this blog post]: https://devblogs.microsoft.com/powershell/powershell-standard-library-build-single-module-that-works-across-windows-powershell-and-powershell-core/
[Visual Studio Code]: https://code.visualstudio.com/
[Windows PowerShell SDK]: /powershell/scripting/developer/windows-powershell

---
title: Skapa en grundläggande Windows PowerShell-Provider | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- base provider [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], base provider
ms.assetid: 11eeea41-15c8-47ad-9016-0f4b72573305
caps.latest.revision: 7
ms.openlocfilehash: e825581b96f0f33893b38f9f6499dd46a7bf38eb
ms.sourcegitcommit: debd2b38fb8070a7357bf1a4bf9cc736f3702f31
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 12/05/2019
ms.locfileid: "72352782"
---
# <a name="creating-a-basic-windows-powershell-provider"></a><span data-ttu-id="8efec-102">Skapa en grundläggande Windows PowerShell-provider</span><span class="sxs-lookup"><span data-stu-id="8efec-102">Creating a Basic Windows PowerShell Provider</span></span>

<span data-ttu-id="8efec-103">Det här avsnittet är start punkten för att lära dig hur du skapar en Windows PowerShell-Provider.</span><span class="sxs-lookup"><span data-stu-id="8efec-103">This topic is the starting point for learning how to create a Windows PowerShell provider.</span></span> <span data-ttu-id="8efec-104">Den grundläggande providern som beskrivs här innehåller metoder för att starta och stoppa providern, men även om denna provider inte ger ett sätt att komma åt ett data lager eller för att hämta eller ange data i data lagret, innehåller den de grundläggande funktioner som krävs av alla leverantörer.</span><span class="sxs-lookup"><span data-stu-id="8efec-104">The basic provider described here provides methods for starting and stopping the provider, and although this provider does not provide a means to access a data store or to get or set the data in the data store, it does provide the basic functionality that is required by all providers.</span></span>

<span data-ttu-id="8efec-105">Som tidigare nämnts är den grundläggande providern som beskrivs här implementerar metoder för att starta och stoppa providern.</span><span class="sxs-lookup"><span data-stu-id="8efec-105">As mentioned previously, the basic provider described here implements methods for starting and stopping the provider.</span></span> <span data-ttu-id="8efec-106">Windows PowerShell-körningen anropar dessa metoder för att initiera och avinitiera providern.</span><span class="sxs-lookup"><span data-stu-id="8efec-106">The Windows PowerShell runtime calls these methods to initialize and uninitialize the provider.</span></span>

> [!NOTE]
> <span data-ttu-id="8efec-107">Du hittar ett exempel på denna provider i AccessDBSampleProvider01.cs-filen från Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="8efec-107">You can find a sample of this provider in the AccessDBSampleProvider01.cs file provided by Windows PowerShell.</span></span>

## <a name="defining-the-windows-powershell-provider-class"></a><span data-ttu-id="8efec-108">Definiera klassen Windows PowerShell-Provider</span><span class="sxs-lookup"><span data-stu-id="8efec-108">Defining the Windows PowerShell Provider Class</span></span>

<span data-ttu-id="8efec-109">Det första steget i att skapa en Windows PowerShell-Provider är att definiera dess .NET-klass.</span><span class="sxs-lookup"><span data-stu-id="8efec-109">The first step in creating a Windows PowerShell provider is to define its .NET class.</span></span> <span data-ttu-id="8efec-110">Den här grundläggande providern definierar en klass med namnet `AccessDBProvider` som härleds från Bask Lassen [system. Management. Automation. Provider. Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="8efec-110">This basic provider defines a class called `AccessDBProvider` that derives from the [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class.</span></span>

<span data-ttu-id="8efec-111">Vi rekommenderar att du placerar leverantörs klasserna i en `Providers` namnrymd för API-namnrymden, till exempel xxx. PowerShell. providers.</span><span class="sxs-lookup"><span data-stu-id="8efec-111">It is recommended that you place your provider classes in a `Providers` namespace of your API namespace, for example, xxx.PowerShell.Providers.</span></span> <span data-ttu-id="8efec-112">Den här providern använder `Microsoft.Samples.PowerShell.Provider` namn området där alla exempel för Windows PowerShell-Provider körs.</span><span class="sxs-lookup"><span data-stu-id="8efec-112">This provider uses the `Microsoft.Samples.PowerShell.Provider` namespace, in which all Windows PowerShell provider samples run.</span></span>

> [!NOTE]
> <span data-ttu-id="8efec-113">Klassen för en Windows PowerShell-Provider måste markeras som offentlig.</span><span class="sxs-lookup"><span data-stu-id="8efec-113">The class for a Windows PowerShell provider must be explicitly marked as public.</span></span> <span data-ttu-id="8efec-114">Klasser som inte är markerade som offentliga kommer att standardvärdet internt och hittas inte av Windows PowerShell-körningsmiljön.</span><span class="sxs-lookup"><span data-stu-id="8efec-114">Classes not marked as public will default to internal and will not be found by the Windows PowerShell runtime.</span></span>

<span data-ttu-id="8efec-115">Här är klass definitionen för den här grundläggande providern:</span><span class="sxs-lookup"><span data-stu-id="8efec-115">Here is the class definition for this basic provider:</span></span>

[!code-csharp[AccessDBProviderSample01.cs](../../../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample01/AccessDBProviderSample01.cs#L23-L24 "AccessDBProviderSample01.cs")]

<span data-ttu-id="8efec-116">Precis som i klass definitionen måste du deklarera attributet [system. Management. Automation. Provider. Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) med syntaxen [CmdletProvider ()].</span><span class="sxs-lookup"><span data-stu-id="8efec-116">Right before the class definition, you must declare the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute, with the syntax [CmdletProvider()].</span></span>

<span data-ttu-id="8efec-117">Du kan ange nyckelord för attribut för att ytterligare deklarera klassen om det behövs.</span><span class="sxs-lookup"><span data-stu-id="8efec-117">You can set attribute keywords to further declare the class if necessary.</span></span> <span data-ttu-id="8efec-118">Observera att attributet [system. Management. Automation. Provider. Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) som deklareras här inkluderar två parametrar.</span><span class="sxs-lookup"><span data-stu-id="8efec-118">Notice that the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute declared here includes two parameters.</span></span> <span data-ttu-id="8efec-119">Den första parametern för attributet anger standardvänliga namn för providern, som användaren kan ändra senare.</span><span class="sxs-lookup"><span data-stu-id="8efec-119">The first attribute parameter specifies the default-friendly name for the provider, which the user can modify later.</span></span> <span data-ttu-id="8efec-120">Den andra parametern anger de Windows PowerShell-definierade funktioner som providern exponerar för Windows PowerShell-körningsmiljön under kommando bearbetning.</span><span class="sxs-lookup"><span data-stu-id="8efec-120">The second parameter specifies the Windows PowerShell-defined capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="8efec-121">Möjliga värden för providerns funktioner definieras av [system. Management. Automation. Provider. ProviderCapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) -uppräkningen.</span><span class="sxs-lookup"><span data-stu-id="8efec-121">The possible values for the provider capabilities are defined by the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="8efec-122">Eftersom det här är en bas leverantör stöder den inte några funktioner.</span><span class="sxs-lookup"><span data-stu-id="8efec-122">Because this is a base provider, it supports no capabilities.</span></span>

> [!NOTE]
> <span data-ttu-id="8efec-123">Det fullständigt kvalificerade namnet för Windows PowerShell-providern innehåller sammansättnings namnet och andra attribut som fastställs av Windows PowerShell vid registreringen av providern.</span><span class="sxs-lookup"><span data-stu-id="8efec-123">The fully qualified name of the Windows PowerShell provider includes the assembly name and other attributes determined by Windows PowerShell upon registration of the provider.</span></span>

## <a name="defining-provider-specific-state-information"></a><span data-ttu-id="8efec-124">Definiera leverantörsspecifik statusinformation</span><span class="sxs-lookup"><span data-stu-id="8efec-124">Defining Provider-Specific State Information</span></span>

<span data-ttu-id="8efec-125">Bask Lassen [system. Management. Automation. Provider. Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) och alla härledda klasser betraktas som tillstånds lösa eftersom Windows PowerShell-körningsmiljön endast skapar Provider-instanser som obligatoriska.</span><span class="sxs-lookup"><span data-stu-id="8efec-125">The [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class and all derived classes are considered stateless because the Windows PowerShell runtime creates provider instances only as required.</span></span> <span data-ttu-id="8efec-126">Om din Provider kräver fullständig kontroll och tillstånds underhåll för providerspecifika data, måste det därför härleda en klass från klassen [system. Management. Automation. providerInfo](/dotnet/api/System.Management.Automation.ProviderInfo) .</span><span class="sxs-lookup"><span data-stu-id="8efec-126">Therefore, if your provider requires full control and state maintenance for provider-specific data, it must derive a class from the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) class.</span></span> <span data-ttu-id="8efec-127">Den härledda klassen bör definiera de medlemmar som krävs för att upprätthålla statusen så att de providerspecifika data kan nås när Windows PowerShell-körningen anropar metoden [system. Management. Automation. Provider. Cmdletprovider. start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) för att initiera providern.</span><span class="sxs-lookup"><span data-stu-id="8efec-127">Your derived class should define the members necessary to maintain the state so that the provider-specific data can be accessed when the Windows PowerShell runtime calls the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method to initialize the provider.</span></span>

<span data-ttu-id="8efec-128">En Windows PowerShell-Provider kan också upprätthålla anslutnings-baserad status.</span><span class="sxs-lookup"><span data-stu-id="8efec-128">A Windows PowerShell provider can also maintain connection-based state.</span></span> <span data-ttu-id="8efec-129">Mer information om hur du upprätthåller anslutnings status finns i [skapa en PowerShell-enhets leverantör](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="8efec-129">For more information about maintaining connection state, see [Creating a PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

## <a name="initializing-the-provider"></a><span data-ttu-id="8efec-130">Providern initieras</span><span class="sxs-lookup"><span data-stu-id="8efec-130">Initializing the Provider</span></span>

<span data-ttu-id="8efec-131">För att initiera providern anropar Windows PowerShell-körningen [system. Management. Automation. Provider. Cmdletprovider. start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) metoden när Windows PowerShell startas.</span><span class="sxs-lookup"><span data-stu-id="8efec-131">To initialize the provider, the Windows PowerShell runtime calls the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method when Windows PowerShell is started.</span></span> <span data-ttu-id="8efec-132">För det mesta kan leverantören använda standard implementeringen av den här metoden, som bara returnerar objektet [system. Management. Automation. providerInfo](/dotnet/api/System.Management.Automation.ProviderInfo) som beskriver din Provider.</span><span class="sxs-lookup"><span data-stu-id="8efec-132">For the most part, your provider can use the default implementation of this method, which simply returns the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that describes your provider.</span></span> <span data-ttu-id="8efec-133">Men om du vill lägga till ytterligare initierings information bör du implementera en egen [system. Management. Automation. Provider. Cmdletprovider. start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) -metod som returnerar en modifierad version av [system. Management. Automation. providerInfo](/dotnet/api/System.Management.Automation.ProviderInfo) -objektet som skickas till din Provider.</span><span class="sxs-lookup"><span data-stu-id="8efec-133">However, in the case where you want to add additional initialization information, you should implement your own [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method that returns a modified version of the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that is passed to your provider.</span></span> <span data-ttu-id="8efec-134">I allmänhet bör den här metoden returnera det tillhandahållna [system. Management. Automation. providerInfo](/dotnet/api/System.Management.Automation.ProviderInfo) -objektet som skickas till det eller ett ändrat [system. Management. Automation. providerInfo](/dotnet/api/System.Management.Automation.ProviderInfo) -objekt som innehåller annan initierings information.</span><span class="sxs-lookup"><span data-stu-id="8efec-134">In general, this method should return the provided [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object passed to it or a modified [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that contains other initialization information.</span></span>

<span data-ttu-id="8efec-135">Den här grundläggande providern åsidosätter inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="8efec-135">This basic provider does not override this method.</span></span> <span data-ttu-id="8efec-136">Följande kod visar dock standard implementeringen av den här metoden:</span><span class="sxs-lookup"><span data-stu-id="8efec-136">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderStart](Msh_samplesaccessdbprov01#accessdbprov01ProviderStart)]  -->

<span data-ttu-id="8efec-137">Providern kan underhålla den aktuella providerspecifika informationen enligt beskrivningen i [definiera providerspecifika data tillstånd](#defining-provider-specific-state-information).</span><span class="sxs-lookup"><span data-stu-id="8efec-137">The provider can maintain the state of provider-specific information as described in [Defining Provider-specific Data State](#defining-provider-specific-state-information).</span></span> <span data-ttu-id="8efec-138">I så fall måste din implementering åsidosätta metoden [system. Management. Automation. Provider. Cmdletprovider. start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) för att returnera en instans av den härledda klassen.</span><span class="sxs-lookup"><span data-stu-id="8efec-138">In this case, your implementation must override the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method to return an instance of the derived class.</span></span>

## <a name="start-dynamic-parameters"></a><span data-ttu-id="8efec-139">Starta dynamiska parametrar</span><span class="sxs-lookup"><span data-stu-id="8efec-139">Start Dynamic Parameters</span></span>

<span data-ttu-id="8efec-140">Din leverantörs implementering av metoden [system. Management. Automation. Provider. Cmdletprovider. start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) kan kräva ytterligare parametrar.</span><span class="sxs-lookup"><span data-stu-id="8efec-140">Your provider implementation of the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method might require additional parameters.</span></span> <span data-ttu-id="8efec-141">I det här fallet bör providern åsidosätta metoden [system. Management. Automation. Provider. Cmdletprovider. Startdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.StartDynamicParameters) och returnera ett objekt som har egenskaper och fält med parsande attribut som liknar en cmdlet-klass eller ett [system. Management. Automation. Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) -objekt.</span><span class="sxs-lookup"><span data-stu-id="8efec-141">In this case, the provider should override the [System.Management.Automation.Provider.Cmdletprovider.Startdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.StartDynamicParameters) method and return an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span>

<span data-ttu-id="8efec-142">Den här grundläggande providern åsidosätter inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="8efec-142">This basic provider does not override this method.</span></span> <span data-ttu-id="8efec-143">Följande kod visar dock standard implementeringen av den här metoden:</span><span class="sxs-lookup"><span data-stu-id="8efec-143">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderDynamicParameters](Msh_samplesaccessdbprov01#accessdbprov01ProviderDynamicParameters)]  -->

## <a name="uninitializing-the-provider"></a><span data-ttu-id="8efec-144">Providern initieras</span><span class="sxs-lookup"><span data-stu-id="8efec-144">Uninitializing the Provider</span></span>

<span data-ttu-id="8efec-145">Om du vill frigöra resurser som Windows PowerShell-providern använder bör leverantören implementera sin egen [system. Management. Automation. Provider. Cmdletprovider. stop \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Stop) -metod.</span><span class="sxs-lookup"><span data-stu-id="8efec-145">To free resources that the Windows PowerShell provider uses, your provider should implement its own [System.Management.Automation.Provider.Cmdletprovider.Stop\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Stop) method.</span></span> <span data-ttu-id="8efec-146">Den här metoden anropas av Windows PowerShell-körningsmiljön för att avinitiera providern i slutet av en session.</span><span class="sxs-lookup"><span data-stu-id="8efec-146">This method is called by the Windows PowerShell runtime to uninitialize the provider at the close of a session.</span></span>

<span data-ttu-id="8efec-147">Den här grundläggande providern åsidosätter inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="8efec-147">This basic provider does not override this method.</span></span> <span data-ttu-id="8efec-148">Följande kod visar dock standard implementeringen av den här metoden:</span><span class="sxs-lookup"><span data-stu-id="8efec-148">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderStop](Msh_samplesaccessdbprov01#accessdbprov01ProviderStop)]  -->

## <a name="code-sample"></a><span data-ttu-id="8efec-149">Kod exempel</span><span class="sxs-lookup"><span data-stu-id="8efec-149">Code Sample</span></span>

<span data-ttu-id="8efec-150">Fullständig exempel kod finns i [kod exemplet för AccessDbProviderSample01](./accessdbprovidersample01-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="8efec-150">For complete sample code, see [AccessDbProviderSample01 Code Sample](./accessdbprovidersample01-code-sample.md).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="8efec-151">Testa Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="8efec-151">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="8efec-152">När din Windows PowerShell-provider har registrerats med Windows PowerShell kan du testa den genom att köra cmdlets som stöds på kommando raden.</span><span class="sxs-lookup"><span data-stu-id="8efec-152">Once your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="8efec-153">För den här grundläggande providern kör du det nya gränssnittet och använder `Get-PSProvider`-cmdlet: en för att hämta listan över leverantörer och se till att AccessDb-providern finns.</span><span class="sxs-lookup"><span data-stu-id="8efec-153">For this basic provider, run the new shell and use the `Get-PSProvider` cmdlet to retrieve the list of providers and ensure that the AccessDb provider is present.</span></span>

```powershell
Get-PSProvider
```

<span data-ttu-id="8efec-154">Följande utdata visas:</span><span class="sxs-lookup"><span data-stu-id="8efec-154">The following output appears:</span></span>

```output
Name                 Capabilities                  Drives
----                 ------------                  ------
AccessDb             None                          {}
Alias                ShouldProcess                 {Alias}
Environment          ShouldProcess                 {Env}
FileSystem           Filter, ShouldProcess         {C, Z}
Function             ShouldProcess                 {function}
Registry             ShouldProcess                 {HKLM, HKCU}
```

## <a name="see-also"></a><span data-ttu-id="8efec-155">Se även</span><span class="sxs-lookup"><span data-stu-id="8efec-155">See Also</span></span>

[<span data-ttu-id="8efec-156">Skapa Windows PowerShell-leverantörer</span><span class="sxs-lookup"><span data-stu-id="8efec-156">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="8efec-157">Designa din Windows PowerShell-Provider</span><span class="sxs-lookup"><span data-stu-id="8efec-157">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)

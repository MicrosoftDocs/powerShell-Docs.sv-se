---
ms.date: 09/13/2016
ms.topic: reference
title: Skapa en Windows PowerShell-containerprovider
description: Skapa en Windows PowerShell-containerprovider
ms.openlocfilehash: 999bd69e3c16bfc0a74519986654ec15bbc0da6d
ms.sourcegitcommit: 488a940c7c828820b36a6ba56c119f64614afc29
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/27/2020
ms.locfileid: "92645362"
---
# <a name="creating-a-windows-powershell-container-provider"></a><span data-ttu-id="03e0c-103">Skapa en Windows PowerShell-containerprovider</span><span class="sxs-lookup"><span data-stu-id="03e0c-103">Creating a Windows PowerShell Container Provider</span></span>

<span data-ttu-id="03e0c-104">I det här avsnittet beskrivs hur du skapar en Windows PowerShell-provider som kan arbeta med data lager i flera lager.</span><span class="sxs-lookup"><span data-stu-id="03e0c-104">This topic describes how to create a Windows PowerShell provider that can work on multi-layer data stores.</span></span> <span data-ttu-id="03e0c-105">För den här typen av data lager innehåller lagrings platsen på den högsta nivån rot objekten och varje efterföljande nivå kallas nod för underordnade objekt.</span><span class="sxs-lookup"><span data-stu-id="03e0c-105">For this type of data store, the top level of the store contains the root items and each subsequent level is referred to as a node of child items.</span></span> <span data-ttu-id="03e0c-106">Genom att tillåta att användaren arbetar på dessa underordnade noder kan en användare interagera hierarkiskt via data lagret.</span><span class="sxs-lookup"><span data-stu-id="03e0c-106">By allowing the user to work on these child nodes, a user can interact hierarchically through the data store.</span></span>

<span data-ttu-id="03e0c-107">Leverantörer som kan arbeta med data lager på flera nivåer kallas Windows PowerShell container providers.</span><span class="sxs-lookup"><span data-stu-id="03e0c-107">Providers that can work on multi-level data stores are referred to as Windows PowerShell container providers.</span></span> <span data-ttu-id="03e0c-108">Tänk dock på att en Windows PowerShell container-Provider bara kan användas när det finns en behållare (inga kapslade behållare) med objekten i den.</span><span class="sxs-lookup"><span data-stu-id="03e0c-108">However, be aware that a Windows PowerShell container provider can be used only when there is one container (no nested containers) with items in it.</span></span> <span data-ttu-id="03e0c-109">Om det finns kapslade behållare måste du implementera en Windows PowerShell-navigerings-Provider.</span><span class="sxs-lookup"><span data-stu-id="03e0c-109">If there are nested containers, then you must implement a Windows PowerShell navigation provider.</span></span> <span data-ttu-id="03e0c-110">Mer information om hur du implementerar Windows PowerShell-navigerings-providern finns i [skapa en Windows PowerShell-navigerings leverantör](./creating-a-windows-powershell-navigation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="03e0c-110">For more information about implementing Windows PowerShell navigation provider, see [Creating a Windows PowerShell Navigation Provider](./creating-a-windows-powershell-navigation-provider.md).</span></span>

> [!NOTE]
> <span data-ttu-id="03e0c-111">Du kan hämta C#-källfilen (AccessDBSampleProvider04.cs) för den här providern med hjälp av Microsoft Windows Software Development Kit för Windows Vista och .NET Framework 3,0 Runtime-komponenter.</span><span class="sxs-lookup"><span data-stu-id="03e0c-111">You can download the C# source file (AccessDBSampleProvider04.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="03e0c-112">Instruktioner för hämtning finns i [Installera Windows PowerShell och ladda ned Windows POWERSHELL SDK](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="03e0c-112">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="03e0c-113">De hämtade källfilerna är tillgängliga i **\<PowerShell Samples>** katalogen.</span><span class="sxs-lookup"><span data-stu-id="03e0c-113">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span> <span data-ttu-id="03e0c-114">Mer information om implementeringar av andra Windows PowerShell-leverantörer finns i [utforma din Windows PowerShell-Provider](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="03e0c-114">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="03e0c-115">Windows PowerShell container-providern som beskrivs här definierar databasen som dess enda behållare, med tabeller och rader i databasen som definierats som objekt i behållaren.</span><span class="sxs-lookup"><span data-stu-id="03e0c-115">The Windows PowerShell container provider described here defines the database as its single container, with the tables and rows of the database defined as items of the container.</span></span>

> [!CAUTION]
> <span data-ttu-id="03e0c-116">Tänk på att den här designen förutsätter en databas som har ett fält med namn-ID, och att fält typen är LongInteger.</span><span class="sxs-lookup"><span data-stu-id="03e0c-116">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

## <a name="defining-a-windows-powershell-container-provider-class"></a><span data-ttu-id="03e0c-117">Definiera en klass för Windows PowerShell container Provider</span><span class="sxs-lookup"><span data-stu-id="03e0c-117">Defining a Windows PowerShell Container Provider Class</span></span>

<span data-ttu-id="03e0c-118">En Windows PowerShell container-Provider måste definiera en .NET-klass som är härledd från Bask Lassen [system. Management. Automation. Provider. Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="03e0c-118">A Windows PowerShell container provider must define a .NET class that derives from the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="03e0c-119">Här är klass definitionen för Windows PowerShell container-providern som beskrivs i det här avsnittet.</span><span class="sxs-lookup"><span data-stu-id="03e0c-119">Here is the class definition for the Windows PowerShell container provider described in this section.</span></span>

```csharp
[CmdletProvider("AccessDB", ProviderCapabilities.None)]
public class AccessDBProvider : ContainerCmdletProvider
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="34-35":::

<span data-ttu-id="03e0c-120">Observera att i den här klass definitionen innehåller attributet [system. Management. Automation. Provider. Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) två parametrar.</span><span class="sxs-lookup"><span data-stu-id="03e0c-120">Notice that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="03e0c-121">Den första parametern anger ett användarvänligt namn för den provider som används av Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="03e0c-121">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="03e0c-122">Den andra parametern anger de Windows PowerShell-funktioner som providern exponerar för Windows PowerShell-körningsmiljön under kommando bearbetning.</span><span class="sxs-lookup"><span data-stu-id="03e0c-122">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="03e0c-123">Det finns inga Windows PowerShell-funktioner som har lagts till för den här providern.</span><span class="sxs-lookup"><span data-stu-id="03e0c-123">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="03e0c-124">Definiera grundläggande funktioner</span><span class="sxs-lookup"><span data-stu-id="03e0c-124">Defining Base Functionality</span></span>

<span data-ttu-id="03e0c-125">Enligt beskrivningen i [utforma din Windows PowerShell-Provider](./designing-your-windows-powershell-provider.md)härleds klassen [system. Management. Automation. Provider. Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) från flera andra klasser som tillhandahöll olika funktioner i providern.</span><span class="sxs-lookup"><span data-stu-id="03e0c-125">As described in [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="03e0c-126">En Windows PowerShell container-Provider måste därför definiera alla funktioner som tillhandahålls av dessa klasser.</span><span class="sxs-lookup"><span data-stu-id="03e0c-126">A Windows PowerShell container provider, therefore, needs to define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="03e0c-127">Om du vill implementera funktioner för att lägga till datorspecifik initierings information och släppa resurser som används av providern, se [skapa en grundläggande Windows PowerShell-Provider](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="03e0c-127">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span>
<span data-ttu-id="03e0c-128">De flesta leverantörer (inklusive providern som beskrivs här) kan dock använda standard implementeringen av den här funktionen som tillhandahålls av Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="03e0c-128">However, most providers (including the provider described here) can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="03e0c-129">För att få åtkomst till data lagret måste providern implementera metoderna i Bask Lassen [system. Management. Automation. Provider. Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="03e0c-129">To get access to the data store, the provider must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="03e0c-130">Mer information om hur du implementerar dessa metoder finns i [skapa en provider för Windows PowerShell-enheter](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="03e0c-130">For more information about implementing these methods, see [Creating an Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="03e0c-131">Om du vill ändra objekt i ett data lager, till exempel hämta, ange och rensa objekt, måste providern implementera de metoder som tillhandahålls av Bask Lassen [system. Management. Automation. Provider. Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="03e0c-131">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="03e0c-132">Mer information om hur du implementerar dessa metoder finns i [skapa en Windows PowerShell-dataprovider](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="03e0c-132">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

## <a name="retrieving-child-items"></a><span data-ttu-id="03e0c-133">Underordnade objekt hämtas</span><span class="sxs-lookup"><span data-stu-id="03e0c-133">Retrieving Child Items</span></span>

<span data-ttu-id="03e0c-134">För att hämta ett underordnat objekt, måste Windows PowerShell container Provider åsidosätta metoden [system. Management. Automation. Provider. Containercmdletprovider. Getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) för att stödja anrop från `Get-ChildItem` cmdleten.</span><span class="sxs-lookup"><span data-stu-id="03e0c-134">To retrieve a child item, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method to support calls from the `Get-ChildItem` cmdlet.</span></span> <span data-ttu-id="03e0c-135">Den här metoden hämtar underordnade objekt från data lagret och skriver dem till pipelinen som objekt.</span><span class="sxs-lookup"><span data-stu-id="03e0c-135">This method retrieves child items from the data store and writes them to the pipeline as objects.</span></span> <span data-ttu-id="03e0c-136">Om `recurse` parametern för cmdleten anges hämtar metoden alla underordnade oavsett vilken nivå de befinner sig på.</span><span class="sxs-lookup"><span data-stu-id="03e0c-136">If the `recurse` parameter of the cmdlet is specified, the method retrieves all children regardless of what level they are at.</span></span> <span data-ttu-id="03e0c-137">Om `recurse` parametern inte anges hämtar metoden bara en nivå av underordnade.</span><span class="sxs-lookup"><span data-stu-id="03e0c-137">If the `recurse` parameter is not specified, the method retrieves only a single level of children.</span></span>

<span data-ttu-id="03e0c-138">Här är implementeringen av metoden [system. Management. Automation. Provider. Containercmdletprovider. Getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) för den här providern.</span><span class="sxs-lookup"><span data-stu-id="03e0c-138">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method for this provider.</span></span> <span data-ttu-id="03e0c-139">Observera att den här metoden hämtar underordnade objekt i alla databas tabeller när sökvägen visar Access-databasen och hämtar de underordnade objekten från raderna i tabellen om sökvägen indikerar en data tabell.</span><span class="sxs-lookup"><span data-stu-id="03e0c-139">Notice that this method retrieves the child items in all database tables when the path indicates the Access database, and retrieves the child items from the rows of that table if the path indicates a data table.</span></span>

```csharp
protected override void GetChildItems(string path, bool recurse)
{
    // If path represented is a drive then the children in the path are
    // tables. Hence all tables in the drive represented will have to be
    // returned
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table, path, true);

            // if the specified item exists and recurse has been set then
            // all child items within it have to be obtained as well
            if (ItemExists(path) && recurse)
            {
                GetChildItems(path + pathSeparator + table.Name, recurse);
            }
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get the table name, row number and type of path from the
        // path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Obtain all the rows within the table
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);
            WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
        }
        else
        {
            // In this case, the path specified is not valid
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildItems
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="311-362":::

#### <a name="things-to-remember-about-implementing-getchilditems"></a><span data-ttu-id="03e0c-140">Saker att komma ihåg om att implementera GetChildItems</span><span class="sxs-lookup"><span data-stu-id="03e0c-140">Things to Remember About Implementing GetChildItems</span></span>

<span data-ttu-id="03e0c-141">Följande villkor kan gälla för din implementering av [system. Management. Automation. Provider. Containercmdletprovider. Getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="03e0c-141">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="03e0c-142">När du definierar Provider-klassen kan en Windows PowerShell container-Provider deklarera ExpandWildcards, filtrera, ta med eller undanta från, från [system. Management. Automation. Provider. ProviderCapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) -uppräkningen.</span><span class="sxs-lookup"><span data-stu-id="03e0c-142">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="03e0c-143">I dessa fall måste implementeringen av metoden [system. Management. Automation. Provider. Containercmdletprovider. Getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) se till att den sökväg som skickas till metoden uppfyller kraven för de angivna funktionerna.</span><span class="sxs-lookup"><span data-stu-id="03e0c-143">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="03e0c-144">För att göra detta ska metoden komma åt lämplig egenskap, till exempel [system. Management. Automation. Provider. Cmdletprovider. exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) och [system. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) egenskaper.</span><span class="sxs-lookup"><span data-stu-id="03e0c-144">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="03e0c-145">Implementeringen av den här metoden bör ta hänsyn till alla former av åtkomst till objektet som kan göra objektet synligt för användaren.</span><span class="sxs-lookup"><span data-stu-id="03e0c-145">The implementation of this method should take into account any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="03e0c-146">Om en användare till exempel har Skriv behörighet till en fil via fil systemets Provider (som tillhandahålls av Windows PowerShell), men inte Läs åtkomst, finns filen fortfarande och [system. Management. Automation. Provider. Itemcmdletprovider. Itemexists \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returnerar `true` .</span><span class="sxs-lookup"><span data-stu-id="03e0c-146">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="03e0c-147">Din implementering kan kräva att ett överordnat objekt kontrol leras för att se om det underordnade kan räknas upp.</span><span class="sxs-lookup"><span data-stu-id="03e0c-147">Your implementation might require the checking of a parent item to see if the child can be enumerated.</span></span>

- <span data-ttu-id="03e0c-148">När du skriver flera objekt kan metoden [system. Management. Automation. Provider. Containercmdletprovider. Getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) ta lite tid.</span><span class="sxs-lookup"><span data-stu-id="03e0c-148">When writing multiple items, the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method can take some time.</span></span> <span data-ttu-id="03e0c-149">Du kan utforma din Provider för att skriva objekt med hjälp av metoden [system. Management. Automation. Provider. Cmdletprovider. Writeitemobject \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) i taget.</span><span class="sxs-lookup"><span data-stu-id="03e0c-149">You can design your provider to write the items using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method one at a time.</span></span> <span data-ttu-id="03e0c-150">Med den här metoden visas objekten för användaren i en data ström.</span><span class="sxs-lookup"><span data-stu-id="03e0c-150">Using this technique will present the items to the user in a stream.</span></span>

- <span data-ttu-id="03e0c-151">Din implementering av [system. Management. Automation. Provider. Containercmdletprovider. Getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) ansvarar för att förhindra oändlig rekursion när det finns cirkel länkar och liknande.</span><span class="sxs-lookup"><span data-stu-id="03e0c-151">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="03e0c-152">Ett lämpligt avslutande undantag bör utsättas för att avspegla ett sådant villkor.</span><span class="sxs-lookup"><span data-stu-id="03e0c-152">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet"></a><span data-ttu-id="03e0c-153">Bifoga dynamiska parametrar till Get-ChildItem-cmdleten</span><span class="sxs-lookup"><span data-stu-id="03e0c-153">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet</span></span>

<span data-ttu-id="03e0c-154">Ibland `Get-ChildItem` kräver cmdleten som anropar [system. Management. Automation. Provider. Containercmdletprovider. Getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) ytterligare parametrar som anges dynamiskt vid körning.</span><span class="sxs-lookup"><span data-stu-id="03e0c-154">Sometimes the `Get-ChildItem` cmdlet that calls [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="03e0c-155">För att tillhandahålla dessa dynamiska parametrar måste Windows PowerShell container Provider implementera metoden [system. Management. Automation. Provider. Containercmdletprovider. Getchilditemsdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="03e0c-155">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) method.</span></span> <span data-ttu-id="03e0c-156">Den här metoden hämtar dynamiska parametrar för objektet på den angivna sökvägen och returnerar ett objekt som har egenskaper och fält med parsande attribut som liknar en cmdlet-klass eller ett [system. Management. Automation. Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) -objekt.</span><span class="sxs-lookup"><span data-stu-id="03e0c-156">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="03e0c-157">Windows PowerShell-körningsmiljön använder det returnerade objektet för att lägga till parametrarna i `Get-ChildItem` cmdleten.</span><span class="sxs-lookup"><span data-stu-id="03e0c-157">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="03e0c-158">Den här Windows PowerShell container-providern implementerar inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="03e0c-158">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="03e0c-159">Följande kod är dock standard implementeringen av den här metoden.</span><span class="sxs-lookup"><span data-stu-id="03e0c-159">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters](Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters)]  -->

## <a name="retrieving-child-item-names"></a><span data-ttu-id="03e0c-160">Hämtar underordnade objekt namn</span><span class="sxs-lookup"><span data-stu-id="03e0c-160">Retrieving Child Item Names</span></span>

<span data-ttu-id="03e0c-161">För att hämta namnen på underordnade objekt, måste Windows PowerShell container Provider åsidosätta metoden [system. Management. Automation. Provider. Containercmdletprovider. Getchildnames \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) för att stödja anrop från `Get-ChildItem` cmdleten när dess `Name` parameter har angetts.</span><span class="sxs-lookup"><span data-stu-id="03e0c-161">To retrieve the names of child items, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method to support calls from the `Get-ChildItem` cmdlet when its `Name` parameter is specified.</span></span> <span data-ttu-id="03e0c-162">Med den här metoden hämtas namnen på de underordnade objekten för den angivna sökvägen eller underordnade objekt namn för alla behållare om `returnAllContainers` parametern för cmdlet: en anges.</span><span class="sxs-lookup"><span data-stu-id="03e0c-162">This method retrieves the names of the child items for the specified path or child item names for all containers if the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="03e0c-163">Ett underordnat namn är löv delen av en sökväg.</span><span class="sxs-lookup"><span data-stu-id="03e0c-163">A child name is the leaf portion of a path.</span></span> <span data-ttu-id="03e0c-164">Till exempel är det underordnade namnet för sökvägen c:\windows\system32\abc.dll "abc.dll".</span><span class="sxs-lookup"><span data-stu-id="03e0c-164">For example, the child name for the path c:\windows\system32\abc.dll is "abc.dll".</span></span> <span data-ttu-id="03e0c-165">Det underordnade namnet för katalogen c:\Windows\System32 är "system32".</span><span class="sxs-lookup"><span data-stu-id="03e0c-165">The child name for the directory c:\windows\system32 is "system32".</span></span>

<span data-ttu-id="03e0c-166">Här är implementeringen av metoden [system. Management. Automation. Provider. Containercmdletprovider. Getchildnames \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) för den här providern.</span><span class="sxs-lookup"><span data-stu-id="03e0c-166">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method for this provider.</span></span> <span data-ttu-id="03e0c-167">Observera att metoden hämtar tabell namn om den angivna sökvägen anger åtkomst databasen (enhet) och rad nummer om sökvägen indikerar en tabell.</span><span class="sxs-lookup"><span data-stu-id="03e0c-167">Notice that the method retrieves table names if the specified path indicates the Access database (drive) and row numbers if the path indicates a table.</span></span>

```csharp
protected override void GetChildNames(string path,
                            ReturnContainers returnContainers)
{
    // If the path represented is a drive, then the child items are
    // tables. get the names of all the tables in the drive.
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table.Name, path, true);
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get type, table name and row number from path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Get all the rows in the table and then write out the
            // row numbers.
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row.RowNumber, path, false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);

            WriteItemObject(row.RowNumber, path, false);
        }
        else
        {
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildNames
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="369-411":::

#### <a name="things-to-remember-about-implementing-getchildnames"></a><span data-ttu-id="03e0c-168">Saker att komma ihåg om att implementera GetChildNames</span><span class="sxs-lookup"><span data-stu-id="03e0c-168">Things to Remember About Implementing GetChildNames</span></span>

<span data-ttu-id="03e0c-169">Följande villkor kan gälla för din implementering av [system. Management. Automation. Provider. Containercmdletprovider. Getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="03e0c-169">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="03e0c-170">När du definierar Provider-klassen kan en Windows PowerShell container-Provider deklarera ExpandWildcards, filtrera, ta med eller undanta från, från [system. Management. Automation. Provider. ProviderCapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) -uppräkningen.</span><span class="sxs-lookup"><span data-stu-id="03e0c-170">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="03e0c-171">I dessa fall måste implementeringen av metoden [system. Management. Automation. Provider. Containercmdletprovider. Getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) se till att den sökväg som skickas till metoden uppfyller kraven för de angivna funktionerna.</span><span class="sxs-lookup"><span data-stu-id="03e0c-171">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="03e0c-172">För att göra detta ska metoden komma åt lämplig egenskap, till exempel [system. Management. Automation. Provider. Cmdletprovider. exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) och [system. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) egenskaper.</span><span class="sxs-lookup"><span data-stu-id="03e0c-172">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

  > [!NOTE]
  > <span data-ttu-id="03e0c-173">Ett undantag till den här regeln inträffar när `returnAllContainers` parametern för cmdleten anges.</span><span class="sxs-lookup"><span data-stu-id="03e0c-173">An exception to this rule occurs when the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="03e0c-174">I det här fallet ska metoden hämta ett underordnat namn för en behållare, även om den inte matchar värdena i [system. Management. Automation. Provider. Cmdletprovider. filter \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [system. Management. Automation. Provider. Cmdletprovider. include](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)\*, eller [system. Management. Automation. Provider. Cmdletprovider. exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) Properties.</span><span class="sxs-lookup"><span data-stu-id="03e0c-174">In this case, the method should retrieve any child name for a container, even if it does not match the values of the [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), or [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) properties.</span></span>

- <span data-ttu-id="03e0c-175">Åsidosättningar av den här metoden bör som standard inte hämta namn på objekt som är allmänt dolda från användaren, om inte egenskapen [system. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) anges.</span><span class="sxs-lookup"><span data-stu-id="03e0c-175">By default, overrides of this method should not retrieve names of objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="03e0c-176">Om den angivna sökvägen indikerar en behållare krävs inte egenskapen [system. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) .</span><span class="sxs-lookup"><span data-stu-id="03e0c-176">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="03e0c-177">Din implementering av [system. Management. Automation. Provider. Containercmdletprovider. Getchildnames \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) ansvarar för att förhindra oändlig rekursion när det finns cirkel länkar och liknande.</span><span class="sxs-lookup"><span data-stu-id="03e0c-177">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="03e0c-178">Ett lämpligt avslutande undantag bör utsättas för att avspegla ett sådant villkor.</span><span class="sxs-lookup"><span data-stu-id="03e0c-178">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet-name"></a><span data-ttu-id="03e0c-179">Bifoga dynamiska parametrar till Get-ChildItem-cmdleten (namn)</span><span class="sxs-lookup"><span data-stu-id="03e0c-179">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet (Name)</span></span>

<span data-ttu-id="03e0c-180">Ibland `Get-ChildItem` kräver cmdleten (med `Name` parametern) ytterligare parametrar som anges dynamiskt vid körning.</span><span class="sxs-lookup"><span data-stu-id="03e0c-180">Sometimes the `Get-ChildItem` cmdlet (with the `Name` parameter) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="03e0c-181">För att tillhandahålla dessa dynamiska parametrar måste Windows PowerShell container Provider implementera metoden [system. Management. Automation. Provider. Containercmdletprovider. Getchildnamesdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="03e0c-181">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) method.</span></span> <span data-ttu-id="03e0c-182">Den här metoden hämtar dynamiska parametrar för objektet på den angivna sökvägen och returnerar ett objekt som har egenskaper och fält med parsande attribut som liknar en cmdlet-klass eller ett [system. Management. Automation. Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) -objekt.</span><span class="sxs-lookup"><span data-stu-id="03e0c-182">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="03e0c-183">Windows PowerShell-körningsmiljön använder det returnerade objektet för att lägga till parametrarna i `Get-ChildItem` cmdleten.</span><span class="sxs-lookup"><span data-stu-id="03e0c-183">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="03e0c-184">Den här providern implementerar inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="03e0c-184">This provider does not implement this method.</span></span> <span data-ttu-id="03e0c-185">Följande kod är dock standard implementeringen av den här metoden.</span><span class="sxs-lookup"><span data-stu-id="03e0c-185">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters](Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters)]  -->

## <a name="renaming-items"></a><span data-ttu-id="03e0c-186">Byta namn på objekt</span><span class="sxs-lookup"><span data-stu-id="03e0c-186">Renaming Items</span></span>

<span data-ttu-id="03e0c-187">Om du vill byta namn på ett objekt, måste en Windows PowerShell container-Provider åsidosätta metoden [system. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) för att stödja anrop från `Rename-Item` cmdleten.</span><span class="sxs-lookup"><span data-stu-id="03e0c-187">To rename an item, a Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method to support calls from the `Rename-Item` cmdlet.</span></span> <span data-ttu-id="03e0c-188">Den här metoden ändrar namnet på objektet på den angivna sökvägen till det nya namn som anges.</span><span class="sxs-lookup"><span data-stu-id="03e0c-188">This method changes the name of the item at the specified path to the new name provided.</span></span> <span data-ttu-id="03e0c-189">Det nya namnet måste alltid vara relativt till det överordnade objektet (behållaren).</span><span class="sxs-lookup"><span data-stu-id="03e0c-189">The new name must always be relative to the parent item (container).</span></span>

<span data-ttu-id="03e0c-190">Denna provider åsidosätter inte metoden [system. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) .</span><span class="sxs-lookup"><span data-stu-id="03e0c-190">This provider does not override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method.</span></span> <span data-ttu-id="03e0c-191">Följande är dock standard implementeringen.</span><span class="sxs-lookup"><span data-stu-id="03e0c-191">However, the following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitem](Msh_samplestestcmdlets#testproviderrenameitem)]  -->

#### <a name="things-to-remember-about-implementing-renameitem"></a><span data-ttu-id="03e0c-192">Saker att komma ihåg om att implementera RenameItem</span><span class="sxs-lookup"><span data-stu-id="03e0c-192">Things to Remember About Implementing RenameItem</span></span>

<span data-ttu-id="03e0c-193">Följande villkor kan gälla för din implementering av [system. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span><span class="sxs-lookup"><span data-stu-id="03e0c-193">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span></span>

- <span data-ttu-id="03e0c-194">När du definierar Provider-klassen kan en Windows PowerShell container-Provider deklarera ExpandWildcards, filtrera, ta med eller undanta från, från [system. Management. Automation. Provider. ProviderCapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) -uppräkningen.</span><span class="sxs-lookup"><span data-stu-id="03e0c-194">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="03e0c-195">I dessa fall måste implementeringen av metoden [system. Management. Automation. Provider. Containercmdletprovider. Getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) se till att den sökväg som skickas till metoden uppfyller kraven för de angivna funktionerna.</span><span class="sxs-lookup"><span data-stu-id="03e0c-195">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="03e0c-196">För att göra detta ska metoden komma åt lämplig egenskap, till exempel [system. Management. Automation. Provider. Cmdletprovider. exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) och [system. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) egenskaper.</span><span class="sxs-lookup"><span data-stu-id="03e0c-196">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="03e0c-197">Metoden [system. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) är avsedd för att ändra namnet på ett objekt och inte för flytt åtgärder.</span><span class="sxs-lookup"><span data-stu-id="03e0c-197">The [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method is intended for the modification of the name of an item only, and not for move operations.</span></span>
  <span data-ttu-id="03e0c-198">Din implementering av metoden ska skriva ett fel om `newName` parametern innehåller Sök vägs avgränsare eller om den annars kan orsaka att objektet ändrar dess överordnade plats.</span><span class="sxs-lookup"><span data-stu-id="03e0c-198">Your implementation of the method should write an error if the `newName` parameter contains path separators, or might otherwise cause the item to change its parent location.</span></span>

- <span data-ttu-id="03e0c-199">Åsidosättningar av den här metoden bör som standard inte byta namn på objekt om inte egenskapen [system. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) anges.</span><span class="sxs-lookup"><span data-stu-id="03e0c-199">By default, overrides of this method should not rename objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="03e0c-200">Om den angivna sökvägen indikerar en behållare krävs inte egenskapen [system. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) .</span><span class="sxs-lookup"><span data-stu-id="03e0c-200">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="03e0c-201">Din implementering av metoden [system. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) ska anropa [system. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) och kontrol lera dess retur värde innan du gör några ändringar i data lagret.</span><span class="sxs-lookup"><span data-stu-id="03e0c-201">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="03e0c-202">Den här metoden används för att bekräfta körning av en åtgärd när en ändring görs i system tillstånd, till exempel att byta namn på filer.</span><span class="sxs-lookup"><span data-stu-id="03e0c-202">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span>
  <span data-ttu-id="03e0c-203">[System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) skickar namnet på resursen som ska ändras till användaren, med Windows PowerShell-körningsmiljön med hänsyn till eventuella kommando rads inställningar eller variabler för att fastställa vad som ska visas.</span><span class="sxs-lookup"><span data-stu-id="03e0c-203">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="03e0c-204">Efter att anropet till [system. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returnerar `true` , ska metoden system [. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) anropa metoden [system. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) .</span><span class="sxs-lookup"><span data-stu-id="03e0c-204">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="03e0c-205">Den här metoden skickar ett meddelande till användaren för att tillåta ytterligare feedback för att säga om åtgärden bör fortsätta.</span><span class="sxs-lookup"><span data-stu-id="03e0c-205">This method sends a message a confirmation message to the user to allow additional feedback to say if the operation should be continued.</span></span> <span data-ttu-id="03e0c-206">En provider bör anropa [system. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) som ytterligare kontroll för potentiellt skadliga system ändringar.</span><span class="sxs-lookup"><span data-stu-id="03e0c-206">A provider should call [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-rename-item-cmdlet"></a><span data-ttu-id="03e0c-207">Bifoga dynamiska parametrar till Rename-Item-cmdleten</span><span class="sxs-lookup"><span data-stu-id="03e0c-207">Attaching Dynamic Parameters to the Rename-Item Cmdlet</span></span>

<span data-ttu-id="03e0c-208">Ibland `Rename-Item` kräver cmdleten ytterligare parametrar som anges dynamiskt vid körning.</span><span class="sxs-lookup"><span data-stu-id="03e0c-208">Sometimes the `Rename-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="03e0c-209">För att tillhandahålla dessa dynamiska parametrar måste Windows PowerShell container Provider implementera metoden [system. Management. Automation. Provider. Containercmdletprovider. Renameitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="03e0c-209">To provide these dynamic parameters, Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) method.</span></span> <span data-ttu-id="03e0c-210">Den här metoden hämtar parametrarna för objektet vid den angivna sökvägen och returnerar ett objekt som har egenskaper och fält med parsande attribut som liknar en cmdlet-klass eller ett [system. Management. Automation. Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) -objekt.</span><span class="sxs-lookup"><span data-stu-id="03e0c-210">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="03e0c-211">Windows PowerShell-körningsmiljön använder det returnerade objektet för att lägga till parametrarna i `Rename-Item` cmdleten.</span><span class="sxs-lookup"><span data-stu-id="03e0c-211">The Windows PowerShell runtime uses the returned object to add the parameters to the `Rename-Item` cmdlet.</span></span>

<span data-ttu-id="03e0c-212">Den här behållar leverantören implementerar inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="03e0c-212">This container provider does not implement this method.</span></span> <span data-ttu-id="03e0c-213">Följande kod är dock standard implementeringen av den här metoden.</span><span class="sxs-lookup"><span data-stu-id="03e0c-213">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters](Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters)]  -->

## <a name="creating-new-items"></a><span data-ttu-id="03e0c-214">Nya objekt skapas</span><span class="sxs-lookup"><span data-stu-id="03e0c-214">Creating New Items</span></span>

<span data-ttu-id="03e0c-215">För att kunna skapa nya objekt måste en container leverantör implementera metoden [system. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) för att stödja anrop från `New-Item` cmdleten.</span><span class="sxs-lookup"><span data-stu-id="03e0c-215">To create new items, a container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method to support calls from the `New-Item` cmdlet.</span></span> <span data-ttu-id="03e0c-216">Den här metoden skapar ett data objekt som finns på den angivna sökvägen.</span><span class="sxs-lookup"><span data-stu-id="03e0c-216">This method creates a data item located at the specified path.</span></span> <span data-ttu-id="03e0c-217">`type`Parametern för cmdleten innehåller den providertyp som definierats för det nya objektet.</span><span class="sxs-lookup"><span data-stu-id="03e0c-217">The `type` parameter of the cmdlet contains the provider-defined type for the new item.</span></span> <span data-ttu-id="03e0c-218">Till exempel använder fil Systems leverantören en `type` parameter med värdet "File" eller "Directory".</span><span class="sxs-lookup"><span data-stu-id="03e0c-218">For example, the FileSystem provider uses a `type` parameter with a value of "file" or "directory".</span></span> <span data-ttu-id="03e0c-219">`newItemValue`Parametern för cmdleten anger ett providerspecifika värde för det nya objektet.</span><span class="sxs-lookup"><span data-stu-id="03e0c-219">The `newItemValue` parameter of the cmdlet specifies a provider-specific value for the new item.</span></span>

<span data-ttu-id="03e0c-220">Här är implementeringen av metoden [system. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) för den här providern.</span><span class="sxs-lookup"><span data-stu-id="03e0c-220">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method for this provider.</span></span>

```csharp
protected override void NewItem( string path, string type, object newItemValue )
{
    // Create the new item here after
    // performing necessary validations
    //
    // WriteItemObject(newItemValue, path, false);

    // Example
    //
    // if (ShouldProcess(path, "new item"))
    // {
    //      // Create a new item and then call WriteObject
    //      WriteObject(newItemValue, path, false);
    // }

} // NewItem
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="939-955":::

#### <a name="things-to-remember-about-implementing-newitem"></a><span data-ttu-id="03e0c-221">Saker att komma ihåg om att implementera NewItem</span><span class="sxs-lookup"><span data-stu-id="03e0c-221">Things to Remember About Implementing NewItem</span></span>

<span data-ttu-id="03e0c-222">Följande villkor kan gälla för din implementering av [system. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="03e0c-222">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="03e0c-223">Metoden [system. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) måste utföra en Skift läges okänslig jämförelse av strängen som skickas i `type` parametern.</span><span class="sxs-lookup"><span data-stu-id="03e0c-223">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should perform a case-insensitive comparison of the string passed in the `type` parameter.</span></span>
  <span data-ttu-id="03e0c-224">Den bör också tillåta minst tvetydiga matchningar.</span><span class="sxs-lookup"><span data-stu-id="03e0c-224">It should also allow for least ambiguous matches.</span></span> <span data-ttu-id="03e0c-225">För typerna "File" och "Directory" krävs till exempel bara den första bokstaven i disambiguate.</span><span class="sxs-lookup"><span data-stu-id="03e0c-225">For example, for the types "file" and "directory", only the first letter is required to disambiguate.</span></span> <span data-ttu-id="03e0c-226">Om `type` parametern anger en typ som din Provider inte kan skapa, ska metoden [system. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) skriva en ArgumentException med ett meddelande som anger vilka typer som providern kan skapa.</span><span class="sxs-lookup"><span data-stu-id="03e0c-226">If the `type` parameter indicates a type your provider cannot create, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should write an ArgumentException with a message indicating the types the provider can create.</span></span>

- <span data-ttu-id="03e0c-227">För `newItemValue` -parametern rekommenderas implementeringen av metoden [system. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) för att acceptera strängarna.</span><span class="sxs-lookup"><span data-stu-id="03e0c-227">For the `newItemValue` parameter, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method is recommended to accept strings at a minimum.</span></span> <span data-ttu-id="03e0c-228">Det bör också acceptera den typ av objekt som hämtas av metoden [system. Management. Automation. Provider. Itemcmdletprovider. getItem, \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) för samma sökväg.</span><span class="sxs-lookup"><span data-stu-id="03e0c-228">It should also accept the type of object that is retrieved by the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the same path.</span></span> <span data-ttu-id="03e0c-229">Metoden [system. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) kan använda metoden [system. Management. Automation. Languageprimitives. ConvertTo \*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) för att konvertera typer till önskad typ.</span><span class="sxs-lookup"><span data-stu-id="03e0c-229">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method can use the [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) method to convert types to the desired type.</span></span>

- <span data-ttu-id="03e0c-230">Din implementering av metoden [system. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) ska anropa [system. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) och kontrol lera dess retur värde innan du gör några ändringar i data lagret.</span><span class="sxs-lookup"><span data-stu-id="03e0c-230">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="03e0c-231">Efter anropet till [system. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returnerar true, metoden [system. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) anropa metoden [system. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) som ytterligare kontroll för potentiellt skadliga system ändringar.</span><span class="sxs-lookup"><span data-stu-id="03e0c-231">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-new-item-cmdlet"></a><span data-ttu-id="03e0c-232">Bifoga dynamiska parametrar till New-Item-cmdleten</span><span class="sxs-lookup"><span data-stu-id="03e0c-232">Attaching Dynamic Parameters to the New-Item Cmdlet</span></span>

<span data-ttu-id="03e0c-233">Ibland `New-Item` kräver cmdleten ytterligare parametrar som anges dynamiskt vid körning.</span><span class="sxs-lookup"><span data-stu-id="03e0c-233">Sometimes the `New-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="03e0c-234">För att tillhandahålla dessa dynamiska parametrar måste container leverantören implementera metoden [system. Management. Automation. Provider. Containercmdletprovider. Newitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="03e0c-234">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) method.</span></span> <span data-ttu-id="03e0c-235">Den här metoden hämtar parametrarna för objektet vid den angivna sökvägen och returnerar ett objekt som har egenskaper och fält med parsande attribut som liknar en cmdlet-klass eller ett [system. Management. Automation. Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) -objekt.</span><span class="sxs-lookup"><span data-stu-id="03e0c-235">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="03e0c-236">Windows PowerShell-körningsmiljön använder det returnerade objektet för att lägga till parametrarna i `New-Item` cmdleten.</span><span class="sxs-lookup"><span data-stu-id="03e0c-236">The Windows PowerShell runtime uses the returned object to add the parameters to the `New-Item` cmdlet.</span></span>

<span data-ttu-id="03e0c-237">Den här providern implementerar inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="03e0c-237">This provider does not implement this method.</span></span> <span data-ttu-id="03e0c-238">Följande kod är dock standard implementeringen av den här metoden.</span><span class="sxs-lookup"><span data-stu-id="03e0c-238">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernewitemdynamicparameters](Msh_samplestestcmdlets#testprovidernewitemdynamicparameters)]  -->

## <a name="removing-items"></a><span data-ttu-id="03e0c-239">Tar bort objekt</span><span class="sxs-lookup"><span data-stu-id="03e0c-239">Removing Items</span></span>

<span data-ttu-id="03e0c-240">För att ta bort objekt, måste Windows PowerShell-providern åsidosätta metoden [system. Management. Automation. Provider. Containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) för att stödja anrop från `Remove-Item` cmdleten.</span><span class="sxs-lookup"><span data-stu-id="03e0c-240">To remove items, the Windows PowerShell provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method to support calls from the `Remove-Item` cmdlet.</span></span> <span data-ttu-id="03e0c-241">Den här metoden tar bort ett objekt från data lagret på den angivna sökvägen.</span><span class="sxs-lookup"><span data-stu-id="03e0c-241">This method deletes an item from the data store at the specified path.</span></span> <span data-ttu-id="03e0c-242">Om `recurse` parametern för `Remove-Item` cmdleten är inställd på `true` tar metoden bort alla underordnade objekt oavsett deras nivå.</span><span class="sxs-lookup"><span data-stu-id="03e0c-242">If the `recurse` parameter of the `Remove-Item` cmdlet is set to `true`, the method removes all child items regardless of their level.</span></span> <span data-ttu-id="03e0c-243">Om parametern är inställd på `false` , tar metoden bara bort ett enstaka objekt på den angivna sökvägen.</span><span class="sxs-lookup"><span data-stu-id="03e0c-243">If the parameter is set to `false`, the method removes only a single item at the specified path.</span></span>

<span data-ttu-id="03e0c-244">Den här providern stöder inte borttagning av objekt.</span><span class="sxs-lookup"><span data-stu-id="03e0c-244">This provider does not support item removal.</span></span> <span data-ttu-id="03e0c-245">Följande kod är dock standard implementeringen av [system. Management. Automation. Provider. Containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span><span class="sxs-lookup"><span data-stu-id="03e0c-245">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitem](Msh_samplestestcmdlets#testproviderremoveitem)]  -->

#### <a name="things-to-remember-about-implementing-removeitem"></a><span data-ttu-id="03e0c-246">Saker att komma ihåg om att implementera RemoveItem</span><span class="sxs-lookup"><span data-stu-id="03e0c-246">Things to Remember About Implementing RemoveItem</span></span>

<span data-ttu-id="03e0c-247">Följande villkor kan gälla för din implementering av [system. Management. Automation. Provider. Containercmdletprovider. NewItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="03e0c-247">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="03e0c-248">När du definierar Provider-klassen kan en Windows PowerShell container-Provider deklarera ExpandWildcards, filtrera, ta med eller undanta från, från [system. Management. Automation. Provider. ProviderCapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) -uppräkningen.</span><span class="sxs-lookup"><span data-stu-id="03e0c-248">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="03e0c-249">I dessa fall måste implementeringen av metoden [system. Management. Automation. Provider. Containercmdletprovider. Getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) se till att den sökväg som skickas till metoden uppfyller kraven för de angivna funktionerna.</span><span class="sxs-lookup"><span data-stu-id="03e0c-249">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="03e0c-250">För att göra detta ska metoden komma åt lämplig egenskap, till exempel [system. Management. Automation. Provider. Cmdletprovider. exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) och [system. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) egenskaper.</span><span class="sxs-lookup"><span data-stu-id="03e0c-250">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="03e0c-251">Åsidosättningar av den här metoden bör som standard inte ta bort objekt om inte egenskapen [system. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) anges till true.</span><span class="sxs-lookup"><span data-stu-id="03e0c-251">By default, overrides of this method should not remove objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to true.</span></span> <span data-ttu-id="03e0c-252">Om den angivna sökvägen indikerar en behållare krävs inte egenskapen [system. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) .</span><span class="sxs-lookup"><span data-stu-id="03e0c-252">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="03e0c-253">Din implementering av [system. Management. Automation. Provider. Containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) ansvarar för att förhindra oändlig rekursion när det finns cirkel länkar och liknande.</span><span class="sxs-lookup"><span data-stu-id="03e0c-253">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="03e0c-254">Ett lämpligt avslutande undantag bör utsättas för att avspegla ett sådant villkor.</span><span class="sxs-lookup"><span data-stu-id="03e0c-254">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="03e0c-255">Din implementering av metoden [system. Management. Automation. Provider. Containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) ska anropa [system. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) och kontrol lera dess retur värde innan du gör några ändringar i data lagret.</span><span class="sxs-lookup"><span data-stu-id="03e0c-255">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="03e0c-256">Efter att anropet till [system. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returnerar `true` , ska metoden system [. Management. Automation. Provider. Containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) anropa metoden [system. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) som ytterligare kontroll för potentiellt skadliga system ändringar.</span><span class="sxs-lookup"><span data-stu-id="03e0c-256">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-remove-item-cmdlet"></a><span data-ttu-id="03e0c-257">Bifoga dynamiska parametrar till Remove-Item-cmdleten</span><span class="sxs-lookup"><span data-stu-id="03e0c-257">Attaching Dynamic Parameters to the Remove-Item Cmdlet</span></span>

<span data-ttu-id="03e0c-258">Ibland `Remove-Item` kräver cmdleten ytterligare parametrar som anges dynamiskt vid körning.</span><span class="sxs-lookup"><span data-stu-id="03e0c-258">Sometimes the `Remove-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="03e0c-259">För att tillhandahålla dessa dynamiska parametrar måste container leverantören implementera metoden [system. Management. Automation. Provider. Containercmdletprovider. Removeitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) för att hantera dessa parametrar.</span><span class="sxs-lookup"><span data-stu-id="03e0c-259">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="03e0c-260">Den här metoden hämtar dynamiska parametrar för objektet på den angivna sökvägen och returnerar ett objekt som har egenskaper och fält med parsande attribut som liknar en cmdlet-klass eller ett [system. Management. Automation. Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) -objekt.</span><span class="sxs-lookup"><span data-stu-id="03e0c-260">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="03e0c-261">Windows PowerShell-körningsmiljön använder det returnerade objektet för att lägga till parametrarna i `Remove-Item` cmdleten.</span><span class="sxs-lookup"><span data-stu-id="03e0c-261">The Windows PowerShell runtime uses the returned object to add the parameters to the `Remove-Item` cmdlet.</span></span>

<span data-ttu-id="03e0c-262">Den här behållar leverantören implementerar inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="03e0c-262">This container provider does not implement this method.</span></span> <span data-ttu-id="03e0c-263">Följande kod är dock standard implementeringen av [system. Management. Automation. Provider. Containercmdletprovider. Removeitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="03e0c-263">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters](Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters)]  -->

## <a name="querying-for-child-items"></a><span data-ttu-id="03e0c-264">Fråga efter underordnade objekt</span><span class="sxs-lookup"><span data-stu-id="03e0c-264">Querying for Child Items</span></span>

<span data-ttu-id="03e0c-265">För att kontrol lera om underordnade objekt finns på den angivna sökvägen, måste Windows PowerShell container Provider åsidosätta metoden [system. Management. Automation. Provider. Containercmdletprovider. Haschilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) .</span><span class="sxs-lookup"><span data-stu-id="03e0c-265">To check to see if child items exist at the specified path, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="03e0c-266">Den här metoden returnerar `true` om objektet har underordnade objekt och `false` annars.</span><span class="sxs-lookup"><span data-stu-id="03e0c-266">This method returns `true` if the item has children, and `false` otherwise.</span></span> <span data-ttu-id="03e0c-267">För en sökväg som är null eller tom anses metoden alla objekt i data lagret vara underordnade och returnerade `true` .</span><span class="sxs-lookup"><span data-stu-id="03e0c-267">For a null or empty path, the method considers any items in the data store to be children and returns `true`.</span></span>

<span data-ttu-id="03e0c-268">Här är åsidosättningen för metoden [system. Management. Automation. Provider. Containercmdletprovider. Haschilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) .</span><span class="sxs-lookup"><span data-stu-id="03e0c-268">Here is the override for the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="03e0c-269">Om det finns fler än två Sök vägs delar som skapats av ChunkPath Helper-metoden returnerar metoden `false` , eftersom endast en databas behållare och en tabell behållare definieras.</span><span class="sxs-lookup"><span data-stu-id="03e0c-269">If there are more than two path parts created by the ChunkPath helper method, the method returns `false`, since only a database container and a table container are defined.</span></span> <span data-ttu-id="03e0c-270">Mer information om den här hjälp metoden finns i ChunkPath-metoden beskrivs i [skapa en Windows PowerShell-dataprovider](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="03e0c-270">For more information about this helper method, see the ChunkPath method is discussed in [Creating a Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

```csharp
protected override bool HasChildItems( string path )
{
    return false;
} // HasChildItems
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="1094-1097":::

#### <a name="things-to-remember-about-implementing-haschilditems"></a><span data-ttu-id="03e0c-271">Saker att komma ihåg om att implementera HasChildItems</span><span class="sxs-lookup"><span data-stu-id="03e0c-271">Things to Remember About Implementing HasChildItems</span></span>

<span data-ttu-id="03e0c-272">Följande villkor kan gälla för din implementering av [system. Management. Automation. Provider. Containercmdletprovider. Haschilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span><span class="sxs-lookup"><span data-stu-id="03e0c-272">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span></span>

- <span data-ttu-id="03e0c-273">Om behållar leverantören exponerar en rot som innehåller intressanta monterings punkter ska implementeringen av metoden [system. Management. Automation. Provider. Containercmdletprovider. Haschilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) returnera `true` när ett null-värde eller en tom sträng skickas in för sökvägen.</span><span class="sxs-lookup"><span data-stu-id="03e0c-273">If the container provider exposes a root that contains interesting mount points, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method should return `true` when a null or an empty string is passed in for the path.</span></span>

## <a name="copying-items"></a><span data-ttu-id="03e0c-274">Objekt kopieras</span><span class="sxs-lookup"><span data-stu-id="03e0c-274">Copying Items</span></span>

<span data-ttu-id="03e0c-275">För att kunna kopiera objekt måste container leverantören implementera metoden [system. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) för att stödja anrop från `Copy-Item` cmdleten.</span><span class="sxs-lookup"><span data-stu-id="03e0c-275">To copy items, the container provider must implement the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method to support calls from the `Copy-Item` cmdlet.</span></span> <span data-ttu-id="03e0c-276">Den här metoden kopierar ett data objekt från den plats som anges av `path` parametern för cmdleten till den plats som anges av `copyPath` parametern.</span><span class="sxs-lookup"><span data-stu-id="03e0c-276">This method copies a data item from the location indicated by the `path` parameter of the cmdlet to the location indicated by the `copyPath` parameter.</span></span> <span data-ttu-id="03e0c-277">Om `recurse` parametern har angetts kopierar metoden alla under behållare.</span><span class="sxs-lookup"><span data-stu-id="03e0c-277">If the `recurse` parameter is specified, the method copies all sub-containers.</span></span> <span data-ttu-id="03e0c-278">Om parametern inte anges kopierar metoden bara en nivå av objekt.</span><span class="sxs-lookup"><span data-stu-id="03e0c-278">If the parameter is not specified, the method copies only a single level of items.</span></span>

<span data-ttu-id="03e0c-279">Den här providern implementerar inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="03e0c-279">This provider does not implement this method.</span></span> <span data-ttu-id="03e0c-280">Följande kod är dock standard implementeringen av [system. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span><span class="sxs-lookup"><span data-stu-id="03e0c-280">However, the following code is the default implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitem](Msh_samplestestcmdlets#testprovidercopyitem)]  -->

#### <a name="things-to-remember-about-implementing-copyitem"></a><span data-ttu-id="03e0c-281">Saker att komma ihåg om att implementera CopyItem</span><span class="sxs-lookup"><span data-stu-id="03e0c-281">Things to Remember About Implementing CopyItem</span></span>

<span data-ttu-id="03e0c-282">Följande villkor kan gälla för din implementering av [system. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span><span class="sxs-lookup"><span data-stu-id="03e0c-282">The following conditions may apply to your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span></span>

- <span data-ttu-id="03e0c-283">När du definierar Provider-klassen kan en Windows PowerShell container-Provider deklarera ExpandWildcards, filtrera, ta med eller undanta från, från [system. Management. Automation. Provider. ProviderCapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) -uppräkningen.</span><span class="sxs-lookup"><span data-stu-id="03e0c-283">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="03e0c-284">I dessa fall måste implementeringen av metoden [system. Management. Automation. Provider. Containercmdletprovider. Getchilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) se till att den sökväg som skickas till metoden uppfyller kraven för de angivna funktionerna.</span><span class="sxs-lookup"><span data-stu-id="03e0c-284">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="03e0c-285">För att göra detta ska metoden komma åt lämplig egenskap, till exempel [system. Management. Automation. Provider. Cmdletprovider. exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) och [system. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) egenskaper.</span><span class="sxs-lookup"><span data-stu-id="03e0c-285">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="03e0c-286">Åsidosättningar av den här metoden bör som standard inte kopiera objekt över befintliga objekt om inte egenskapen [system. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) anges till `true` .</span><span class="sxs-lookup"><span data-stu-id="03e0c-286">By default, overrides of this method should not copy objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="03e0c-287">Till exempel kopierar inte fil systemets Provider c:\temp\abc.txt över en befintlig c:\abc.txt-fil om inte egenskapen [system. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) anges till `true` .</span><span class="sxs-lookup"><span data-stu-id="03e0c-287">For example, the FileSystem provider will not copy c:\temp\abc.txt over an existing c:\abc.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="03e0c-288">Om sökvägen som anges i `copyPath` parametern finns och indikerar en behållare, krävs inte egenskapen [system. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) .</span><span class="sxs-lookup"><span data-stu-id="03e0c-288">If the path specified in the `copyPath` parameter exists and indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="03e0c-289">I det här fallet ska [system. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) kopiera objektet som anges av `path` parametern till den behållare som anges av `copyPath` parametern som underordnad.</span><span class="sxs-lookup"><span data-stu-id="03e0c-289">In this case, [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) should copy the item indicated by the `path` parameter to the container indicated by the `copyPath` parameter as a child.</span></span>

- <span data-ttu-id="03e0c-290">Din implementering av [system. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) ansvarar för att förhindra oändlig rekursion när det finns cirkel länkar, och liknande.</span><span class="sxs-lookup"><span data-stu-id="03e0c-290">Your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="03e0c-291">Ett lämpligt avslutande undantag bör utsättas för att avspegla ett sådant villkor.</span><span class="sxs-lookup"><span data-stu-id="03e0c-291">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="03e0c-292">Din implementering av metoden [system. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) ska anropa [system. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) och kontrol lera dess retur värde innan du gör några ändringar i data lagret.</span><span class="sxs-lookup"><span data-stu-id="03e0c-292">Your implementation of the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="03e0c-293">Efter anropet till [system. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returnerar true, metoden system. Management. Automation. Provider [. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) ska anropa metoden [system. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) som en ytterligare kontroll för potentiellt skadliga system ändringar.</span><span class="sxs-lookup"><span data-stu-id="03e0c-293">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span> <span data-ttu-id="03e0c-294">Mer information om hur du anropar dessa metoder finns i avsnittet [byta namn på objekt](#renaming-items).</span><span class="sxs-lookup"><span data-stu-id="03e0c-294">For more information about calling these methods, see [Rename Items](#renaming-items).</span></span>

## <a name="attaching-dynamic-parameters-to-the-copy-item-cmdlet"></a><span data-ttu-id="03e0c-295">Bifoga dynamiska parametrar till Copy-Item-cmdleten</span><span class="sxs-lookup"><span data-stu-id="03e0c-295">Attaching Dynamic Parameters to the Copy-Item Cmdlet</span></span>

<span data-ttu-id="03e0c-296">Ibland `Copy-Item` kräver cmdleten ytterligare parametrar som anges dynamiskt vid körning.</span><span class="sxs-lookup"><span data-stu-id="03e0c-296">Sometimes the `Copy-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="03e0c-297">För att tillhandahålla dessa dynamiska parametrar måste Windows PowerShell container Provider implementera metoden [system. Management. Automation. Provider. Containercmdletprovider. Copyitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) för att hantera dessa parametrar.</span><span class="sxs-lookup"><span data-stu-id="03e0c-297">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="03e0c-298">Den här metoden hämtar parametrarna för objektet vid den angivna sökvägen och returnerar ett objekt som har egenskaper och fält med parsande attribut som liknar en cmdlet-klass eller ett [system. Management. Automation. Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) -objekt.</span><span class="sxs-lookup"><span data-stu-id="03e0c-298">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="03e0c-299">Windows PowerShell-körningsmiljön använder det returnerade objektet för att lägga till parametrarna i `Copy-Item` cmdleten.</span><span class="sxs-lookup"><span data-stu-id="03e0c-299">The Windows PowerShell runtime uses the returned object to add the parameters to the `Copy-Item` cmdlet.</span></span>

<span data-ttu-id="03e0c-300">Den här providern implementerar inte den här metoden.</span><span class="sxs-lookup"><span data-stu-id="03e0c-300">This provider does not implement this method.</span></span> <span data-ttu-id="03e0c-301">Följande kod är dock standard implementeringen av [system. Management. Automation. Provider. Containercmdletprovider. Copyitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="03e0c-301">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters](Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters)]  -->

## <a name="code-sample"></a><span data-ttu-id="03e0c-302">Kod exempel</span><span class="sxs-lookup"><span data-stu-id="03e0c-302">Code Sample</span></span>

<span data-ttu-id="03e0c-303">Fullständig exempel kod finns i [kod exemplet för AccessDbProviderSample04](./accessdbprovidersample04-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="03e0c-303">For complete sample code, see [AccessDbProviderSample04 Code Sample](./accessdbprovidersample04-code-sample.md).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="03e0c-304">Skapa Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="03e0c-304">Building the Windows PowerShell Provider</span></span>

<span data-ttu-id="03e0c-305">Se [hur du registrerar cmdlets, providers och värd program](/previous-versions/ms714644(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="03e0c-305">See [How to Register Cmdlets, Providers, and Host Applications](/previous-versions/ms714644(v=vs.85)).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="03e0c-306">Testa Windows PowerShell-providern</span><span class="sxs-lookup"><span data-stu-id="03e0c-306">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="03e0c-307">När din Windows PowerShell-provider har registrerats med Windows PowerShell kan du testa den genom att köra cmdlets som stöds på kommando raden.</span><span class="sxs-lookup"><span data-stu-id="03e0c-307">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="03e0c-308">Tänk på att följande exempel på utdata använder en fiktiv Access-databas.</span><span class="sxs-lookup"><span data-stu-id="03e0c-308">Be aware that the following example output uses a fictitious Access database.</span></span>

1. <span data-ttu-id="03e0c-309">Kör `Get-ChildItem` cmdleten för att hämta listan över underordnade objekt från en kund tabell i Access-databasen.</span><span class="sxs-lookup"><span data-stu-id="03e0c-309">Run the `Get-ChildItem` cmdlet to retrieve the list of child items from a Customers table in the Access database.</span></span>

   ```powershell
   Get-ChildItem mydb:customers
   ```

   <span data-ttu-id="03e0c-310">Följande utdata visas.</span><span class="sxs-lookup"><span data-stu-id="03e0c-310">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : True
   Data          : System.Data.DataRow
   Name          : Customers
   RowCount      : 91
   Columns       :
   ```

2. <span data-ttu-id="03e0c-311">Kör `Get-ChildItem` cmdleten igen för att hämta data för en tabell.</span><span class="sxs-lookup"><span data-stu-id="03e0c-311">Run the `Get-ChildItem` cmdlet again to retrieve the data of a table.</span></span>

   ```powershell
   (Get-ChildItem mydb:customers).data
   ```

   <span data-ttu-id="03e0c-312">Följande utdata visas.</span><span class="sxs-lookup"><span data-stu-id="03e0c-312">The following output appears.</span></span>

   ```output
   TABLE_CAT   : c:\PS\northwind
   TABLE_SCHEM :
   TABLE_NAME  : Customers
   TABLE_TYPE  : TABLE
   REMARKS     :
   ```

3. <span data-ttu-id="03e0c-313">Använd nu `Get-Item` cmdleten för att hämta objekten på rad 0 i data tabellen.</span><span class="sxs-lookup"><span data-stu-id="03e0c-313">Now use the `Get-Item` cmdlet to retrieve the items at row 0 in the data table.</span></span>

   ```powershell
   Get-Item mydb:\customers\0
   ```

   <span data-ttu-id="03e0c-314">Följande utdata visas.</span><span class="sxs-lookup"><span data-stu-id="03e0c-314">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers\0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data          : System.Data.DataRow
   RowNumber     : 0
   ```

4. <span data-ttu-id="03e0c-315">Återanvänd `Get-Item` för att hämta data för objekten på rad 0.</span><span class="sxs-lookup"><span data-stu-id="03e0c-315">Reuse `Get-Item` to retrieve the data for the items in row 0.</span></span>

   ```powershell
   (Get-Item mydb:\customers\0).data
   ```

   <span data-ttu-id="03e0c-316">Följande utdata visas.</span><span class="sxs-lookup"><span data-stu-id="03e0c-316">The following output appears.</span></span>

   ```output
   CustomerID   : 1234
   CompanyName  : Fabrikam
   ContactName  : Eric Gruber
   ContactTitle : President
   Address      : 4567 Main Street
   City         : Buffalo
   Region       : NY
   PostalCode   : 98052
   Country      : USA
   Phone        : (425) 555-0100
   Fax          : (425) 555-0101
   ```

5. <span data-ttu-id="03e0c-317">Använd nu `New-Item` cmdleten för att lägga till en rad i en befintlig tabell.</span><span class="sxs-lookup"><span data-stu-id="03e0c-317">Now use the `New-Item` cmdlet to add a row to an existing table.</span></span> <span data-ttu-id="03e0c-318">`Path`Parametern anger den fullständiga sökvägen till raden och måste ange ett rad nummer som är större än det befintliga antalet rader i tabellen.</span><span class="sxs-lookup"><span data-stu-id="03e0c-318">The `Path` parameter specifies the full path to the row, and must indicate a row number that is greater than the existing number of rows in the table.</span></span> <span data-ttu-id="03e0c-319">`Type`Parametern anger "rad" för att ange den typ av objekt som ska läggas till.</span><span class="sxs-lookup"><span data-stu-id="03e0c-319">The `Type` parameter indicates "row" to specify that type of item to add.</span></span>
   <span data-ttu-id="03e0c-320">Slutligen `Value` anger parametern en kommaavgränsad lista med kolumn värden för raden.</span><span class="sxs-lookup"><span data-stu-id="03e0c-320">Finally, the `Value` parameter specifies a comma-delimited list of column values for the row.</span></span>

   ```powershell
   New-Item -Path mydb:\Customers\3 -ItemType "row" -Value "3,CustomerFirstName,CustomerLastName,CustomerEmailAddress,CustomerTitle,CustomerCompany,CustomerPhone, CustomerAddress,CustomerCity,CustomerState,CustomerZip,CustomerCountry"
   ```

6. <span data-ttu-id="03e0c-321">Kontrol lera att den nya objekt åtgärden är korrekt på följande sätt.</span><span class="sxs-lookup"><span data-stu-id="03e0c-321">Verify the correctness of the new item operation as follows.</span></span>

   ```none
   PS mydb:\> cd Customers
   PS mydb:\Customers> (Get-Item 3).data
   ```

   <span data-ttu-id="03e0c-322">Följande utdata visas.</span><span class="sxs-lookup"><span data-stu-id="03e0c-322">The following output appears.</span></span>

   ```output
   ID        : 3
   FirstName : Eric
   LastName  : Gruber
   Email     : ericgruber@fabrikam.com
   Title     : President
   Company   : Fabrikam
   WorkPhone : (425) 555-0100
   Address   : 4567 Main Street
   City      : Buffalo
   State     : NY
   Zip       : 98052
   Country   : USA
   ```

## <a name="see-also"></a><span data-ttu-id="03e0c-323">Se även</span><span class="sxs-lookup"><span data-stu-id="03e0c-323">See Also</span></span>

[<span data-ttu-id="03e0c-324">Skapa Windows PowerShell-leverantörer</span><span class="sxs-lookup"><span data-stu-id="03e0c-324">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="03e0c-325">Designa en Windows PowerShell-provider</span><span class="sxs-lookup"><span data-stu-id="03e0c-325">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="03e0c-326">Implementera ett objekts Windows PowerShell-Provider</span><span class="sxs-lookup"><span data-stu-id="03e0c-326">Implementing an Item Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-item-provider.md)

[<span data-ttu-id="03e0c-327">Implementera en Windows PowerShell-Provider för navigering</span><span class="sxs-lookup"><span data-stu-id="03e0c-327">Implementing a Navigation Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-navigation-provider.md)

<span data-ttu-id="03e0c-328">[Registrera cmdlets, providers och värd program](/previous-versions/ms714644(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="03e0c-328">[How to Register Cmdlets, Providers, and Host Applications](/previous-versions/ms714644(v=vs.85))</span></span>

[<span data-ttu-id="03e0c-329">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="03e0c-329">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="03e0c-330">Programmeringsguide för Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="03e0c-330">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

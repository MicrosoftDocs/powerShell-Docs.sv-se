---
title: Lägga till resurser till en hantering av OData-webbtjänsten | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: e620bf6d-76be-47b0-a7a8-f43418f30c60
caps.latest.revision: 6
ms.openlocfilehash: b81a32b867795ae51c3f5308c2f82c31ed2747fa
ms.sourcegitcommit: debd2b38fb8070a7357bf1a4bf9cc736f3702f31
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 12/05/2019
ms.locfileid: "72352292"
---
# <a name="adding-resources-to-a-management-odata-web-service"></a><span data-ttu-id="af9d5-102">Lägga till resurser till en Management OData-webbtjänst</span><span class="sxs-lookup"><span data-stu-id="af9d5-102">Adding Resources to a Management OData Web Service</span></span>

<span data-ttu-id="af9d5-103">Det här exemplet visar hur du lägger till en resurs i en befintlig hantering av OData-webbtjänsten med hjälp av hanterings verktyget OData schema designer.</span><span class="sxs-lookup"><span data-stu-id="af9d5-103">This example demonstrates how to add a resource to an existing Management OData web service by using the Management OData Schema Designer.</span></span> <span data-ttu-id="af9d5-104">[PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) -exemplet skapar en webb tjänst som visar process-och Server resurserna.</span><span class="sxs-lookup"><span data-stu-id="af9d5-104">The [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) sample creates a web service that exposes the Process and Server resources.</span></span> <span data-ttu-id="af9d5-105">I det här exemplet ska du lägga till en virtuell dator resurs (VM) till webb tjänsten.</span><span class="sxs-lookup"><span data-stu-id="af9d5-105">In this example, you will add a Virtual Machine (VM) resource to the web service.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="af9d5-106">Förutsättningar</span><span class="sxs-lookup"><span data-stu-id="af9d5-106">Prerequisites</span></span>

<span data-ttu-id="af9d5-107">Det här avsnittet förutsätter att du har laddat ned och installerat [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) -exemplet enligt beskrivningen i [skapa en Windows PowerShell-webbtjänst](./creating-a-management-odata-web-service.md)och att du har laddat ned och installerat [hanterings verktyget OData schema designer](https://marketplace.visualstudio.com/items?itemName=jlisc0.ManagementODataSchemaDesigner).</span><span class="sxs-lookup"><span data-stu-id="af9d5-107">This topic assumes that you have downloaded and installed the [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) sample as described in [Creating a Windows PowerShell Web Service](./creating-a-management-odata-web-service.md), and that you have downloaded and installed the [Management OData Schema Designer](https://marketplace.visualstudio.com/items?itemName=jlisc0.ManagementODataSchemaDesigner).</span></span> <span data-ttu-id="af9d5-108">Det här avsnittet förutsätter också att du har Windows PowerShell-modulen för Hyper-V installerad på den dator där du konfigurerar OData-slutpunkten för hantering.</span><span class="sxs-lookup"><span data-stu-id="af9d5-108">This topic also assumes that you have the Hyper-V Windows PowerShell module installed on the computer where you set up the Management Odata endpoint.</span></span>

## <a name="adding-vm-as-a-resource-to-the-web-service"></a><span data-ttu-id="af9d5-109">Lägga till en virtuell dator som en resurs i webb tjänsten</span><span class="sxs-lookup"><span data-stu-id="af9d5-109">Adding VM as a Resource to the Web Service</span></span>

<span data-ttu-id="af9d5-110">Det första steget är att importera schemat från den befintliga hanterings-OData-slutpunkten till schema designern.</span><span class="sxs-lookup"><span data-stu-id="af9d5-110">The first step is to import the schema from the existing Management OData endpoint into the schema designer.</span></span> <span data-ttu-id="af9d5-111">Följande procedur beskriver hur du gör det.</span><span class="sxs-lookup"><span data-stu-id="af9d5-111">The following procedure describes how to do that.</span></span>

#### <a name="importing-an-existing-schema-into-the-schema-designer"></a><span data-ttu-id="af9d5-112">Importera ett befintligt schema till schema designern</span><span class="sxs-lookup"><span data-stu-id="af9d5-112">Importing an existing schema into the schema designer</span></span>

1. <span data-ttu-id="af9d5-113">Öppna hanterings verktyget OData schema designer.</span><span class="sxs-lookup"><span data-stu-id="af9d5-113">Open the Management OData Schema Designer.</span></span>

2. <span data-ttu-id="af9d5-114">På **Arkiv** -menyn väljer du **fil** . **Ny** ; **Filen**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-114">From the **File** menu, select **File** ; **New** ; **File**.</span></span> <span data-ttu-id="af9d5-115">Dialog rutan **ny fil** visas.</span><span class="sxs-lookup"><span data-stu-id="af9d5-115">The **New File** dialog appears.</span></span>

3. <span data-ttu-id="af9d5-116">Klicka på **hantering av OData-modell**och klicka sedan på **Öppna**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-116">Click **Management OData Model**, and then click **Open**.</span></span>

4. <span data-ttu-id="af9d5-117">Högerklicka på huvud fönstret och klicka på **schema fil** . **Importera**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-117">Right-click in the main window, and click **Schema file** ; **Import**.</span></span> <span data-ttu-id="af9d5-118">Dialog rutan **Öppna** visas.</span><span class="sxs-lookup"><span data-stu-id="af9d5-118">The **Open** dialog appears.</span></span>

5. <span data-ttu-id="af9d5-119">Navigera till mappen där du ställer in webb tjänsten för hantering av OData för [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) -exemplet.</span><span class="sxs-lookup"><span data-stu-id="af9d5-119">Navigate to the folder where you set up the Management OData web service for the [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) sample.</span></span> <span data-ttu-id="af9d5-120">Om du använde Windows PowerShell-skriptet som medföljer exemplet för att konfigurera slut punkten utan att ändra skriptet, är den mappen **C:\inetpub\wwwroot\Modata**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-120">If you used the Windows PowerShell script provided with that sample to set up the endpoint without modifying the script, that folder is **C:\inetpub\wwwroot\Modata**.</span></span> <span data-ttu-id="af9d5-121">Välj schema. MOF och klicka på **Öppna**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-121">Select Schema.mof, and click **Open**.</span></span>

   <span data-ttu-id="af9d5-122">Öppna i så fall schemat. MOF-och schema-XML-filer i en text redigerare och Lägg märke till att de innehåller mappningar för process-och tjänst resurserna.</span><span class="sxs-lookup"><span data-stu-id="af9d5-122">At this point, open the Schema.mof and Schema.xml files in a text editor, and notice that they contain mappings for the Process and Service resources.</span></span> <span data-ttu-id="af9d5-123">Filen schema. MOF använder MOF-standarden ( [Distributed Management Task Force](https://www.dmtf.org/) ), hanterad objekt.</span><span class="sxs-lookup"><span data-stu-id="af9d5-123">The Schema.mof file uses [Distributed Management  Task Force](https://www.dmtf.org/) (DTMF) Managed Object (MOF) standard.</span></span> <span data-ttu-id="af9d5-124">Filen schema. XML använder ett XML-schema som beskrivs i [resurs mappnings schema](./resource-mapping-schema.md).</span><span class="sxs-lookup"><span data-stu-id="af9d5-124">The schema.xml file uses an XML schema that is described in [Resource Mapping Schema](./resource-mapping-schema.md).</span></span>

   <span data-ttu-id="af9d5-125">I följande procedur beskrivs hur du importerar Hyper-V-cmdletar i till schema modellen.</span><span class="sxs-lookup"><span data-stu-id="af9d5-125">The following procedure describes how to import Hyper-V cmdlets in to the schema model.</span></span>

#### <a name="importing-cmdlets-into-the-schema"></a><span data-ttu-id="af9d5-126">Cmdlets importeras till schemat</span><span class="sxs-lookup"><span data-stu-id="af9d5-126">Importing cmdlets into the schema</span></span>

1. <span data-ttu-id="af9d5-127">Högerklicka på ett tomt utrymme i fönstret schema design och klicka på **Importera cmdlets**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-127">Right-click on a blank area of the schema designer window, and click **Import Cmdlets**.</span></span> <span data-ttu-id="af9d5-128">Dialog rutan **import guiden för cmdlet** visas.</span><span class="sxs-lookup"><span data-stu-id="af9d5-128">The **Cmdlet Import Wizard** dialog appears.</span></span>

2. <span data-ttu-id="af9d5-129">Se till att den **lokala datorn** är markerad och klicka på **Nästa**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-129">Make sure **Local Computer** is selected, and click **Next**.</span></span>

3. <span data-ttu-id="af9d5-130">Kontrol lera att installerade Windows PowerShell-moduler är markerat och välj Hyper-V i list rutan.</span><span class="sxs-lookup"><span data-stu-id="af9d5-130">Make sure that Installed Windows PowerShell Modules is selected, and select Hyper-V from the drop-down list.</span></span> <span data-ttu-id="af9d5-131">Klicka på **Nästa**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-131">click **Next**.</span></span> <span data-ttu-id="af9d5-132">Klicka på **Nästa**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-132">Click **Next**.</span></span>

4. <span data-ttu-id="af9d5-133">I **cmdlet Substantiv** -listan väljer du **virtuell dator**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-133">In the **Cmdlet Noun** list, select **VM**.</span></span> <span data-ttu-id="af9d5-134">Klicka på **Nästa**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-134">Click **Next**</span></span>

5. <span data-ttu-id="af9d5-135">I det här exemplet binder vi bara get-och Delete-kommandona med cmdletar.</span><span class="sxs-lookup"><span data-stu-id="af9d5-135">For this example, we will bind only the Get and Delete commands with cmdlets.</span></span> <span data-ttu-id="af9d5-136">Avmarkera kryss rutorna **skapa** och **Uppdatera** och kontrol lera att kryss rutorna **Hämta** och **ta bort** är markerade.</span><span class="sxs-lookup"><span data-stu-id="af9d5-136">Clear the **CREATE** and **UPDATE** checkboxes, and make sure the **GET** and **DELETE** checkboxes are checked.</span></span> <span data-ttu-id="af9d5-137">Kontrol lera att `Get-VM`-cmdleten har valts för **Get**och att `Remove-VM`-cmdleten har valts för **borttagning**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-137">Make sure that the `Get-VM` cmdlet is selected for **GET**, and the `Remove-VM` cmdlet is selected for **DELETE**.</span></span>

6. <span data-ttu-id="af9d5-138">Eftersom metadata för VM-cmdletarna inte anger någon Utdatatyp måste du köra cmdleten för att ange utdatatypen.</span><span class="sxs-lookup"><span data-stu-id="af9d5-138">Because the metadata for the VM cmdlets does not specify an output type, you will need to run the cmdlet to specify the output type.</span></span> <span data-ttu-id="af9d5-139">Välj **Ange Utdatatyp** och klicka på **kör cmdlet**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-139">Select **Provide output type** and click **Run cmdlet**.</span></span> <span data-ttu-id="af9d5-140">Dialog rutan **kör cmdlet** visas.</span><span class="sxs-lookup"><span data-stu-id="af9d5-140">The **Run Cmdlet** dialog appears.</span></span> <span data-ttu-id="af9d5-141">Klicka på **Run** (Kör).</span><span class="sxs-lookup"><span data-stu-id="af9d5-141">Click **Run**.</span></span> <span data-ttu-id="af9d5-142">Rutan **CLR-typ** fylls med `VirtualMachine` typen.</span><span class="sxs-lookup"><span data-stu-id="af9d5-142">The **CLR Type** box is populated with the `VirtualMachine` type.</span></span> <span data-ttu-id="af9d5-143">Klicka på **OK**och sedan på **Nästa**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-143">Click **OK**, then click **Next**.</span></span>

7. <span data-ttu-id="af9d5-144">Som standard är alla egenskaper för VirtualMachine-objektet markerade.</span><span class="sxs-lookup"><span data-stu-id="af9d5-144">By default, all of the properties of the VirtualMachine object are selected.</span></span> <span data-ttu-id="af9d5-145">Du kan ta bort alla egenskaper som du inte vill ha som en del av de data som returneras när du begär den här resursen från webb tjänsten.</span><span class="sxs-lookup"><span data-stu-id="af9d5-145">You can clear any properties that you do not want as part of the data returned when you request this resource from the web service.</span></span> <span data-ttu-id="af9d5-146">Klicka på **Nästa**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-146">Click **Next**.</span></span>

8. <span data-ttu-id="af9d5-147">Du måste markera minst en egenskap som ska användas som nyckel.</span><span class="sxs-lookup"><span data-stu-id="af9d5-147">You must select at least one property to be used as a key.</span></span> <span data-ttu-id="af9d5-148">Välj **namn** i listan och klicka på **Nästa**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-148">Select **Name** in the list, and click **Next**.</span></span>

9. <span data-ttu-id="af9d5-149">I nästa fönster kan du mappa egenskaper för hanterings-OData-resursen till egenskaper för de underliggande cmdletarna.</span><span class="sxs-lookup"><span data-stu-id="af9d5-149">The next window allows you to map properties of the Management OData resource to properties of the underlying cmdlets.</span></span> <span data-ttu-id="af9d5-150">Guiden mappar egenskaper med identiska namn som standard.</span><span class="sxs-lookup"><span data-stu-id="af9d5-150">The wizard maps properties with identical names by default.</span></span> <span data-ttu-id="af9d5-151">Till exempel mappas resursens `ComputerName` egenskap till `ComputerName`-egenskapen för cmdletarna.</span><span class="sxs-lookup"><span data-stu-id="af9d5-151">For example, the `ComputerName` property of the resource is mapped to the `ComputerName` property of the cmdlets.</span></span>  <span data-ttu-id="af9d5-152">På så sätt kan du ange `ComputerName` egenskapen i en begäran till webb tjänsten och ha det värde som du anger till `Get-VM`-cmdlet.</span><span class="sxs-lookup"><span data-stu-id="af9d5-152">This allows you to specify the `ComputerName` property in a request to the web service, and have the value you specify be passed to the `Get-VM` cmdlet.</span></span> <span data-ttu-id="af9d5-153">`Id` och `Name` mappas också som standard.</span><span class="sxs-lookup"><span data-stu-id="af9d5-153">`Id` and `Name` are also mapped by default.</span></span>

   10. <span data-ttu-id="af9d5-154">Klicka på **Nästa**och sedan på **Slutför**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-154">Click **Next**, then click **Finish**.</span></span>

       <span data-ttu-id="af9d5-155">Den virtuella dator resursen visas nu i fönstret schema designer.</span><span class="sxs-lookup"><span data-stu-id="af9d5-155">The VM resource now appears in the schema designer window.</span></span> <span data-ttu-id="af9d5-156">Du kan granska de egenskaper och åtgärder som är associerade med resursen.</span><span class="sxs-lookup"><span data-stu-id="af9d5-156">You can examine the properties and operations associated with the resource.</span></span> <span data-ttu-id="af9d5-157">Nu ska du exportera de uppdaterade schemafiler till webb tjänstens virtuella katalog.</span><span class="sxs-lookup"><span data-stu-id="af9d5-157">Next, you will export the updated schema files into the virtual directory for the web service.</span></span>

#### <a name="exporting-schema-files-from-the-schema-designer"></a><span data-ttu-id="af9d5-158">Exportera schemafiler från schema designern</span><span class="sxs-lookup"><span data-stu-id="af9d5-158">Exporting schema files from the schema designer</span></span>

1. <span data-ttu-id="af9d5-159">Högerklicka på ett tomt utrymme i fönstret schema design och klicka på **schema fil** . **Exportera**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-159">Right-click on a blank area of the schema designer window, and click **Schema file** ; **Export**.</span></span> <span data-ttu-id="af9d5-160">Dialog rutan **Spara som** visas.</span><span class="sxs-lookup"><span data-stu-id="af9d5-160">The **Save As** dialog appears.</span></span>

2. <span data-ttu-id="af9d5-161">Navigera till samma katalog som du importerade MOF-filen från.</span><span class="sxs-lookup"><span data-stu-id="af9d5-161">Navigate to the same directory from where you imported the MOF file.</span></span> <span data-ttu-id="af9d5-162">Ge filen namnet samma som den ursprungliga MOF-filen (schema. mof som standard) och klicka på **Spara**.</span><span class="sxs-lookup"><span data-stu-id="af9d5-162">Name the file the same as the original MOF file (Schema.mof by default), and click **Save**.</span></span> <span data-ttu-id="af9d5-163">Bekräfta att du vill skriva över den befintliga filen.</span><span class="sxs-lookup"><span data-stu-id="af9d5-163">Confirm that you want to overwrite the existing file.</span></span>

   <span data-ttu-id="af9d5-164">Även om det inte uttryckligen anges i dialog rutan **Spara som** , ersätter detta både filen schema. MOF och schema. xml.</span><span class="sxs-lookup"><span data-stu-id="af9d5-164">Although it is not explicitly stated in the **Save As** dialog, this replaces both the Schema.mof and Schema.xml files.</span></span>

## <a name="next-steps"></a><span data-ttu-id="af9d5-165">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="af9d5-165">Next Steps</span></span>

<span data-ttu-id="af9d5-166">Innan du får åtkomst till den nya virtuella dator resursen från webb tjänsten för hantering av OData måste du uppdatera filen RbacConfiguration. xml för att tillåta åtkomst till Windows PowerShell-modulen för Hyper-V enligt beskrivningen i [Konfigurera rollbaserad auktorisering](./configuring-role-based-authorization.md). du måste också starta om webb tjänsten.</span><span class="sxs-lookup"><span data-stu-id="af9d5-166">Before you access the new VM resource from the Management OData web service, you must update the RbacConfiguration.xml file to allow access to the Hyper-V Windows PowerShell module as described in [Configuring Role-based Authorization](./configuring-role-based-authorization.md), and you will also need to restart the web service.</span></span>
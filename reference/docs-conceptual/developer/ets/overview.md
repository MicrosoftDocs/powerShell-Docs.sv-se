---
title: Översikt över utökad typ system
ms.date: 07/09/2020
ms.openlocfilehash: 5c190f0d9b852a4b5658227085092f33d71453c9
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 08/05/2020
ms.locfileid: "87786228"
---
# <a name="extended-type-system-overview"></a><span data-ttu-id="9a908-102">Översikt över utökad typ system</span><span class="sxs-lookup"><span data-stu-id="9a908-102">Extended Type System Overview</span></span>

<span data-ttu-id="9a908-103">PowerShell använder sitt **PSObject** -objekt för att utöka objekt typerna på två sätt.</span><span class="sxs-lookup"><span data-stu-id="9a908-103">PowerShell uses its **PSObject** object to extend the types of objects in two ways.</span></span> <span data-ttu-id="9a908-104">Först är **PSObject** -objektet ett sätt att visa olika vyer av olika objekt typer.</span><span class="sxs-lookup"><span data-stu-id="9a908-104">First, the **PSObject** object provides a way to show different views of specific object types.</span></span> <span data-ttu-id="9a908-105">Detta kallas för att visa en anpassad vy av ett objekt.</span><span class="sxs-lookup"><span data-stu-id="9a908-105">This is referred to as showing an adapted view of an object.</span></span> <span data-ttu-id="9a908-106">För det andra är **PSObject** -objektet ett sätt att lägga till medlemmar i ett befintligt objekt.</span><span class="sxs-lookup"><span data-stu-id="9a908-106">Second, the **PSObject** object provides a way to add members to existing object.</span></span> <span data-ttu-id="9a908-107">Genom att omsluta ett befintligt objekt, som kallas för bas objekt, tillhandahåller **PSObject** -objektet ett utökat typ system (ETS) som skript-och cmdlet-utvecklare kan använda för att manipulera .net-objekt i gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="9a908-107">Together, by wrapping an existing object, referred to as the base object, the **PSObject** object provides an extended type system (ETS) that script and cmdlet developers can use to manipulate .NET objects within the shell.</span></span>

## <a name="cmdlet-and-script-development-issues"></a><span data-ttu-id="9a908-108">Problem med cmdlet-och skript utveckling</span><span class="sxs-lookup"><span data-stu-id="9a908-108">Cmdlet and Script Development Issues</span></span>

<span data-ttu-id="9a908-109">ETS löser två grundläggande problem:</span><span class="sxs-lookup"><span data-stu-id="9a908-109">ETS resolves two fundamental issues:</span></span>

<span data-ttu-id="9a908-110">För det första har vissa .NET-objekt inte det nödvändiga standard beteendet för att fungera som data mellan cmdletar.</span><span class="sxs-lookup"><span data-stu-id="9a908-110">First, some .NET Objects do not have the necessary default behavior for acting as the data between cmdlets.</span></span>

- <span data-ttu-id="9a908-111">Vissa .NET-objekt är "meta"-objekt (till exempel: WMI-objekt, ADO-objekt och XML-objekt) vars medlemmar beskriver de data de innehåller.</span><span class="sxs-lookup"><span data-stu-id="9a908-111">Some .NET objects are "meta" objects (for example: WMI Objects, ADO objects, and XML objects) whose members describe the data they contain.</span></span> <span data-ttu-id="9a908-112">I en skript miljö är det dock de data som är mest intressanta, inte beskrivningen av de data som finns.</span><span class="sxs-lookup"><span data-stu-id="9a908-112">However, in a scripting environment it is the contained data that is most interesting, not the description of the contained data.</span></span> <span data-ttu-id="9a908-113">ETS löser det här problemet genom att introducera begreppet kort som anpassar det underliggande .NET-objektet så att de förväntade standardsemantiken förväntas.</span><span class="sxs-lookup"><span data-stu-id="9a908-113">ETS resolves this issue by introducing the notion of Adapters that adapt the underlying .NET object to have the expected default semantics.</span></span>
- <span data-ttu-id="9a908-114">Vissa .NET-objekt medlemmar är inkonsekventa namngivna, tillhandahåller en otillräcklig uppsättning offentliga medlemmar eller ger otillräcklig funktion.</span><span class="sxs-lookup"><span data-stu-id="9a908-114">Some .NET Object members are inconsistently named, provide an insufficient set of public members, or provide insufficient capability.</span></span> <span data-ttu-id="9a908-115">ETS löser det här problemet genom att introducera möjligheten att utöka .NET-objektet med ytterligare medlemmar.</span><span class="sxs-lookup"><span data-stu-id="9a908-115">ETS resolves this issue by introducing the ability to extend the .NET object with additional members.</span></span>

<span data-ttu-id="9a908-116">För det andra är PowerShell-skript språket _typ_ lös i att en variabel inte behöver deklareras av en viss typ.</span><span class="sxs-lookup"><span data-stu-id="9a908-116">Second, the PowerShell scripting language is _typeless_ in that a variable does not need to be declared of a particular type.</span></span> <span data-ttu-id="9a908-117">Det vill säga att de variabler som en skript utvecklare skapar är av _typen typ_gräns.</span><span class="sxs-lookup"><span data-stu-id="9a908-117">That is, the variables a script developer creates are by nature _typeless_.</span></span> <span data-ttu-id="9a908-118">PowerShell-systemet är dock "typ driven" i att det är beroende av att ett typnamn används för grundläggande åtgärder, till exempel för att lägga till resultat eller sortera.</span><span class="sxs-lookup"><span data-stu-id="9a908-118">However, the PowerShell system is "type-driven" in that it depends on having a type name to operate against for basic operations such as outputting results or sorting.</span></span>

<span data-ttu-id="9a908-119">Därför måste en skript utvecklare ha möjlighet att ange typen av en av deras variabler och skapa en egen uppsättning av dynamiskt skrivna "objekt" som innehåller egenskaper och metoder och som kan delta i det typ drivna systemet.</span><span class="sxs-lookup"><span data-stu-id="9a908-119">Therefore a script developer must have the ability to state the type of one of their variables and build up their own set of dynamically typed "objects" that contain properties and methods and can participate in the type-driven system.</span></span> <span data-ttu-id="9a908-120">ETS löser detta problem genom att tillhandahålla ett gemensamt objekt för skript språket som har möjlighet att ange dess typ dynamiskt och lägga till medlemmar dynamiskt.</span><span class="sxs-lookup"><span data-stu-id="9a908-120">ETS solves this problem by providing a common object for the scripting language that has the ability to state its type dynamically and to add members dynamically.</span></span>

<span data-ttu-id="9a908-121">Dessutom löser ETS det problem som nämnts tidigare genom att tillhandahålla **PSObject** -objektet, som fungerar som underlag för all objekt åtkomst från skript språket och ger en standard abstraktion för cmdlet-utvecklaren.</span><span class="sxs-lookup"><span data-stu-id="9a908-121">Fundamentally, ETS resolves the issue mentioned previously by providing the **PSObject** object, which acts as the basis of all object access from the scripting language and provides a standard abstraction for the cmdlet developer.</span></span>

### <a name="cmdlet-developers"></a><span data-ttu-id="9a908-122">Cmdlet-utvecklare</span><span class="sxs-lookup"><span data-stu-id="9a908-122">Cmdlet Developers</span></span>

<span data-ttu-id="9a908-123">För cmdlet-utvecklare tillhandahåller ETS följande stöd:</span><span class="sxs-lookup"><span data-stu-id="9a908-123">For the cmdlet developers, ETS provides the following support:</span></span>

- <span data-ttu-id="9a908-124">Abstraktioner som fungerar mot objekt på ett allmänt sätt med hjälp av **PSObject** -objektet.</span><span class="sxs-lookup"><span data-stu-id="9a908-124">The abstractions to work against objects in a generic way using the **PSObject** object.</span></span> <span data-ttu-id="9a908-125">ETS ger också möjlighet att detaljgranska de här abstraktionarna om det behövs.</span><span class="sxs-lookup"><span data-stu-id="9a908-125">ETS also provides the ability to drill past these abstractions if required.</span></span>
- <span data-ttu-id="9a908-126">Mekanismerna för att skapa ett standard beteende för formatering, sortering, serialisering och andra systemmanipuleringar av objekt typen med hjälp av en välkänd uppsättning utökade medlemmar.</span><span class="sxs-lookup"><span data-stu-id="9a908-126">The mechanisms to create a default behavior for formatting, sorting, serialization, and other system manipulations of their object type using a well-known set of extended members.</span></span>
- <span data-ttu-id="9a908-127">Innebär att det går att använda ett objekt med samma semantik som skript språket med hjälp av ett LanguagePrimitives-objekt.</span><span class="sxs-lookup"><span data-stu-id="9a908-127">The means to operate against any object using the same semantics as the script language using a LanguagePrimitives object.</span></span>
- <span data-ttu-id="9a908-128">Innebär att du dynamiskt skriver en hash-tabell så att resten av systemet kan hantera dem på ett effektivt sätt.</span><span class="sxs-lookup"><span data-stu-id="9a908-128">The means to dynamically "type" a hash table so that the rest of the system can operate against it effectively.</span></span>

### <a name="script-developers"></a><span data-ttu-id="9a908-129">Skript utvecklare</span><span class="sxs-lookup"><span data-stu-id="9a908-129">Script Developers</span></span>

<span data-ttu-id="9a908-130">För skript utvecklare tillhandahåller ETS följande stöd:</span><span class="sxs-lookup"><span data-stu-id="9a908-130">For the script developers, ETS provides the following support:</span></span>

- <span data-ttu-id="9a908-131">Möjlighet att referera till en underliggande objekt typ med samma syntax ( `$a.x` ).</span><span class="sxs-lookup"><span data-stu-id="9a908-131">The ability to reference any underlying object type using the same syntax (`$a.x`).</span></span>
- <span data-ttu-id="9a908-132">Möjligheten att komma åt bortom abstraktionen som tillhandahålls av **PSObject** -objektet (till exempel åtkomst till anpassade medlemmar eller åtkomst till själva bas objektet).</span><span class="sxs-lookup"><span data-stu-id="9a908-132">The ability to access beyond the abstraction provided by the **PSObject** object (such as accessing only adapted members, or accessing the base object itself).</span></span>
- <span data-ttu-id="9a908-133">Möjlighet att definiera välkända medlemmar som styr formatering, sortering, serialisering och andra modifieringar av en objekt instans eller typ.</span><span class="sxs-lookup"><span data-stu-id="9a908-133">The ability to define well-known members that control the formatting, sorting, serialization, and other manipulations of an object instance or type.</span></span>
- <span data-ttu-id="9a908-134">Innebär att du namnger ett objekt som en speciell typ och därmed styr arv av dess typbaserade medlemmar.</span><span class="sxs-lookup"><span data-stu-id="9a908-134">The means to name an object as a specific type and thus control the inheritance of its type-based members.</span></span>
- <span data-ttu-id="9a908-135">Möjlighet att lägga till, ta bort och ändra utökade medlemmar.</span><span class="sxs-lookup"><span data-stu-id="9a908-135">The ability to add, remove, and modify extended members.</span></span>
- <span data-ttu-id="9a908-136">Möjligheten att ändra själva **PSObject** -objektet om det behövs.</span><span class="sxs-lookup"><span data-stu-id="9a908-136">The ability to manipulate the **PSObject** object itself if required.</span></span>

## <a name="the-psobject-class"></a><span data-ttu-id="9a908-137">PSObject-klassen</span><span class="sxs-lookup"><span data-stu-id="9a908-137">The PSObject class</span></span>

<span data-ttu-id="9a908-138">**PSObject** -objektet är grunden för all objekt åtkomst från skript språket och ger en standard abstraktion för cmdlet-utvecklaren.</span><span class="sxs-lookup"><span data-stu-id="9a908-138">The **PSObject** object is the basis of all object access from the scripting language and provides a standard abstraction for the cmdlet developer.</span></span> <span data-ttu-id="9a908-139">Det innehåller ett bas objekt (ett .NET-objekt) och alla instans medlemmar (medlemmar, medlemmar som är medlemmar, som finns på en viss objekt instans, men inte nödvändigt vis på andra objekt av samma typ).</span><span class="sxs-lookup"><span data-stu-id="9a908-139">It contains a base-object (a .NET object) and any instance members (members, specifically extended members, that are present on a particular object instance while not necessarily on other objects of the same type).</span></span> <span data-ttu-id="9a908-140">Beroende på typen av bas objekt kan **PSObject** -objektet även ge implicit och explicit åtkomst till anpassade medlemmar samt alla typbaserade utökade medlemmar.</span><span class="sxs-lookup"><span data-stu-id="9a908-140">Depending on the type of the base-object, the **PSObject** object might also provide implicit and explicit access to adapted members as well as any type-based extended members.</span></span>

<span data-ttu-id="9a908-141">**PSObject** -objektet har följande mekanismer:</span><span class="sxs-lookup"><span data-stu-id="9a908-141">The **PSObject** object provides the following mechanisms:</span></span>

- <span data-ttu-id="9a908-142">Möjligheten att skapa en **PSObject** med eller utan ett bas objekt.</span><span class="sxs-lookup"><span data-stu-id="9a908-142">The ability to construct an **PSObject** with or without a base-object.</span></span>
- <span data-ttu-id="9a908-143">Möjlighet att komma åt alla medlemmar i varje konstruerat **PSObject** -objekt via en gemensam sökalgoritm och möjligheten att åsidosätta algoritmen vid behov.</span><span class="sxs-lookup"><span data-stu-id="9a908-143">The ability to access of all members of each constructed **PSObject** object through a common lookup algorithm and the ability to override that algorithm when required.</span></span>
- <span data-ttu-id="9a908-144">Möjlighet att hämta och ange typ namn för de konstruerade **PSObject** -objekten så att skript och cmdlets kan referera till liknande **PSObject** -objekt med samma typ av namn, oavsett typ av grundläggande objekt.</span><span class="sxs-lookup"><span data-stu-id="9a908-144">The ability to get and set the type-names of the constructed **PSObject** objects so that scripts and cmdlets can reference similar **PSObject** objects by the same type-name, regardless of the type of their base-object.</span></span>

### <a name="how-to-construct-a-psobject"></a><span data-ttu-id="9a908-145">Så här skapar du en PSObject</span><span class="sxs-lookup"><span data-stu-id="9a908-145">How to Construct a PSObject</span></span>

<span data-ttu-id="9a908-146">I följande lista beskrivs hur du skapar ett **PSObject** -objekt:</span><span class="sxs-lookup"><span data-stu-id="9a908-146">The following list describes ways to create a **PSObject** object:</span></span>

- <span data-ttu-id="9a908-147">Anrop av **PSObject** . #ctor-konstruktorn skapar ett nytt **PSObject** -objekt med ett bas objekt av PSCustomObject.</span><span class="sxs-lookup"><span data-stu-id="9a908-147">Calling the **PSObject** .#ctor constructor creates a new **PSObject** object with a base-object of PSCustomObject.</span></span> <span data-ttu-id="9a908-148">Ett bas objekt av den här typen anger att **PSObject** -objektet saknar meningsfullt bas objekt.</span><span class="sxs-lookup"><span data-stu-id="9a908-148">A base-object of this type indicates that the **PSObject** object has no meaningful base-object.</span></span> <span data-ttu-id="9a908-149">Ett **PSObject** -objekt med den här typen av Base-Object tillhandahåller dock en egenskaps uppsättning som cmdlet-utvecklare kan hitta till hjälp genom att lägga till utökade medlemmar.</span><span class="sxs-lookup"><span data-stu-id="9a908-149">However, a **PSObject** object with this type of base-object does provide a property bag that cmdlet developers can find helpful by adding extended-members.</span></span>

<span data-ttu-id="9a908-150">Utvecklare kan även ange objekt typ namnet, vilket gör att objektet kan dela dess utökade medlemmar med andra **PSObject** -objekt av samma typ-namn.</span><span class="sxs-lookup"><span data-stu-id="9a908-150">Developers can also specify the object type-name, which allows this object to share its extended-members with other **PSObject** objects of the same type-name.</span></span>

- <span data-ttu-id="9a908-151">Anrop av konstruktorn **PSObject** . #ctor (system. Object) skapar ett nytt **PSObject** -objekt med ett bas objekt av typen system. Object.</span><span class="sxs-lookup"><span data-stu-id="9a908-151">Calling the **PSObject** .#ctor(System.Object) constructor creates a new **PSObject** object with a base-object of type System.Object.</span></span>

  <span data-ttu-id="9a908-152">I det här fallet är typ namnet för det skapade objektet en samling av härlednings-hierarkin för bas objekt.</span><span class="sxs-lookup"><span data-stu-id="9a908-152">In this case, the type-name for the created object is a collection of the derivation hierarchy of the base-object.</span></span> <span data-ttu-id="9a908-153">Exempelvis innehåller typ namnet för **PSObject** som innehåller ett ProcessInfo Base-objekt följande namn:</span><span class="sxs-lookup"><span data-stu-id="9a908-153">For example, the type-name for the **PSObject** that contains a ProcessInfo base-object would include the following names:</span></span>

  - <span data-ttu-id="9a908-154">System. Diagnostics. process</span><span class="sxs-lookup"><span data-stu-id="9a908-154">System.Diagnostics.Process</span></span>
  - <span data-ttu-id="9a908-155">System. ComponentModel. Component</span><span class="sxs-lookup"><span data-stu-id="9a908-155">System.ComponentModel.Component</span></span>
  - <span data-ttu-id="9a908-156">System. MarshalByRefObject</span><span class="sxs-lookup"><span data-stu-id="9a908-156">System.MarshalByRefObject</span></span>
  - <span data-ttu-id="9a908-157">System. Object</span><span class="sxs-lookup"><span data-stu-id="9a908-157">System.Object</span></span>

- <span data-ttu-id="9a908-158">Anropar **PSObject** . AsPSObject (system. Object) skapar ett nytt **PSObject** -objekt baserat på ett angivet objekt.</span><span class="sxs-lookup"><span data-stu-id="9a908-158">Calling the **PSObject** .AsPSObject(System.Object) method creates a new **PSObject** object based on a supplied object.</span></span>

  <span data-ttu-id="9a908-159">Om det angivna objektet är av typen system. Object används det angivna objektet som bas objekt för det nya **PSObject** -objektet.</span><span class="sxs-lookup"><span data-stu-id="9a908-159">If the supplied object is of type System.Object, the supplied object is used as the base-object for the new **PSObject** object.</span></span> <span data-ttu-id="9a908-160">Om det tillhandahållna objektet redan är ett **PSObject** -objekt returneras det angivna objektet som det är.</span><span class="sxs-lookup"><span data-stu-id="9a908-160">If the supplied object is already an **PSObject** object, the supplied object is returned as is.</span></span>

### <a name="base-adapted-and-extended-members"></a><span data-ttu-id="9a908-161">Bas, anpassade och utökade medlemmar</span><span class="sxs-lookup"><span data-stu-id="9a908-161">Base, adapted, and extended members</span></span>

<span data-ttu-id="9a908-162">Med hjälp av ETS används följande villkor för att visa förhållandet mellan de ursprungliga medlemmarna i bas-objektet och de medlemmar som läggs till av PowerShell.</span><span class="sxs-lookup"><span data-stu-id="9a908-162">Conceptually, ETS uses the following terms to show the relationship between the original members of the base-object and those members added by PowerShell.</span></span> <span data-ttu-id="9a908-163">Mer information om de olika typerna av medlemmar som används av **PSObject** -objektet finns i PSObject- [klass](/dotnet/api/system.management.automation.psobject).</span><span class="sxs-lookup"><span data-stu-id="9a908-163">For more information about the specific types of members that are used by the **PSObject** object, see [PSObject class](/dotnet/api/system.management.automation.psobject).</span></span>

#### <a name="base-object-members"></a><span data-ttu-id="9a908-164">Bas objekts medlemmar</span><span class="sxs-lookup"><span data-stu-id="9a908-164">Base-object members</span></span>

<span data-ttu-id="9a908-165">Om bas-objektet anges när **PSObject** -objekten konstrueras, görs medlemmarna i bas-objektet tillgängligt via egenskapen members.</span><span class="sxs-lookup"><span data-stu-id="9a908-165">If the base-object is specified when constructing the **PSObject** objects, then the members of the base-object are made available through the Members property.</span></span>

#### <a name="adapted-members"></a><span data-ttu-id="9a908-166">Anpassade medlemmar</span><span class="sxs-lookup"><span data-stu-id="9a908-166">Adapted members</span></span>

<span data-ttu-id="9a908-167">När ett bas objekt är ett meta-objekt, en som innehåller data i ett generiskt sätt vars egenskaper beskriver deras inbäddade data, anpassar ETS objekten till en vy som ger direkt åtkomst till data via de anpassade medlemmarna i **PSObject** -objektet.</span><span class="sxs-lookup"><span data-stu-id="9a908-167">When a base-object is a meta-object, one that contains data in a generic fashion whose properties "describe" their contained data, ETS adapts those objects to a view that allows for direct access to the data through adapted members of the **PSObject** object.</span></span> <span data-ttu-id="9a908-168">Anpassade medlemmar och medlemmar i bas objekt nås via egenskapen medlemmar.</span><span class="sxs-lookup"><span data-stu-id="9a908-168">Adapted members and base-object members are accessed through the Members property.</span></span>

#### <a name="extended-members"></a><span data-ttu-id="9a908-169">Utökade medlemmar</span><span class="sxs-lookup"><span data-stu-id="9a908-169">Extended members</span></span>

<span data-ttu-id="9a908-170">Förutom medlemmar som görs tillgängliga från bas-eller anpassnings medlemmar som skapats av PowerShell, kan en **PSObject** också definiera utökade medlemmar som utökar det ursprungliga bas objektet med ytterligare information som är användbar i skript miljön.</span><span class="sxs-lookup"><span data-stu-id="9a908-170">In addition to the members made available from the base-object or those adapted members created by PowerShell, an **PSObject** may also define extended members that extend the original base-object with additional information that is useful in the scripting environment.</span></span>

<span data-ttu-id="9a908-171">Till exempel, alla kärn-cmdletar som tillhandahålls av PowerShell, till exempel cmdletarna get-Content och set-Content, tar du en Sök vägs parameter.</span><span class="sxs-lookup"><span data-stu-id="9a908-171">For example, all the core cmdlets provided by PowerShell, such as the Get-Content and Set-Content cmdlets, take a path parameter.</span></span> <span data-ttu-id="9a908-172">För att säkerställa att dessa cmdletar, och andra, kan fungera mot objekt av olika typer, kan en Sök vägs medlem läggas till i dessa objekt så att de anger information på ett vanligt sätt.</span><span class="sxs-lookup"><span data-stu-id="9a908-172">To ensure that these cmdlets, and others, can work against objects of different types, a Path member can be added to those objects so that they all state their information in a common way.</span></span> <span data-ttu-id="9a908-173">Den här utökade Sök vägs medlemmen säkerställer att cmdletarna kan fungera mot alla dessa typer även om Bask Lassen kanske inte har en Sök vägs medlem.</span><span class="sxs-lookup"><span data-stu-id="9a908-173">This extended Path member ensures that the cmdlets can work against all those types even though there base class might not have a Path member.</span></span>

<span data-ttu-id="9a908-174">Utökade medlemmar, anpassade medlemmar och bas objekts medlemmar kan nås via egenskapen members.</span><span class="sxs-lookup"><span data-stu-id="9a908-174">Extended members, adapted members, and base-object members are all accessed through the Members property.</span></span>

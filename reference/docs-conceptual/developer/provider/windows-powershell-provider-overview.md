---
ms.date: 09/13/2016
ms.topic: reference
title: Översikt över Windows PowerShell-providers
description: Översikt över Windows PowerShell-providers
ms.openlocfilehash: 2f1c5f5991a64fb2b85ece7feba915164ebd34ee
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 12/10/2020
ms.locfileid: "93355518"
---
# <a name="windows-powershell-provider-overview"></a><span data-ttu-id="bc689-103">Översikt över Windows PowerShell-providers</span><span class="sxs-lookup"><span data-stu-id="bc689-103">Windows PowerShell Provider Overview</span></span>

<span data-ttu-id="bc689-104">Med en Windows PowerShell-Provider kan alla data lager visas som ett fil system som om det vore en monterad enhet.</span><span class="sxs-lookup"><span data-stu-id="bc689-104">A Windows PowerShell provider allows any data store to be exposed like a file system as if it were a mounted drive.</span></span> <span data-ttu-id="bc689-105">Den inbyggda Registry-providern gör det till exempel möjligt att navigera i registret på samma sätt som du navigerar i `c` datorns enhet.</span><span class="sxs-lookup"><span data-stu-id="bc689-105">For example, the built-in Registry provider allows you to navigate the registry like you would navigate the `c` drive of your computer.</span></span> <span data-ttu-id="bc689-106">En provider kan även åsidosätta `Item` cmdletarna (till exempel, `Get-Item` , `Set-Item` osv.) så att data i data lagret kan behandlas som filer och kataloger behandlas när du navigerar i ett fil system.</span><span class="sxs-lookup"><span data-stu-id="bc689-106">A provider can also override the `Item` cmdlets (for example, `Get-Item`, `Set-Item`, etc.) such that the data in your data store can be treated like files and directories are treated when navigating a file system.</span></span> <span data-ttu-id="bc689-107">Mer information om leverantörer och enheter och de inbyggda providers i Windows PowerShell finns [about_Providers](/powershell/module/microsoft.powershell.core/about/about_providers).</span><span class="sxs-lookup"><span data-stu-id="bc689-107">For more information about providers and drives, and the built-in providers in Windows PowerShell, see [about_Providers](/powershell/module/microsoft.powershell.core/about/about_providers).</span></span>

## <a name="providers-and-drives"></a><span data-ttu-id="bc689-108">Leverantörer och enheter</span><span class="sxs-lookup"><span data-stu-id="bc689-108">Providers and Drives</span></span>

<span data-ttu-id="bc689-109">En provider definierar den logik som används för att komma åt, navigera i och redigera ett data lager, medan en enhet anger en viss start punkt för ett data lager (eller en del av ett data lager) som är av den typ som definieras av providern.</span><span class="sxs-lookup"><span data-stu-id="bc689-109">A Provider defines the logic that is used to access, navigate, and edit a data store, while a drive specifies a specific entry point to a data store (or a portion of a data store) that is of the type defined by the provider.</span></span> <span data-ttu-id="bc689-110">Registry-providern kan till exempel använda Hive och nycklar i ett register, och HKLM-och HKCU-enheterna anger motsvarande registreringsdatafiler i registret.</span><span class="sxs-lookup"><span data-stu-id="bc689-110">For example, the Registry provider allows you to access hives and keys in a registry, and the HKLM and HKCU drives specify the corresponding hives within the registry.</span></span> <span data-ttu-id="bc689-111">HKLM-och HKCU-enheterna använder båda register leverantören.</span><span class="sxs-lookup"><span data-stu-id="bc689-111">The HKLM and HKCU drives both use the Registry provider.</span></span>

<span data-ttu-id="bc689-112">När du skriver en provider kan du ange standard enheter – enheter som skapas automatiskt när leverantören är tillgänglig.</span><span class="sxs-lookup"><span data-stu-id="bc689-112">When you write a provider, you can specify default drives-drives that are created automatically when the provider is available.</span></span> <span data-ttu-id="bc689-113">Du definierar också en metod för att skapa nya enheter som använder providern.</span><span class="sxs-lookup"><span data-stu-id="bc689-113">You also define a method to create new drives that use that provider.</span></span>

## <a name="type-of-providers"></a><span data-ttu-id="bc689-114">Typ av leverantörer</span><span class="sxs-lookup"><span data-stu-id="bc689-114">Type of Providers</span></span>

<span data-ttu-id="bc689-115">Det finns flera typer av leverantörer, som var och en har olika funktions nivåer.</span><span class="sxs-lookup"><span data-stu-id="bc689-115">There are several types of providers, each of which provides a different level of functionality.</span></span> <span data-ttu-id="bc689-116">En provider implementeras som en klass som härleds från en av de underordnade objekten i klassen [system. Management. Automation. SessionStateCategory](/dotnet/api/system.management.automation.sessionstatecategory) 
 **CmdletProvider** .</span><span class="sxs-lookup"><span data-stu-id="bc689-116">A provider is implemented as a class that derives from one of the descendants of the [System.Management.Automation.SessionStateCategory](/dotnet/api/system.management.automation.sessionstatecategory)
**CmdletProvider** class.</span></span> <span data-ttu-id="bc689-117">Information om olika typer av leverantörer finns i [typer](./provider-types.md)av leverantörer.</span><span class="sxs-lookup"><span data-stu-id="bc689-117">For information about the different types of providers, see [Provider types](./provider-types.md).</span></span>

## <a name="provider-cmdlets"></a><span data-ttu-id="bc689-118">Cmdlets för providers</span><span class="sxs-lookup"><span data-stu-id="bc689-118">Provider cmdlets</span></span>

<span data-ttu-id="bc689-119">Leverantörer kan implementera metoder som motsvarar cmdlets och skapa anpassade beteenden för dessa cmdletar när de används i en enhet för providern.</span><span class="sxs-lookup"><span data-stu-id="bc689-119">Providers can implement methods that correspond to cmdlets, creating custom behaviors for those cmdlets when used in a drive for that provider.</span></span> <span data-ttu-id="bc689-120">Olika uppsättningar cmdlets är tillgängliga beroende på typ av Provider.</span><span class="sxs-lookup"><span data-stu-id="bc689-120">Depending on the type of provider, different sets of cmdlets are available.</span></span> <span data-ttu-id="bc689-121">En fullständig lista över de cmdletar som är tillgängliga för anpassning i providrar finns i [Provider-cmdletar](./provider-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="bc689-121">For a complete list of the cmdlets available for customization in providers, see [Provider cmdlets](./provider-cmdlets.md).</span></span>

## <a name="provider-paths"></a><span data-ttu-id="bc689-122">Provider-sökvägar</span><span class="sxs-lookup"><span data-stu-id="bc689-122">Provider paths</span></span>

<span data-ttu-id="bc689-123">Användare navigerar leverantörs enheter som fil system.</span><span class="sxs-lookup"><span data-stu-id="bc689-123">Users navigate provider drives like file systems.</span></span> <span data-ttu-id="bc689-124">Därför förväntas syntaxen för sökvägar som motsvarar de sökvägar som används i fil system navigering.</span><span class="sxs-lookup"><span data-stu-id="bc689-124">Because of this, they expect the syntax of paths to correspond to the paths used in file system navigation.</span></span> <span data-ttu-id="bc689-125">När en användare kör en provider-cmdlet anger de en sökväg till det objekt som ska nås.</span><span class="sxs-lookup"><span data-stu-id="bc689-125">When a user runs a provider cmdlet, they specify a path to the item to be accessed.</span></span> <span data-ttu-id="bc689-126">Den angivna sökvägen kan tolkas på flera sätt.</span><span class="sxs-lookup"><span data-stu-id="bc689-126">The path that is specified can be interpreted in several ways.</span></span> <span data-ttu-id="bc689-127">En provider bör ha stöd för en eller flera av följande Sök vägs typer.</span><span class="sxs-lookup"><span data-stu-id="bc689-127">A provider should support one or more of the following path types.</span></span>

### <a name="drive-qualified-paths"></a><span data-ttu-id="bc689-128">Enhet – kvalificerade sökvägar</span><span class="sxs-lookup"><span data-stu-id="bc689-128">Drive-qualified paths</span></span>

<span data-ttu-id="bc689-129">En enhets kvalificerad sökväg är en kombination av objekt namn, behållare och under behållare där objektet finns och Windows PowerShell-enheten som objektet har åtkomst till.</span><span class="sxs-lookup"><span data-stu-id="bc689-129">A drive-qualified path is a combination of the item name, the container and subcontainers in which the item is located, and the Windows PowerShell drive through which the item is accessed.</span></span> <span data-ttu-id="bc689-130">(Enheter definieras av den provider som används för att få åtkomst till data lagret.</span><span class="sxs-lookup"><span data-stu-id="bc689-130">(Drives are defined by the provider that is used to access the data store.</span></span> <span data-ttu-id="bc689-131">Den här sökvägen börjar med enhets namnet följt av ett kolon (:).</span><span class="sxs-lookup"><span data-stu-id="bc689-131">This path starts with the drive name followed by a colon (:).</span></span> <span data-ttu-id="bc689-132">Exempel: `get-childitem C:`</span><span class="sxs-lookup"><span data-stu-id="bc689-132">For example: `get-childitem C:`</span></span>

### <a name="provider-qualified-paths"></a><span data-ttu-id="bc689-133">Kvalificerade sökvägar för Provider</span><span class="sxs-lookup"><span data-stu-id="bc689-133">Provider-qualified paths</span></span>

<span data-ttu-id="bc689-134">Providern måste ha stöd för en provider-kvalificerad sökväg för att Windows PowerShell-motorn ska kunna initiera och avinitiera providern.</span><span class="sxs-lookup"><span data-stu-id="bc689-134">To allow the Windows PowerShell engine to initialize and uninitialize your provider, the provider must support a provider-qualified path.</span></span> <span data-ttu-id="bc689-135">Användaren kan till exempel initiera och avinitiera fil systemets Provider eftersom den definierar följande Provider-kvalificerade sökväg: `FileSystem::\\uncshare\abc\bar` .</span><span class="sxs-lookup"><span data-stu-id="bc689-135">For example, the user can initialize and uninitialize the FileSystem provider because it defines the following provider-qualified path: `FileSystem::\\uncshare\abc\bar`.</span></span>

### <a name="provider-direct-paths"></a><span data-ttu-id="bc689-136">Provider – direkta sökvägar</span><span class="sxs-lookup"><span data-stu-id="bc689-136">Provider-direct paths</span></span>

<span data-ttu-id="bc689-137">Om du vill tillåta fjärråtkomst till Windows PowerShell-providern ska den stödja en provider-direkt sökväg för att skicka direkt till Windows PowerShell-providern för den aktuella platsen.</span><span class="sxs-lookup"><span data-stu-id="bc689-137">To allow remote access to your Windows PowerShell provider, it should support a provider-direct path to pass directly to the Windows PowerShell provider for the current location.</span></span> <span data-ttu-id="bc689-138">Till exempel kan registrets Windows PowerShell-Provider använda `\\server\regkeypath` som en provider-direkt sökväg.</span><span class="sxs-lookup"><span data-stu-id="bc689-138">For example, the registry Windows PowerShell provider can use `\\server\regkeypath` as a provider-direct path.</span></span>

### <a name="provider-internal-paths"></a><span data-ttu-id="bc689-139">Provider – interna sökvägar</span><span class="sxs-lookup"><span data-stu-id="bc689-139">Provider-internal paths</span></span>

<span data-ttu-id="bc689-140">Om du vill tillåta Provider-cmdleten att komma åt data med icke-Windows PowerShell-API: er (Application Programming Interfaces) ska din Windows PowerShell-Provider stödja en provider-intern sökväg.</span><span class="sxs-lookup"><span data-stu-id="bc689-140">To allow the provider cmdlet to access data using non-Windows PowerShell application programming interfaces (APIs), your Windows PowerShell provider should support a provider-internal path.</span></span> <span data-ttu-id="bc689-141">Den här sökvägen anges efter "::" i providerns kvalificerade sökväg.</span><span class="sxs-lookup"><span data-stu-id="bc689-141">This path is indicated after the "::" in the provider-qualified path.</span></span> <span data-ttu-id="bc689-142">Till exempel är providerns interna sökväg för Windows PowerShell-providern för fil systemet `\\uncshare\abc\bar` .</span><span class="sxs-lookup"><span data-stu-id="bc689-142">For example, the provider-internal path for the filesystem Windows PowerShell provider is `\\uncshare\abc\bar`.</span></span>

## <a name="overriding-cmdlet-parameters"></a><span data-ttu-id="bc689-143">Åsidosätter cmdlet-parametrar</span><span class="sxs-lookup"><span data-stu-id="bc689-143">Overriding cmdlet parameters</span></span>

<span data-ttu-id="bc689-144">Beteendet för vissa providerspecifika cmdletar kan åsidosättas av en provider.</span><span class="sxs-lookup"><span data-stu-id="bc689-144">The behavior of some provider-specific cmdlets can be overridden by a provider.</span></span> <span data-ttu-id="bc689-145">En lista över parametrar som kan åsidosättas och hur du åsidosätter dem i din leverantörs klass finns i [providerns cmdlet-parametrar](./provider-cmdlet-parameters.md)</span><span class="sxs-lookup"><span data-stu-id="bc689-145">For a list of parameters that can be overridden, and how to override them in your provider class, see [Provider cmdlet parameters](./provider-cmdlet-parameters.md)</span></span>

## <a name="dynamic-parameters"></a><span data-ttu-id="bc689-146">Dynamiska parametrar</span><span class="sxs-lookup"><span data-stu-id="bc689-146">Dynamic parameters</span></span>

<span data-ttu-id="bc689-147">Leverantörer kan definiera dynamiska parametrar som läggs till i en providers-cmdlet när användaren anger ett visst värde för en av de statiska parametrarna för cmdleten.</span><span class="sxs-lookup"><span data-stu-id="bc689-147">Providers can define dynamic parameters that are added to a provider cmdlet when the user specifies a certain value for one of the static parameters of the cmdlet.</span></span> <span data-ttu-id="bc689-148">En provider gör detta genom att implementera en eller flera dynamiska parameter metoder.</span><span class="sxs-lookup"><span data-stu-id="bc689-148">A provider does this by implementing one or more dynamic parameter methods.</span></span> <span data-ttu-id="bc689-149">En lista över cmdlet-parametrar som kan användas för att lägga till en dynamisk parameter och de metoder som används för att implementera dem finns i [dynamiska parametrar för provider-cmdlet](./provider-cmdlet-dynamic-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="bc689-149">For a list of cmdlet parameters that can be used to add dynamic parameter, and the methods used to implement them, see [Provider cmdlet dynamic parameters](./provider-cmdlet-dynamic-parameters.md).</span></span>

## <a name="provider-capabilities"></a><span data-ttu-id="bc689-150">Leverantörs funktioner</span><span class="sxs-lookup"><span data-stu-id="bc689-150">Provider capabilities</span></span>

<span data-ttu-id="bc689-151">I uppräkningen [system. Management. Automation. Provider. ProviderCapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) definieras ett antal funktioner som providers kan stödja.</span><span class="sxs-lookup"><span data-stu-id="bc689-151">The [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration defines a number of capabilities that providers can support.</span></span> <span data-ttu-id="bc689-152">Detta inkluderar möjligheten att använda jokertecken, filtrera objekt och stöd transaktioner.</span><span class="sxs-lookup"><span data-stu-id="bc689-152">These include the ability to use wildcards, filter items, and support transactions.</span></span> <span data-ttu-id="bc689-153">Om du vill ange funktioner för en provider lägger du till en lista med värden för attributet [system. Management. Automation. Provider. ProviderCapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) , kombinerat med en logisk `OR` åtgärd, som egenskapen [system. Management. Automation. Provider. Cmdletproviderattribute. ProviderCapabilities \*](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute.ProviderCapabilities) (den andra parametern för attributet) för attributet [system. Management. Automation. Provider. Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) för din leverantörs klass.</span><span class="sxs-lookup"><span data-stu-id="bc689-153">To specify capabilities for a provider, add a list of values of the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration, combined with a logical `OR` operation, as the [System.Management.Automation.Provider.Cmdletproviderattribute.Providercapabilities\*](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute.ProviderCapabilities) property (the second parameter of the attribute) of the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute for your provider class.</span></span> <span data-ttu-id="bc689-154">Följande attribut anger till exempel att providern stöder funktionerna [system. Management. Automation. Provider. ProviderCapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) 
 **ShouldProcess** och [system. Management. Automation. Provider. ProviderCapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) 
 **transaktioner** .</span><span class="sxs-lookup"><span data-stu-id="bc689-154">For example, the following attribute specifies that the provider supports the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)
**ShouldProcess** and [System.Management.Automation.Provider.ProviderCapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)
**Transactions** capabilities.</span></span>

```csharp
[CmdletProvider(RegistryProvider.ProviderName, ProviderCapabilities.ShouldProcess | ProviderCapabilities.Transactions)]

```

## <a name="provider-cmdlet-help"></a><span data-ttu-id="bc689-155">Hjälp om Provider-cmdlet</span><span class="sxs-lookup"><span data-stu-id="bc689-155">Provider cmdlet help</span></span>

<span data-ttu-id="bc689-156">När du skriver en provider kan du implementera din egen hjälp för de Provider-cmdletar som du stöder.</span><span class="sxs-lookup"><span data-stu-id="bc689-156">When writing a provider, you can implement your own Help for the provider cmdlets that you support.</span></span>
<span data-ttu-id="bc689-157">Detta omfattar ett enda hjälp avsnitt för varje provider-cmdlet eller flera versioner av ett hjälp avsnitt för fall där providerns cmdlet fungerar på olika sätt baserat på användningen av dynamiska parametrar.</span><span class="sxs-lookup"><span data-stu-id="bc689-157">This includes a single help topic for each provider cmdlet or multiple versions of a help topic for cases where the provider cmdlet acts differently based on the use of dynamic parameters.</span></span> <span data-ttu-id="bc689-158">Om du vill ha stöd för providerns cmdlet-/regionsspecifika hjälp måste leverantören implementera gränssnittet [system. Management. Automation. Provider. Icmdletprovidersupportshelp](/dotnet/api/System.Management.Automation.Provider.ICmdletProviderSupportsHelp) .</span><span class="sxs-lookup"><span data-stu-id="bc689-158">To support provider cmdlet-specific help, your provider must implement the [System.Management.Automation.Provider.Icmdletprovidersupportshelp](/dotnet/api/System.Management.Automation.Provider.ICmdletProviderSupportsHelp) interface.</span></span>

<span data-ttu-id="bc689-159">Windows PowerShell-motorn anropar metoden [system. Management. Automation. Provider. Icmdletprovidersupportshelp. Gethelpmaml \*](/dotnet/api/System.Management.Automation.Provider.ICmdletProviderSupportsHelp.GetHelpMaml) för att visa hjälp avsnittet för dina Provider-cmdletar.</span><span class="sxs-lookup"><span data-stu-id="bc689-159">The Windows PowerShell engine calls the [System.Management.Automation.Provider.Icmdletprovidersupportshelp.Gethelpmaml\*](/dotnet/api/System.Management.Automation.Provider.ICmdletProviderSupportsHelp.GetHelpMaml) method to display the Help topic for your provider cmdlets.</span></span> <span data-ttu-id="bc689-160">-Motorn tillhandahåller namnet på den cmdlet som användaren angav när du körde `Get-Help` cmdleten och den aktuella sökvägen till användaren.</span><span class="sxs-lookup"><span data-stu-id="bc689-160">The engine provides the name of the cmdlet that the user specified when running the `Get-Help` cmdlet and the current path of the user.</span></span>
<span data-ttu-id="bc689-161">Den aktuella sökvägen krävs om providern implementerar olika versioner av samma provider-cmdlet för olika enheter.</span><span class="sxs-lookup"><span data-stu-id="bc689-161">The current path is required if your provider implements different versions of the same provider cmdlet for different drives.</span></span> <span data-ttu-id="bc689-162">Metoden måste returnera en sträng som innehåller XML-koden för cmdlet-hjälpen.</span><span class="sxs-lookup"><span data-stu-id="bc689-162">The method must return a string that contains the XML for the cmdlet Help.</span></span>

<span data-ttu-id="bc689-163">Innehållet för hjälp filen skrivs med PSMAML XML.</span><span class="sxs-lookup"><span data-stu-id="bc689-163">The content for the Help file is written using PSMAML XML.</span></span> <span data-ttu-id="bc689-164">Detta är samma XML-schema som används för att skriva Hjälp innehåll för fristående cmdlets.</span><span class="sxs-lookup"><span data-stu-id="bc689-164">This is the same XML schema that is used for writing Help content for stand-alone cmdlets.</span></span> <span data-ttu-id="bc689-165">Lägg till innehållet för din anpassade cmdlet-hjälp till hjälp filen för din Provider under `CmdletHelpPaths` elementet.</span><span class="sxs-lookup"><span data-stu-id="bc689-165">Add the content for your custom cmdlet Help to the Help file for your provider under the `CmdletHelpPaths` element.</span></span> <span data-ttu-id="bc689-166">I följande exempel visas `command` elementet för en enda Provider-cmdlet och det visar hur du anger namnet på den provider-cmdlet som din Provider.</span><span class="sxs-lookup"><span data-stu-id="bc689-166">The following example shows the `command` element for a single provider cmdlet, and it shows how you specify the name of the provider cmdlet that your provider.</span></span> <span data-ttu-id="bc689-167">har stöd för</span><span class="sxs-lookup"><span data-stu-id="bc689-167">supports</span></span>

```xml
<CmdletHelpPaths>
  <command:command>
    <command:details>
      <command:name>ProviderCmdletName</command:name>
      <command:verb>Verb</command:verb>
      <command:noun>Noun</command:noun>
    <command:details>
  </command:command>
<CmdletHelpPath>
```

## <a name="see-also"></a><span data-ttu-id="bc689-168">Se även</span><span class="sxs-lookup"><span data-stu-id="bc689-168">See Also</span></span>

[<span data-ttu-id="bc689-169">Funktioner i Windows PowerShell-Provider</span><span class="sxs-lookup"><span data-stu-id="bc689-169">Windows PowerShell Provider Functionality</span></span>](./provider-types.md)

[<span data-ttu-id="bc689-170">Provider-cmdletar</span><span class="sxs-lookup"><span data-stu-id="bc689-170">Provider Cmdlets</span></span>](./provider-cmdlets.md)

[<span data-ttu-id="bc689-171">Skriva en Windows PowerShell-provider</span><span class="sxs-lookup"><span data-stu-id="bc689-171">Writing a Windows PowerShell Provider</span></span>](./writing-a-windows-powershell-provider.md)

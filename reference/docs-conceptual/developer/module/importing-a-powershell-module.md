---
title: Importera en PowerShell-modul | Microsoft Docs
ms.date: 02/03/2020
ms.openlocfilehash: 8cd1938d0a7b49b4a594753d8ce5ebe60625025d
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 08/05/2020
ms.locfileid: "87784885"
---
# <a name="importing-a-powershell-module"></a><span data-ttu-id="7b7a6-102">Importera en PowerShell-modul</span><span class="sxs-lookup"><span data-stu-id="7b7a6-102">Importing a PowerShell Module</span></span>

<span data-ttu-id="7b7a6-103">När du har installerat en modul i ett system vill du förmodligen importera modulen.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-103">Once you have installed a module on a system, you will likely want to import the module.</span></span> <span data-ttu-id="7b7a6-104">Import är den process som läser in modulen i Active Memory, så att en användare kan komma åt modulen i sin PowerShell-session.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-104">Importing is the process that loads the module into active memory, so that a user can access that module in their PowerShell session.</span></span> <span data-ttu-id="7b7a6-105">I PowerShell 2,0 kan du importera en nyligen installerad PowerShell-modul med ett anrop till cmdleten [import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) .</span><span class="sxs-lookup"><span data-stu-id="7b7a6-105">In PowerShell 2.0, you can import a newly-installed PowerShell module with a call to [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet.</span></span> <span data-ttu-id="7b7a6-106">I PowerShell 3,0 kan PowerShell importera en modul implicit när en av funktionerna eller cmdletarna i modulen anropas av en användare.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-106">In PowerShell 3.0, PowerShell is able to implicitly import a module when one of the functions or cmdlets in the module is called by a user.</span></span> <span data-ttu-id="7b7a6-107">Observera att båda versionerna förutsätter att du installerar modulen på en plats där PowerShell kan hitta den. Mer information finns i [installera en PowerShell-modul](./installing-a-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="7b7a6-107">Note that both versions assume that you install your module in a location where PowerShell is able to find it; for more information, see [Installing a PowerShell Module](./installing-a-powershell-module.md).</span></span>
<span data-ttu-id="7b7a6-108">Du kan använda ett modul manifest för att begränsa vilka delar av modulen som exporteras och du kan använda parametrar för `Import-Module` anropet för att begränsa vilka delar som importeras.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-108">You can use a module manifest to restrict what parts of your module are exported, and you can use parameters of the `Import-Module` call to restrict what parts are imported.</span></span>

## <a name="importing-a-snap-in-powershell-10"></a><span data-ttu-id="7b7a6-109">Importera en snapin-modul (PowerShell 1,0)</span><span class="sxs-lookup"><span data-stu-id="7b7a6-109">Importing a Snap-In (PowerShell 1.0)</span></span>

<span data-ttu-id="7b7a6-110">Modulerna fanns inte i PowerShell 1,0: i stället var du tvungen att registrera och använda snapin-moduler. Vi rekommenderar dock inte att du använder den här tekniken eftersom moduler ofta är enklare att installera och importera.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-110">Modules did not exist in PowerShell 1.0: instead, you had to register and use snap-ins. However, it is not recommended that you use this technology at this point, as modules are generally easier to install and import.</span></span> <span data-ttu-id="7b7a6-111">Mer information finns i [så här skapar du en Windows PowerShell-snapin-modul](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span><span class="sxs-lookup"><span data-stu-id="7b7a6-111">For more information, see [How to Create a Windows PowerShell Snap-in](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span></span>

## <a name="importing-a-module-with-import-module-powershell-20"></a><span data-ttu-id="7b7a6-112">Importera en modul med import-module (PowerShell 2,0)</span><span class="sxs-lookup"><span data-stu-id="7b7a6-112">Importing a Module with Import-Module (PowerShell 2.0)</span></span>

<span data-ttu-id="7b7a6-113">PowerShell 2,0 använder lämplig-namngiven cmdlet för [import-modul](/powershell/module/Microsoft.PowerShell.Core/Import-Module) för att importera moduler.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-113">PowerShell 2.0 uses the appropriately-named [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to import modules.</span></span> <span data-ttu-id="7b7a6-114">När den här cmdleten körs söker Windows PowerShell efter den angivna modulen i de kataloger som anges i `PSModulePath` variabeln.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-114">When this cmdlet is run, Windows PowerShell searches for the specified module within the directories specified in the `PSModulePath` variable.</span></span> <span data-ttu-id="7b7a6-115">När den angivna katalogen hittas söker Windows PowerShell efter filer i följande ordning: modul manifest Files (. psd1), skriptfiler (. psm1), filer för binär modul (. dll).</span><span class="sxs-lookup"><span data-stu-id="7b7a6-115">When the specified directory is found, Windows PowerShell searches for files in the following order: module manifest files (.psd1), script module files (.psm1), binary module files (.dll).</span></span> <span data-ttu-id="7b7a6-116">Mer information om hur du lägger till kataloger i sökningen finns i [ändra installations Sök vägen för PSModulePath](./modifying-the-psmodulepath-installation-path.md).</span><span class="sxs-lookup"><span data-stu-id="7b7a6-116">For more information about adding directories to the search, see [Modifying the PSModulePath Installation Path](./modifying-the-psmodulepath-installation-path.md).</span></span>
<span data-ttu-id="7b7a6-117">I följande kod beskrivs hur du importerar en modul:</span><span class="sxs-lookup"><span data-stu-id="7b7a6-117">The following code describes how to import a module:</span></span>

```powershell
Import-Module myModule
```

<span data-ttu-id="7b7a6-118">Förutsatt att modulen finns i `PSModulePath` , skulle PowerShell läsa in modulen i aktivt minne.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-118">Assuming that myModule was located in the `PSModulePath`, PowerShell would load myModule into active memory.</span></span> <span data-ttu-id="7b7a6-119">Om modulen inte fanns på en `PSModulePath` sökväg, kunde du fortfarande uttryckligen meddela PowerShell var du hittar den:</span><span class="sxs-lookup"><span data-stu-id="7b7a6-119">If myModule was not located on a `PSModulePath` path, you could still explicitly tell PowerShell where to find it:</span></span>

```powershell
Import-Module -Name C:\myRandomDirectory\myModule -Verbose
```

<span data-ttu-id="7b7a6-120">Du kan också använda- `-Verbose` parametern för att identifiera vad som exporteras från modulen och vad som importeras till det aktiva minnet.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-120">You can also use the `-Verbose` parameter to identify what is being exported out of the module, and what is being imported into active memory.</span></span> <span data-ttu-id="7b7a6-121">Både export och import begränsar vad som visas för användaren: skillnaden är vem som styr synligheten.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-121">Both exports and imports restrict what is exposed to the user: the difference is who is controlling the visibility.</span></span> <span data-ttu-id="7b7a6-122">I princip styrs exporten av kod i modulen.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-122">Essentially, exports are controlled by code within the module.</span></span> <span data-ttu-id="7b7a6-123">Som kontrast styrs import av `Import-Module` anropet.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-123">In contrast, imports are controlled by the `Import-Module` call.</span></span> <span data-ttu-id="7b7a6-124">Mer information finns i **begränsa medlemmar som importeras**nedan.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-124">For more information, see **Restricting Members That Are Imported**, below.</span></span>

## <a name="implicitly-importing-a-module-powershell-30"></a><span data-ttu-id="7b7a6-125">Importera en modul implicit (PowerShell 3,0)</span><span class="sxs-lookup"><span data-stu-id="7b7a6-125">Implicitly Importing a Module (PowerShell 3.0)</span></span>

<span data-ttu-id="7b7a6-126">Från och med Windows PowerShell 3,0 importeras moduler automatiskt när en cmdlet eller funktion i modulen används i ett kommando.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-126">Beginning in Windows PowerShell 3.0, modules are imported automatically when any cmdlet or function in the module is used in a command.</span></span> <span data-ttu-id="7b7a6-127">Den här funktionen fungerar på alla moduler i en katalog som ingår i värdet för **PSModulePath** -miljövariabeln.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-127">This feature works on any module in a directory that this included in the value of the **PSModulePath** environment variable.</span></span> <span data-ttu-id="7b7a6-128">Om du inte sparar modulen på en giltig sökväg kan du dock fortfarande läsa in dem med hjälp av alternativet explicit [import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) , som beskrivs ovan.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-128">If you do not save your module on a valid path however, you can still load them using the explicit [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) option, described above.</span></span>

<span data-ttu-id="7b7a6-129">Följande åtgärder utlöser automatisk import av en modul, även kallat "automatisk inläsning av modul".</span><span class="sxs-lookup"><span data-stu-id="7b7a6-129">The following actions trigger automatic importing of a module, also known as "module auto-loading."</span></span>

- <span data-ttu-id="7b7a6-130">Använda en cmdlet i ett kommando.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-130">Using a cmdlet in a command.</span></span> <span data-ttu-id="7b7a6-131">Skriv till exempel `Get-ExecutionPolicy` importerar modulen Microsoft. PowerShell. Security som innehåller `Get-ExecutionPolicy` cmdleten.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-131">For example, typing `Get-ExecutionPolicy` imports the Microsoft.PowerShell.Security module that contains the `Get-ExecutionPolicy` cmdlet.</span></span>

- <span data-ttu-id="7b7a6-132">Hämta kommandot med hjälp av cmdleten [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) .</span><span class="sxs-lookup"><span data-stu-id="7b7a6-132">Using the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet to get the command.</span></span> <span data-ttu-id="7b7a6-133">Skriv till exempel `Get-Command Get-JobTrigger` importerar **PSScheduledJob** -modulen som innehåller `Get-JobTrigger` cmdleten.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-133">For example, typing `Get-Command Get-JobTrigger` imports the **PSScheduledJob** module that contains the `Get-JobTrigger` cmdlet.</span></span> <span data-ttu-id="7b7a6-134">Ett `Get-Command` kommando som innehåller jokertecken betraktas som identifiering och utlöser inte import av en modul.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-134">A `Get-Command` command that includes wildcard characters is considered to be discovery and does not trigger importing of a module.</span></span>

- <span data-ttu-id="7b7a6-135">Använd cmdleten [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) för att få hjälp med en cmdlet.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-135">Using the [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) cmdlet to get help for a cmdlet.</span></span> <span data-ttu-id="7b7a6-136">Skriv till exempel `Get-Help Get-WinEvent` importerar modulen Microsoft. PowerShell. Diagnostics som innehåller `Get-WinEvent` cmdleten.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-136">For example, typing `Get-Help Get-WinEvent` imports the Microsoft.PowerShell.Diagnostics module that contains the `Get-WinEvent` cmdlet.</span></span>

<span data-ttu-id="7b7a6-137">För att stödja automatisk import av moduler, `Get-Command` hämtar cmdlet alla cmdletar och funktioner i alla installerade moduler, även om modulen inte importeras till sessionen.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-137">To support automatic importing of modules, the `Get-Command` cmdlet gets all cmdlets and functions in all installed modules, even if the module is not imported into the session.</span></span> <span data-ttu-id="7b7a6-138">Mer information finns i hjälp avsnittet för cmdleten [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) .</span><span class="sxs-lookup"><span data-stu-id="7b7a6-138">For more information, see the help topic for the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet.</span></span>

## <a name="the-importing-process"></a><span data-ttu-id="7b7a6-139">Import processen</span><span class="sxs-lookup"><span data-stu-id="7b7a6-139">The Importing Process</span></span>

<span data-ttu-id="7b7a6-140">När en modul importeras skapas ett nytt sessionstillstånd för modulen och ett [system. Management. Automation. PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) -objekt skapas i minnet.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-140">When a module is imported, a new session state is created for the module, and a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object is created in memory.</span></span> <span data-ttu-id="7b7a6-141">Ett sessionstillstånd skapas för varje modul som importeras (Detta inkluderar rotnoden och eventuella kapslade moduler).</span><span class="sxs-lookup"><span data-stu-id="7b7a6-141">A session-state is created for each module that is imported (this includes the root module and any nested modules).</span></span> <span data-ttu-id="7b7a6-142">De medlemmar som exporteras från modulen root, inklusive alla medlemmar som exporter ATS till rotnoden av eventuella kapslade moduler, importeras sedan till anroparens sessionstillstånd.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-142">The members that are exported from the root module, including any members that were exported to the root module by any nested modules, are then imported into the caller's session state.</span></span>

<span data-ttu-id="7b7a6-143">Metadata för medlemmar som exporteras från en modul har egenskapen modulnamn.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-143">The metadata of members that are exported from a module have a ModuleName property.</span></span> <span data-ttu-id="7b7a6-144">Den här egenskapen fylls med namnet på den modul som exporterade dem.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-144">This property is populated with the name of the module that exported them.</span></span>

> [!WARNING]
> <span data-ttu-id="7b7a6-145">Om namnet på en exporterad medlem använder ett icke godkänt verb eller om namnet på medlemmen använder begränsade tecken visas en varning när cmdleten [import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) körs.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-145">If the name of an exported member uses an unapproved verb or if the name of the member uses restricted characters, a warning is displayed when the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet is run.</span></span>

<span data-ttu-id="7b7a6-146">Som standard returnerar cmdleten [import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) inga objekt till pipelinen.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-146">By default, the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet does not return any objects to the pipeline.</span></span> <span data-ttu-id="7b7a6-147">Cmdleten stöder dock en **Passthru** -parameter som kan användas för att returnera ett [system. Management. Automation. PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) -objekt för varje modul som importeras.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-147">However, the cmdlet supports a **PassThru** parameter that can be used to return a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object for each module that is imported.</span></span> <span data-ttu-id="7b7a6-148">Användarna ska kunna skicka utdata till värden genom att köra cmdleten [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) .</span><span class="sxs-lookup"><span data-stu-id="7b7a6-148">To send output to the host, users should run the [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet.</span></span>

## <a name="restricting--the-members-that-are-imported"></a><span data-ttu-id="7b7a6-149">Begränsa de medlemmar som importeras</span><span class="sxs-lookup"><span data-stu-id="7b7a6-149">Restricting  the Members That Are Imported</span></span>

<span data-ttu-id="7b7a6-150">När en modul importeras med hjälp av cmdleten [import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) , importeras alla medlemmar som exporter ATS till sessionen, inklusive alla kommandon som exporteras till modulen av en kapslad modul.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-150">When a module is imported by using the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet, by default, all exported module members are imported into the session, including any commands exported to the module by a nested module.</span></span> <span data-ttu-id="7b7a6-151">Som standard exporteras inte variabler och alias.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-151">By default, variables and aliases are not exported.</span></span> <span data-ttu-id="7b7a6-152">Om du vill begränsa vilka medlemmar som exporteras använder du ett [modul manifest](./how-to-write-a-powershell-module-manifest.md).</span><span class="sxs-lookup"><span data-stu-id="7b7a6-152">To restrict the members that are exported, use a [module manifest](./how-to-write-a-powershell-module-manifest.md).</span></span>
<span data-ttu-id="7b7a6-153">Om du vill begränsa vilka medlemmar som importeras använder du följande parametrar för `Import-Module` cmdleten.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-153">To restrict the members that are imported, use the following parameters of the `Import-Module` cmdlet.</span></span>

- <span data-ttu-id="7b7a6-154">**Funktion**: den här parametern begränsar vilka funktioner som exporteras.</span><span class="sxs-lookup"><span data-stu-id="7b7a6-154">**Function**: This parameter restricts the functions that are exported.</span></span> <span data-ttu-id="7b7a6-155">(Om du använder ett modul-manifest, se FunctionsToExport-nyckeln.)</span><span class="sxs-lookup"><span data-stu-id="7b7a6-155">(If you are using a module manifest, see the FunctionsToExport key.)</span></span>

- <span data-ttu-id="7b7a6-156">\`**Cmdlet**: den här parametern begränsar de cmdlet: ar som exporteras (om du använder ett modul manifest, se CmdletsToExport-nyckeln).</span><span class="sxs-lookup"><span data-stu-id="7b7a6-156">\`**Cmdlet**: This parameter restricts the cmdlets that are exported (If you are using a module manifest, see the CmdletsToExport key.)</span></span>

- <span data-ttu-id="7b7a6-157">**Variabel**: den här parametern begränsar de variabler som exporteras (om du använder ett modul-manifest, se VariablesToExport-nyckeln).</span><span class="sxs-lookup"><span data-stu-id="7b7a6-157">**Variable**: This parameter restricts the variables that are exported (If you are using a module manifest, see the VariablesToExport key.)</span></span>

- <span data-ttu-id="7b7a6-158">**Alias**: den här parametern begränsar de alias som exporteras (om du använder ett modul manifest, se AliasesToExport-nyckeln).</span><span class="sxs-lookup"><span data-stu-id="7b7a6-158">**Alias**: This parameter restricts the aliases that are exported (If you are using a module manifest, see the AliasesToExport key.)</span></span>

## <a name="see-also"></a><span data-ttu-id="7b7a6-159">Se även</span><span class="sxs-lookup"><span data-stu-id="7b7a6-159">See Also</span></span>

[<span data-ttu-id="7b7a6-160">Skriva en Windows PowerShell-modul</span><span class="sxs-lookup"><span data-stu-id="7b7a6-160">Writing a Windows PowerShell Module</span></span>](./writing-a-windows-powershell-module.md)

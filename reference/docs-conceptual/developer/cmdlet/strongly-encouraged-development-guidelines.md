---
ms.date: 09/13/2016
ms.topic: reference
title: Starkt rekommenderade riktlinjer för utveckling
description: Starkt rekommenderade riktlinjer för utveckling
ms.openlocfilehash: 786ce66ed6289e91b532b0c31ed797afad4574b3
ms.sourcegitcommit: 488a940c7c828820b36a6ba56c119f64614afc29
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/27/2020
ms.locfileid: "92646430"
---
# <a name="strongly-encouraged-development-guidelines"></a><span data-ttu-id="839c7-103">Starkt rekommenderade riktlinjer för utveckling</span><span class="sxs-lookup"><span data-stu-id="839c7-103">Strongly Encouraged Development Guidelines</span></span>

<span data-ttu-id="839c7-104">I det här avsnittet beskrivs rikt linjer som du bör följa när du skriver dina cmdlets.</span><span class="sxs-lookup"><span data-stu-id="839c7-104">This section describes guidelines that you should follow when you write your cmdlets.</span></span> <span data-ttu-id="839c7-105">De är indelade i rikt linjer för att utforma cmdlets och rikt linjer för att skriva din cmdlet-kod.</span><span class="sxs-lookup"><span data-stu-id="839c7-105">They are separated into guidelines for designing cmdlets and guidelines for writing your cmdlet code.</span></span> <span data-ttu-id="839c7-106">Du kanske upptäcker att dessa rikt linjer inte gäller för varje scenario.</span><span class="sxs-lookup"><span data-stu-id="839c7-106">You might find that these guidelines are not applicable for every scenario.</span></span> <span data-ttu-id="839c7-107">Men om de tillämpas och du inte följer dessa rikt linjer, kan användarna ha en dålig upplevelse när de använder dina cmdletar.</span><span class="sxs-lookup"><span data-stu-id="839c7-107">However, if they do apply and you do not follow these guidelines, your users might have a poor experience when they use your cmdlets.</span></span>

## <a name="design-guidelines"></a><span data-ttu-id="839c7-108">Designriktlinjer</span><span class="sxs-lookup"><span data-stu-id="839c7-108">Design Guidelines</span></span>

- [<span data-ttu-id="839c7-109">Använd ett angivet Substantiv för ett cmdlet-namn (SD01)</span><span class="sxs-lookup"><span data-stu-id="839c7-109">Use a Specific Noun for a Cmdlet Name (SD01)</span></span>](./strongly-encouraged-development-guidelines.md#use-a-specific-noun-for-a-cmdlet-name-sd01)

- [<span data-ttu-id="839c7-110">Använd Pascal-fall för cmdlet-namn (SD02)</span><span class="sxs-lookup"><span data-stu-id="839c7-110">Use Pascal Case for Cmdlet Names (SD02)</span></span>](./strongly-encouraged-development-guidelines.md#use-pascal-case-for-cmdlet-names-sd02)

- [<span data-ttu-id="839c7-111">Rikt linjer för parameter design (SD03)</span><span class="sxs-lookup"><span data-stu-id="839c7-111">Parameter Design Guidelines (SD03)</span></span>](./strongly-encouraged-development-guidelines.md#parameter-design-guidelines-sd03)

- [<span data-ttu-id="839c7-112">Ge feedback till användaren (SD04)</span><span class="sxs-lookup"><span data-stu-id="839c7-112">Provide Feedback to the User (SD04)</span></span>](./strongly-encouraged-development-guidelines.md#provide-feedback-to-the-user-sd04)

- [<span data-ttu-id="839c7-113">Skapa en hjälp fil för cmdlet (SD05)</span><span class="sxs-lookup"><span data-stu-id="839c7-113">Create a Cmdlet Help File (SD05)</span></span>](./strongly-encouraged-development-guidelines.md#create-a-cmdlet-help-file-sd05)

## <a name="code-guidelines"></a><span data-ttu-id="839c7-114">Kod rikt linjer</span><span class="sxs-lookup"><span data-stu-id="839c7-114">Code Guidelines</span></span>

- [<span data-ttu-id="839c7-115">Kodnings parametrar (SC01)</span><span class="sxs-lookup"><span data-stu-id="839c7-115">Coding Parameters (SC01)</span></span>](./strongly-encouraged-development-guidelines.md#coding-parameters-sc01)

- [<span data-ttu-id="839c7-116">Support bra definierade pipeline-inmatare (SC02)</span><span class="sxs-lookup"><span data-stu-id="839c7-116">Support Well Defined Pipeline Input (SC02)</span></span>](./strongly-encouraged-development-guidelines.md#support-well-defined-pipeline-input-sc02)

- [<span data-ttu-id="839c7-117">Skriv enskilda poster till pipelinen (SC03)</span><span class="sxs-lookup"><span data-stu-id="839c7-117">Write Single Records to the Pipeline (SC03)</span></span>](./strongly-encouraged-development-guidelines.md#write-single-records-to-the-pipeline-sc03)

- [<span data-ttu-id="839c7-118">Skapa cmdlets Case-Insensitive och Case-Preserving (SC04)</span><span class="sxs-lookup"><span data-stu-id="839c7-118">Make Cmdlets Case-Insensitive and Case-Preserving (SC04)</span></span>](./strongly-encouraged-development-guidelines.md#make-cmdlets-case-insensitive-and-case-preserving-sc04)

## <a name="design-guidelines"></a><span data-ttu-id="839c7-119">Designriktlinjer</span><span class="sxs-lookup"><span data-stu-id="839c7-119">Design Guidelines</span></span>

<span data-ttu-id="839c7-120">Följande rikt linjer bör följas när du utformar cmdlets för att säkerställa en konsekvent användar upplevelse mellan att använda dina cmdletar och andra cmdletar.</span><span class="sxs-lookup"><span data-stu-id="839c7-120">The following guidelines should be followed when designing cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="839c7-121">När du hittar en design rikt linje som gäller din situation bör du titta närmare på kod rikt linjerna för liknande rikt linjer.</span><span class="sxs-lookup"><span data-stu-id="839c7-121">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="use-a-specific-noun-for-a-cmdlet-name-sd01"></a><span data-ttu-id="839c7-122">Använd ett angivet Substantiv för ett cmdlet-namn (SD01)</span><span class="sxs-lookup"><span data-stu-id="839c7-122">Use a Specific Noun for a Cmdlet Name (SD01)</span></span>

<span data-ttu-id="839c7-123">Substantiv som används i cmdlet-namn måste vara särskilt så att användaren kan identifiera dina cmdletar.</span><span class="sxs-lookup"><span data-stu-id="839c7-123">Nouns used in cmdlet naming need to be very specific so that the user can discover your cmdlets.</span></span> <span data-ttu-id="839c7-124">Prefix för generiska substantiv som "Server" med en förkortad version av produkt namnet.</span><span class="sxs-lookup"><span data-stu-id="839c7-124">Prefix generic nouns such as "server" with a shortened version of the product name.</span></span> <span data-ttu-id="839c7-125">Om t. ex. ett substantiv refererar till en server som kör en instans av Microsoft SQL Server, använder du ett substantiv som "SQLServer".</span><span class="sxs-lookup"><span data-stu-id="839c7-125">For example, if a noun refers to a server that is running an instance of Microsoft SQL Server, use a noun such as "SQLServer".</span></span> <span data-ttu-id="839c7-126">Kombinationen av vissa Substantiv och den korta listan över godkända verb gör det möjligt för användaren att snabbt upptäcka och förutse funktioner samtidigt som du undviker duplicering mellan cmdlet-namn.</span><span class="sxs-lookup"><span data-stu-id="839c7-126">The combination of specific nouns and the short list of approved verbs enable the user to quickly discover and anticipate functionality while avoiding duplication among cmdlet names.</span></span>

<span data-ttu-id="839c7-127">För att förbättra användar upplevelsen ska det substantiv som du väljer för ett cmdlet-namn vara singular.</span><span class="sxs-lookup"><span data-stu-id="839c7-127">To enhance the user experience, the noun that you choose for a cmdlet name should be singular.</span></span> <span data-ttu-id="839c7-128">Använd till exempel namnet `Get-Process` i stället för **Get-processs** .</span><span class="sxs-lookup"><span data-stu-id="839c7-128">For example, use the name `Get-Process` instead of **Get-Processes** .</span></span> <span data-ttu-id="839c7-129">Det är bäst att följa den här regeln för alla cmdlet-namn, även om en cmdlet förmodligen fungerar på mer än ett objekt.</span><span class="sxs-lookup"><span data-stu-id="839c7-129">It is best to follow this rule for all cmdlet names, even when a cmdlet is likely to act upon more than one item.</span></span>

### <a name="use-pascal-case-for-cmdlet-names-sd02"></a><span data-ttu-id="839c7-130">Använd Pascal-fall för cmdlet-namn (SD02)</span><span class="sxs-lookup"><span data-stu-id="839c7-130">Use Pascal Case for Cmdlet Names (SD02)</span></span>

<span data-ttu-id="839c7-131">Använd Pascal-fall för parameter namn.</span><span class="sxs-lookup"><span data-stu-id="839c7-131">Use Pascal case for parameter names.</span></span> <span data-ttu-id="839c7-132">Med andra ord skriver du in den första bokstaven i verbet och alla termer som används i substantivet.</span><span class="sxs-lookup"><span data-stu-id="839c7-132">In other words, capitalize the first letter of verb and all terms used in the noun.</span></span> <span data-ttu-id="839c7-133">Exempel: "`Clear-ItemProperty`".</span><span class="sxs-lookup"><span data-stu-id="839c7-133">For example, "`Clear-ItemProperty`".</span></span>

### <a name="parameter-design-guidelines-sd03"></a><span data-ttu-id="839c7-134">Rikt linjer för parameter design (SD03)</span><span class="sxs-lookup"><span data-stu-id="839c7-134">Parameter Design Guidelines (SD03)</span></span>

<span data-ttu-id="839c7-135">En cmdlet behöver parametrar som tar emot data som den måste fungera på och parametrar som anger information som används för att fastställa egenskaperna för åtgärden.</span><span class="sxs-lookup"><span data-stu-id="839c7-135">A cmdlet needs parameters that receive the data on which it must operate, and parameters that indicate information that is used to determine the characteristics of the operation.</span></span> <span data-ttu-id="839c7-136">En cmdlet kan till exempel ha en `Name` parameter som tar emot data från pipelinen, och cmdleten kan ha en `Force` parameter för att indikera att cmdleten kan tvingas utföra åtgärden.</span><span class="sxs-lookup"><span data-stu-id="839c7-136">For example, a cmdlet might have a `Name` parameter that receives data from the pipeline, and the cmdlet might have a `Force` parameter to indicate that the cmdlet can be forced to perform its operation.</span></span> <span data-ttu-id="839c7-137">Det finns ingen gräns för antalet parametrar som en cmdlet kan definiera.</span><span class="sxs-lookup"><span data-stu-id="839c7-137">There is no limit to the number of parameters that a cmdlet can define.</span></span>

#### <a name="use-standard-parameter-names"></a><span data-ttu-id="839c7-138">Använd standard parameter namn</span><span class="sxs-lookup"><span data-stu-id="839c7-138">Use Standard Parameter Names</span></span>

<span data-ttu-id="839c7-139">Din cmdlet ska använda standard parameter namn så att användaren snabbt kan fastställa vad en viss parameter innebär.</span><span class="sxs-lookup"><span data-stu-id="839c7-139">Your cmdlet should use standard parameter names so that the user can quickly determine what a particular parameter means.</span></span> <span data-ttu-id="839c7-140">Om ett mer särskilt namn krävs, Använd ett standard parameter namn och ange sedan ett mer särskilt namn som alias.</span><span class="sxs-lookup"><span data-stu-id="839c7-140">If a more specific name is required, use a standard parameter name, and then specify a more specific name as an alias.</span></span> <span data-ttu-id="839c7-141">Till exempel `Get-Service` har cmdleten en parameter som har ett generiskt namn ( `Name` ) och ett mer särskilt alias ( `ServiceName` ).</span><span class="sxs-lookup"><span data-stu-id="839c7-141">For example, the `Get-Service` cmdlet has a  parameter that has a generic name (`Name`) and a more specific alias (`ServiceName`).</span></span> <span data-ttu-id="839c7-142">Båda villkoren kan användas för att ange parametern.</span><span class="sxs-lookup"><span data-stu-id="839c7-142">Both terms can be used to specify the parameter.</span></span>

<span data-ttu-id="839c7-143">Mer information om parameter namn och deras data typer finns i [rikt linjer för cmdlet-parameter namn och funktioner](./standard-cmdlet-parameter-names-and-types.md).</span><span class="sxs-lookup"><span data-stu-id="839c7-143">For more information about parameter names and their data types, see [Cmdlet Parameter Name and Functionality Guidelines](./standard-cmdlet-parameter-names-and-types.md).</span></span>

#### <a name="use-singular-parameter-names"></a><span data-ttu-id="839c7-144">Använd singular parameter namn</span><span class="sxs-lookup"><span data-stu-id="839c7-144">Use Singular Parameter Names</span></span>

<span data-ttu-id="839c7-145">Undvik att använda plural-namn för parametrar vars värde är ett enda element.</span><span class="sxs-lookup"><span data-stu-id="839c7-145">Avoid using plural names for parameters whose value is a single element.</span></span> <span data-ttu-id="839c7-146">Detta inkluderar parametrar som tar matriser eller listor eftersom användaren kan ange en matris eller lista med endast ett-element.</span><span class="sxs-lookup"><span data-stu-id="839c7-146">This includes parameters that take arrays or lists because the user might supply an array or list with only one element.</span></span>

<span data-ttu-id="839c7-147">Plural-parameter namn ska endast användas i de fall där parameterns värde alltid är ett värde för flera element.</span><span class="sxs-lookup"><span data-stu-id="839c7-147">Plural parameter names should be used only in those cases where the value of the parameter is always a multiple-element value.</span></span> <span data-ttu-id="839c7-148">I dessa fall bör cmdleten verifiera att flera element anges och cmdleten ska visa en varning till användaren om flera element inte anges.</span><span class="sxs-lookup"><span data-stu-id="839c7-148">In these cases, the cmdlet should verify that multiple elements are supplied, and the cmdlet should display a warning to the user if multiple elements are not supplied.</span></span>

#### <a name="use-pascal-case-for-parameter-names"></a><span data-ttu-id="839c7-149">Använd Pascal-fall för parameter namn</span><span class="sxs-lookup"><span data-stu-id="839c7-149">Use Pascal Case for Parameter Names</span></span>

<span data-ttu-id="839c7-150">Använd Pascal-fall för parameter namn.</span><span class="sxs-lookup"><span data-stu-id="839c7-150">Use Pascal case for parameter names.</span></span> <span data-ttu-id="839c7-151">Med andra ord skriver du in den första bokstaven i varje ord i parameter namnet, inklusive den första bokstaven i namnet.</span><span class="sxs-lookup"><span data-stu-id="839c7-151">In other words, capitalize the first letter of each word in the parameter name, including the first letter of the name.</span></span> <span data-ttu-id="839c7-152">Parameter namnet använder till exempel `ErrorAction` rätt Skift läge.</span><span class="sxs-lookup"><span data-stu-id="839c7-152">For example, the parameter name `ErrorAction` uses the correct capitalization.</span></span> <span data-ttu-id="839c7-153">Följande parameter namn använder felaktig kapitalisering:</span><span class="sxs-lookup"><span data-stu-id="839c7-153">The following parameter names use incorrect capitalization:</span></span>

- `errorAction`

- `erroraction`

#### <a name="parameters-that-take-a-list-of-options"></a><span data-ttu-id="839c7-154">Parametrar som tar en lista med alternativ</span><span class="sxs-lookup"><span data-stu-id="839c7-154">Parameters That Take a List of Options</span></span>

<span data-ttu-id="839c7-155">Det finns två sätt att skapa en parameter vars värde kan väljas från en uppsättning alternativ.</span><span class="sxs-lookup"><span data-stu-id="839c7-155">There are two ways to create a parameter whose value can be selected from a set of options.</span></span>

- <span data-ttu-id="839c7-156">Definiera en uppräknings typ (eller Använd en befintlig uppräknings typ) som anger giltiga värden.</span><span class="sxs-lookup"><span data-stu-id="839c7-156">Define an enumeration type (or use an existing enumeration type) that specifies the valid values.</span></span> <span data-ttu-id="839c7-157">Använd sedan uppräknings typen för att skapa en parameter av den typen.</span><span class="sxs-lookup"><span data-stu-id="839c7-157">Then, use the enumeration type to create a parameter of that type.</span></span>

- <span data-ttu-id="839c7-158">Lägg till attributet **ValidateSet** i parameter deklarationen.</span><span class="sxs-lookup"><span data-stu-id="839c7-158">Add the **ValidateSet** attribute to the parameter declaration.</span></span> <span data-ttu-id="839c7-159">Mer information om det här attributet finns i [ValidateSet Attribute-deklaration](./validateset-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="839c7-159">For more information about this attribute, see [ValidateSet Attribute Declaration](./validateset-attribute-declaration.md).</span></span>

#### <a name="use-standard-types-for-parameters"></a><span data-ttu-id="839c7-160">Använd standard typer för parametrar</span><span class="sxs-lookup"><span data-stu-id="839c7-160">Use Standard Types for Parameters</span></span>

<span data-ttu-id="839c7-161">Använd standard typer för parametrar där det är möjligt för att säkerställa konsekvens med andra cmdletar.</span><span class="sxs-lookup"><span data-stu-id="839c7-161">To ensure consistency with other cmdlets, use standard types for parameters where ever possible.</span></span> <span data-ttu-id="839c7-162">Mer information om vilka typer som ska användas för olika parametrar finns i [standard parameter namn och typer](./standard-cmdlet-parameter-names-and-types.md).</span><span class="sxs-lookup"><span data-stu-id="839c7-162">For more information about the types that should be used for different parameter, see [Standard Cmdlet Parameter Names and Types](./standard-cmdlet-parameter-names-and-types.md).</span></span> <span data-ttu-id="839c7-163">Det här avsnittet innehåller länkar till flera avsnitt som beskriver namn och .NET Framework typer för grupper med standard parametrar, t. ex. "aktivitets parametrar".</span><span class="sxs-lookup"><span data-stu-id="839c7-163">This topic provides links to several topics that describe the names and .NET Framework types for groups of standard parameters, such as the "activity parameters".</span></span>

#### <a name="use-strongly-typed-net-framework-types"></a><span data-ttu-id="839c7-164">Använd Strongly-Typed .NET Framework typer</span><span class="sxs-lookup"><span data-stu-id="839c7-164">Use Strongly-Typed .NET Framework Types</span></span>

<span data-ttu-id="839c7-165">Parametrar ska definieras som .NET Framework typer för att ge bättre parameter validering.</span><span class="sxs-lookup"><span data-stu-id="839c7-165">Parameters should be defined as .NET Framework types to provide better parameter validation.</span></span> <span data-ttu-id="839c7-166">Till exempel ska parametrar som är begränsade till ett värde från en uppsättning värden definieras som en uppräknings typ.</span><span class="sxs-lookup"><span data-stu-id="839c7-166">For example, parameters that are restricted to one value from a set of values should be defined as an enumeration type.</span></span> <span data-ttu-id="839c7-167">För att stödja ett Uniform Resource Identifier (URI)-värde definierar du parametern som en [system. URI](/dotnet/api/System.Uri) -typ.</span><span class="sxs-lookup"><span data-stu-id="839c7-167">To support a Uniform Resource Identifier (URI) value, define the parameter as a [System.Uri](/dotnet/api/System.Uri) type.</span></span> <span data-ttu-id="839c7-168">Undvik grundläggande sträng parametrar för alla fält med fri Forms egenskaper.</span><span class="sxs-lookup"><span data-stu-id="839c7-168">Avoid basic string parameters for all but free-form text properties.</span></span>

#### <a name="use-consistent-parameter-types"></a><span data-ttu-id="839c7-169">Använd konsekventa parameter typer</span><span class="sxs-lookup"><span data-stu-id="839c7-169">Use Consistent Parameter Types</span></span>

<span data-ttu-id="839c7-170">Använd alltid samma parameter typ när samma parameter används av flera cmdletar.</span><span class="sxs-lookup"><span data-stu-id="839c7-170">When the same parameter is used by multiple cmdlets, always use the same parameter type.</span></span>  <span data-ttu-id="839c7-171">Om parametern till exempel `Process` är en [system. Int16](/dotnet/api/System.Int16) -typ för en cmdlet ska du inte göra `Process` parametern för en annan cmdlet: en [system. Uint16](/dotnet/api/System.UInt16) -typ.</span><span class="sxs-lookup"><span data-stu-id="839c7-171">For example, if the `Process` parameter is an [System.Int16](/dotnet/api/System.Int16) type for one cmdlet, do not make the `Process` parameter for another cmdlet a [System.Uint16](/dotnet/api/System.UInt16) type.</span></span>

#### <a name="parameters-that-take-true-and-false"></a><span data-ttu-id="839c7-172">Parametrar som tar sant och falskt</span><span class="sxs-lookup"><span data-stu-id="839c7-172">Parameters That Take True and False</span></span>

<span data-ttu-id="839c7-173">Om parametern bara tar `true` och `false` definierar du parametern som Type [system. Management. Automation. SwitchParameter](/dotnet/api/System.Management.Automation.SwitchParameter).</span><span class="sxs-lookup"><span data-stu-id="839c7-173">If your parameter takes only `true` and `false`, define the parameter as type [System.Management.Automation.SwitchParameter](/dotnet/api/System.Management.Automation.SwitchParameter).</span></span> <span data-ttu-id="839c7-174">En växel parameter behandlas som `true` när den anges i ett kommando.</span><span class="sxs-lookup"><span data-stu-id="839c7-174">A switch parameter is treated as `true` when it is specified in a command.</span></span> <span data-ttu-id="839c7-175">Om parametern inte ingår i ett kommando, anses värdet för parametern vara i Windows PowerShell `false` .</span><span class="sxs-lookup"><span data-stu-id="839c7-175">If the parameter is not included in a command, Windows PowerShell considers the value of the parameter to be `false`.</span></span> <span data-ttu-id="839c7-176">Definiera inte booleska parametrar.</span><span class="sxs-lookup"><span data-stu-id="839c7-176">Do not define Boolean parameters.</span></span>

<span data-ttu-id="839c7-177">Om parametern behöver särskilja mellan tre värden: $true, $false och "ospecificerad", definierar du en parameter av typen Nullable \<bool> .</span><span class="sxs-lookup"><span data-stu-id="839c7-177">If your parameter needs to differentiate between 3 values: $true, $false and "unspecified", then define a parameter of type Nullable\<bool>.</span></span>  <span data-ttu-id="839c7-178">Behovet av ett tredje, "Ospecificerat" värde inträffar vanligt vis när cmdleten kan ändra en Boolean-egenskap för ett objekt.</span><span class="sxs-lookup"><span data-stu-id="839c7-178">The need for a 3rd, "unspecified" value typically occurs when the cmdlet can modify a Boolean property of an object.</span></span> <span data-ttu-id="839c7-179">I det här fallet "Ospecificerat" innebär att egenskapens aktuella värde inte ändras.</span><span class="sxs-lookup"><span data-stu-id="839c7-179">In this case "unspecified" means to not change the current value of the property.</span></span>

#### <a name="support-arrays-for-parameters"></a><span data-ttu-id="839c7-180">Stöd mat ris för parametrar</span><span class="sxs-lookup"><span data-stu-id="839c7-180">Support Arrays for Parameters</span></span>

<span data-ttu-id="839c7-181">Användare måste ofta utföra samma åtgärd mot flera argument.</span><span class="sxs-lookup"><span data-stu-id="839c7-181">Frequently, users must perform the same operation against multiple arguments.</span></span> <span data-ttu-id="839c7-182">För dessa användare ska en cmdlet acceptera en matris som parameter indata så att en användare kan skicka argumenten till parametern som en Windows PowerShell-variabel.</span><span class="sxs-lookup"><span data-stu-id="839c7-182">For these users, a cmdlet should accept an array as parameter input so that a user can pass the arguments into the parameter as a Windows PowerShell variable.</span></span> <span data-ttu-id="839c7-183">Till exempel använder cmdleten [Get-process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) en matris för strängarna som identifierar namnen på de processer som ska hämtas.</span><span class="sxs-lookup"><span data-stu-id="839c7-183">For example, the [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) cmdlet uses an array for the strings that identify the names of the processes to retrieve.</span></span>

#### <a name="support-the-passthru-parameter"></a><span data-ttu-id="839c7-184">Stöd för parametern PassThru</span><span class="sxs-lookup"><span data-stu-id="839c7-184">Support the PassThru Parameter</span></span>

<span data-ttu-id="839c7-185">Som standard fungerar många cmdlets som ändrar systemet, till exempel cmdleten [Stop process](/powershell/module/Microsoft.PowerShell.Management/Stop-Process) , som "Sinks" för objekt och returnerar inte ett resultat.</span><span class="sxs-lookup"><span data-stu-id="839c7-185">By default, many cmdlets that modify the system, such as the [Stop-Process](/powershell/module/Microsoft.PowerShell.Management/Stop-Process) cmdlet, act as "sinks" for objects and do not return a result.</span></span> <span data-ttu-id="839c7-186">Denna cmdlet ska implementera `PassThru` parametern för att tvinga cmdleten att returnera ett objekt.</span><span class="sxs-lookup"><span data-stu-id="839c7-186">These cmdlet should implement the `PassThru` parameter to force the cmdlet to return an object.</span></span> <span data-ttu-id="839c7-187">När `PassThru` parametern anges returnerar cmdleten ett objekt genom att använda ett anrop till metoden [system. Management. Automation. cmdlet. WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) .</span><span class="sxs-lookup"><span data-stu-id="839c7-187">When the `PassThru` parameter is specified, the cmdlet returns an object by using a call to the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="839c7-188">Följande kommando stoppar till exempel processen Calc och skickar den resulterande processen till pipelinen.</span><span class="sxs-lookup"><span data-stu-id="839c7-188">For example, the following command stops the Calc process and passes the resultant process to the pipeline.</span></span>

```powershell
Stop-Process calc -passthru
```

<span data-ttu-id="839c7-189">I de flesta fall ska Lägg till, ange och nya cmdletar ha stöd för en `PassThru` parameter.</span><span class="sxs-lookup"><span data-stu-id="839c7-189">In most cases, Add, Set, and New cmdlets should support a `PassThru` parameter.</span></span>

#### <a name="support-parameter-sets"></a><span data-ttu-id="839c7-190">Stöd parameter uppsättningar</span><span class="sxs-lookup"><span data-stu-id="839c7-190">Support Parameter Sets</span></span>

<span data-ttu-id="839c7-191">En cmdlet är avsedd att utföra ett enda syfte.</span><span class="sxs-lookup"><span data-stu-id="839c7-191">A cmdlet is intended to accomplish a single purpose.</span></span> <span data-ttu-id="839c7-192">Det finns dock ofta mer än ett sätt att beskriva åtgärden eller åtgärds målet.</span><span class="sxs-lookup"><span data-stu-id="839c7-192">However, there is frequently more than one way to describe the operation or the operation target.</span></span> <span data-ttu-id="839c7-193">En process kan till exempel identifieras med sitt namn, med dess identifierare eller av ett process objekt.</span><span class="sxs-lookup"><span data-stu-id="839c7-193">For example, a process might be identified by its name, by its identifier, or by a process object.</span></span> <span data-ttu-id="839c7-194">Cmdleten ska ha stöd för alla rimliga representationer av sina mål.</span><span class="sxs-lookup"><span data-stu-id="839c7-194">The cmdlet should support all the reasonable representations of its targets.</span></span> <span data-ttu-id="839c7-195">Normalt uppfyller cmdleten detta krav genom att ange uppsättningar med parametrar (kallas parameter uppsättningar) som fungerar tillsammans.</span><span class="sxs-lookup"><span data-stu-id="839c7-195">Normally, the cmdlet satisfies this requirement by specifying sets of parameters (referred to as parameter sets) that operate together.</span></span> <span data-ttu-id="839c7-196">En enskild parameter kan tillhöra valfritt antal parameter uppsättningar.</span><span class="sxs-lookup"><span data-stu-id="839c7-196">A single parameter can belong to any number of parameter sets.</span></span> <span data-ttu-id="839c7-197">Mer information om parameter uppsättningar finns i [cmdlet parameter Sets](./cmdlet-parameter-sets.md).</span><span class="sxs-lookup"><span data-stu-id="839c7-197">For more information about parameter sets, see [Cmdlet Parameter Sets](./cmdlet-parameter-sets.md).</span></span>

<span data-ttu-id="839c7-198">När du anger parameter uppsättningar anger du endast en parameter i uppsättningen till ValueFromPipeline.</span><span class="sxs-lookup"><span data-stu-id="839c7-198">When you specify parameter sets, set only one parameter in the set to ValueFromPipeline.</span></span> <span data-ttu-id="839c7-199">Mer information om hur du deklarerar attributet **parameter** finns i [ParameterAttribute-deklaration](./parameter-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="839c7-199">For more information about how to declare the **Parameter** attribute, see [ParameterAttribute Declaration](./parameter-attribute-declaration.md).</span></span>

<span data-ttu-id="839c7-200">När parameter uppsättningar används definieras standard parameter uppsättningen av **cmdlet** -attributet.</span><span class="sxs-lookup"><span data-stu-id="839c7-200">When parameter sets are used, the default parameter set is defined by the **Cmdlet** attribute.</span></span> <span data-ttu-id="839c7-201">Standard parameter uppsättningen bör innehålla de parametrar som troligen används i en interaktiv Windows PowerShell-session.</span><span class="sxs-lookup"><span data-stu-id="839c7-201">The default parameter set should include the parameters most likely to be used in an interactive Windows PowerShell session.</span></span> <span data-ttu-id="839c7-202">Mer information om hur du deklarerar **cmdlet** -attributet finns i [CmdletAttribute-deklaration](./cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="839c7-202">For more information about how to declare the **Cmdlet** attribute, see [CmdletAttribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

### <a name="provide-feedback-to-the-user-sd04"></a><span data-ttu-id="839c7-203">Ge feedback till användaren (SD04)</span><span class="sxs-lookup"><span data-stu-id="839c7-203">Provide Feedback to the User (SD04)</span></span>

<span data-ttu-id="839c7-204">Använd rikt linjerna i det här avsnittet för att ge feedback till användaren.</span><span class="sxs-lookup"><span data-stu-id="839c7-204">Use the guidelines in this section to provide feedback to the user.</span></span> <span data-ttu-id="839c7-205">Den här feedbacken gör att användaren kan vara medveten om vad som händer i systemet och fatta bättre administrativa beslut.</span><span class="sxs-lookup"><span data-stu-id="839c7-205">This feedback allows the user to be aware of what is occurring in the system and to make better administrative decisions.</span></span>

<span data-ttu-id="839c7-206">Med Windows PowerShell runtime kan en användare ange hur utdata ska hanteras från varje anrop till- `Write` metoden genom att ange en inställnings variabel.</span><span class="sxs-lookup"><span data-stu-id="839c7-206">The Windows PowerShell runtime allows a user to specify how to handle output from each call to the `Write` method by setting a preference variable.</span></span> <span data-ttu-id="839c7-207">Användaren kan ange flera variabler, inklusive en variabel som avgör om systemet ska visa information och en variabel som avgör om systemet ska fråga användaren innan ytterligare åtgärder vidtas.</span><span class="sxs-lookup"><span data-stu-id="839c7-207">The user can set several preference variables, including a variable that determines whether the system should display information and a variable that determines whether the system should query the user before taking further action.</span></span>

#### <a name="support-the-writewarning-writeverbose-and-writedebug-methods"></a><span data-ttu-id="839c7-208">Stöd för metoderna WriteWarning, WriteVerbose och WriteDebug</span><span class="sxs-lookup"><span data-stu-id="839c7-208">Support the WriteWarning, WriteVerbose, and WriteDebug Methods</span></span>

<span data-ttu-id="839c7-209">En cmdlet ska anropa metoden [system. Management. Automation. cmdlet. WriteWarning](/dotnet/api/System.Management.Automation.Cmdlet.WriteWarning) när cmdleten är på väg att utföra en åtgärd som kan ha ett oavsiktligt resultat.</span><span class="sxs-lookup"><span data-stu-id="839c7-209">A cmdlet should call the [System.Management.Automation.Cmdlet.WriteWarning](/dotnet/api/System.Management.Automation.Cmdlet.WriteWarning) method when the cmdlet is about to perform an operation that might have an unintended result.</span></span> <span data-ttu-id="839c7-210">Till exempel ska en cmdlet anropa den här metoden om cmdleten är på väg att skriva över en skrivskyddad fil.</span><span class="sxs-lookup"><span data-stu-id="839c7-210">For example, a cmdlet should call this method if the cmdlet is about to overwrite a read-only file.</span></span>

<span data-ttu-id="839c7-211">En cmdlet ska anropa metoden [system. Management. Automation. cmdlet. WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) när användaren behöver information om vad cmdleten gör.</span><span class="sxs-lookup"><span data-stu-id="839c7-211">A cmdlet should call the [System.Management.Automation.Cmdlet.WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) method when the user requires some detail about what the cmdlet is doing.</span></span> <span data-ttu-id="839c7-212">Till exempel ska en-cmdlet anropa den här informationen om cmdlet-författaren anser att det finns scenarier som kan kräva mer information om vad cmdleten gör.</span><span class="sxs-lookup"><span data-stu-id="839c7-212">For example, a cmdlet should call this information if the cmdlet author feels that there are scenarios that might require more information about what the cmdlet is doing.</span></span>

<span data-ttu-id="839c7-213">Cmdleten ska anropa metoden [system. Management. Automation. cmdlet. WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) när en utvecklare eller en produkt support tekniker måste förstå vad som har skadat cmdlet-åtgärden.</span><span class="sxs-lookup"><span data-stu-id="839c7-213">The cmdlet should call the [System.Management.Automation.Cmdlet.WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) method when a developer or product support engineer must understand what has corrupted the cmdlet operation.</span></span> <span data-ttu-id="839c7-214">Det är inte nödvändigt att cmdleten anropar metoden [system. Management. Automation. cmdlet. WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) i samma kod som anropar metoden [system. Management. Automation. cmdlet. WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) eftersom `Debug` parametern visar båda uppsättningarna med information.</span><span class="sxs-lookup"><span data-stu-id="839c7-214">It is not necessary for the cmdlet to call the [System.Management.Automation.Cmdlet.WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) method in the same code that calls the [System.Management.Automation.Cmdlet.WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) method because the `Debug` parameter presents both sets of information.</span></span>

#### <a name="support-writeprogress-for-operations-that-take-a-long-time"></a><span data-ttu-id="839c7-215">Stöd för WriteProgress för åtgärder som tar lång tid</span><span class="sxs-lookup"><span data-stu-id="839c7-215">Support WriteProgress for Operations that take a Long Time</span></span>

<span data-ttu-id="839c7-216">Cmdlet-åtgärder som tar lång tid att slutföra och som inte kan köras i bakgrunden bör ha stöd för förlopps rapportering via periodiska anrop till metoden [system. Management. Automation. cmdlet. WriteProgress](/dotnet/api/System.Management.Automation.Cmdlet.WriteProgress) .</span><span class="sxs-lookup"><span data-stu-id="839c7-216">Cmdlet operations that take a long time to complete and that cannot run in the background should support progress reporting through periodic calls to the [System.Management.Automation.Cmdlet.WriteProgress](/dotnet/api/System.Management.Automation.Cmdlet.WriteProgress) method.</span></span>

#### <a name="use-the-host-interfaces"></a><span data-ttu-id="839c7-217">Använd värd gränssnitten</span><span class="sxs-lookup"><span data-stu-id="839c7-217">Use the Host Interfaces</span></span>

<span data-ttu-id="839c7-218">Ibland måste en cmdlet kommunicera direkt med användaren i stället för genom att använda de olika Skriv-eller-metoderna som stöds av klassen [system. Management. Automation. cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) .</span><span class="sxs-lookup"><span data-stu-id="839c7-218">Occasionally, a cmdlet must communicate directly with the user instead of by using the various Write or Should methods supported by the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class.</span></span> <span data-ttu-id="839c7-219">I det här fallet ska cmdleten härledas från klassen [system. Management. Automation. PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) och använda egenskapen [system. Management. Automation. PSCmdlet. Host \*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) .</span><span class="sxs-lookup"><span data-stu-id="839c7-219">In this case, the cmdlet should derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class and use the [System.Management.Automation.PSCmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) property.</span></span> <span data-ttu-id="839c7-220">Den här egenskapen stöder olika kommunikations typer, inklusive typerna PromptForChoice, prompt och WriteLine/ReadLine.</span><span class="sxs-lookup"><span data-stu-id="839c7-220">This property supports different levels of communication type, including the PromptForChoice, Prompt, and WriteLine/ReadLine types.</span></span> <span data-ttu-id="839c7-221">På den mest specifika nivån ger det också olika sätt att läsa och skriva enskilda nycklar och att hantera buffertar.</span><span class="sxs-lookup"><span data-stu-id="839c7-221">At the most specific level, it also provides ways to read and write individual keys and to deal with buffers.</span></span>

<span data-ttu-id="839c7-222">Såvida inte en cmdlet är särskilt utformad för att generera ett grafiskt användar gränssnitt (GUI) bör den inte kringgå värden med hjälp av egenskapen [system. Management. Automation. PSCmdlet. Host \*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) .</span><span class="sxs-lookup"><span data-stu-id="839c7-222">Unless a cmdlet is specifically designed to generate a graphical user interface (GUI), it should not bypass the host by using the [System.Management.Automation.PSCmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) property.</span></span> <span data-ttu-id="839c7-223">Ett exempel på en cmdlet som är utformad för att generera ett grafiskt användar gränssnitt är cmdleten [out-GridView](/powershell/module/Microsoft.PowerShell.Utility/Out-GridView) .</span><span class="sxs-lookup"><span data-stu-id="839c7-223">An example of a cmdlet that is designed to generate a GUI is the [Out-GridView](/powershell/module/Microsoft.PowerShell.Utility/Out-GridView) cmdlet.</span></span>

> [!NOTE]
> <span data-ttu-id="839c7-224">Cmdletar ska inte använda [system. Console](/dotnet/api/System.Console) -API: et.</span><span class="sxs-lookup"><span data-stu-id="839c7-224">Cmdlets should not use the [System.Console](/dotnet/api/System.Console) API.</span></span>

### <a name="create-a-cmdlet-help-file-sd05"></a><span data-ttu-id="839c7-225">Skapa en hjälp fil för cmdlet (SD05)</span><span class="sxs-lookup"><span data-stu-id="839c7-225">Create a Cmdlet Help File (SD05)</span></span>

<span data-ttu-id="839c7-226">Skapa en Help.xml-fil som innehåller information om cmdleten för varje cmdlet-sammansättning.</span><span class="sxs-lookup"><span data-stu-id="839c7-226">For each cmdlet assembly, create a Help.xml file that contains information about the cmdlet.</span></span> <span data-ttu-id="839c7-227">Den här informationen innehåller en beskrivning av cmdleten, beskrivningar av cmdletens parametrar, exempel på cmdlet: en, med mera.</span><span class="sxs-lookup"><span data-stu-id="839c7-227">This information includes a description of the cmdlet, descriptions of the cmdlet's parameters, examples of the cmdlet's use, and more.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="839c7-228">Kod rikt linjer</span><span class="sxs-lookup"><span data-stu-id="839c7-228">Code Guidelines</span></span>

<span data-ttu-id="839c7-229">Följande rikt linjer bör följas när du kodar cmdletar för att säkerställa en konsekvent användar upplevelse mellan att använda dina cmdletar och andra cmdletar.</span><span class="sxs-lookup"><span data-stu-id="839c7-229">The following guidelines should be followed when coding cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="839c7-230">När du hittar en kod rikt linje som gäller för din situation bör du läsa rikt linjerna för utformning av liknande rikt linjer.</span><span class="sxs-lookup"><span data-stu-id="839c7-230">When you find a Code guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="coding-parameters-sc01"></a><span data-ttu-id="839c7-231">Kodnings parametrar (SC01)</span><span class="sxs-lookup"><span data-stu-id="839c7-231">Coding Parameters (SC01)</span></span>

<span data-ttu-id="839c7-232">Definiera en parameter genom att deklarera en offentlig egenskap för cmdlet-klassen som är dekorerad med attributet **parameter** .</span><span class="sxs-lookup"><span data-stu-id="839c7-232">Define a parameter by declaring a public property of the cmdlet class that is decorated with the **Parameter** attribute.</span></span> <span data-ttu-id="839c7-233">Parametrarna behöver inte vara statiska medlemmar i den härledda .NET Frameworks klassen för cmdleten.</span><span class="sxs-lookup"><span data-stu-id="839c7-233">Parameters do not have to be static members of the derived .NET Framework class for the cmdlet.</span></span> <span data-ttu-id="839c7-234">Mer information om hur du deklarerar attributet **parameter** finns i [deklaration av parameter attribut](./parameter-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="839c7-234">For more information about how to declare the **Parameter** attribute, see [Parameter Attribute Declaration](./parameter-attribute-declaration.md).</span></span>

#### <a name="support-windows-powershell-paths"></a><span data-ttu-id="839c7-235">Stöd för Windows PowerShell-sökvägar</span><span class="sxs-lookup"><span data-stu-id="839c7-235">Support Windows PowerShell Paths</span></span>

<span data-ttu-id="839c7-236">Windows PowerShell-sökvägen är mekanismen för att normalisera åtkomst till namn områden.</span><span class="sxs-lookup"><span data-stu-id="839c7-236">The Windows PowerShell path is the mechanism for normalizing access to namespaces.</span></span> <span data-ttu-id="839c7-237">När du tilldelar en Windows PowerShell-sökväg till en parameter i cmdleten kan användaren definiera en anpassad "enhet" som fungerar som en genväg till en angiven sökväg.</span><span class="sxs-lookup"><span data-stu-id="839c7-237">When you assign a Windows PowerShell path to a parameter in the cmdlet, the user can define a custom "drive" that acts as a shortcut to a specific path.</span></span> <span data-ttu-id="839c7-238">När en användare anger en sådan enhet, kan lagrade data, till exempel data i registret, användas på ett konsekvent sätt.</span><span class="sxs-lookup"><span data-stu-id="839c7-238">When a user designates such a drive, stored data, such as data in the Registry, can be used in a consistent way.</span></span>

<span data-ttu-id="839c7-239">Om din cmdlet gör det möjligt för användaren att ange en fil eller en data källa, bör den definiera en parameter av typen [system. String](/dotnet/api/System.String).</span><span class="sxs-lookup"><span data-stu-id="839c7-239">If your cmdlet allows the user to specify a file or a data source, it should define a parameter of type [System.String](/dotnet/api/System.String).</span></span> <span data-ttu-id="839c7-240">Om mer än en enhet stöds måste typen vara en matris.</span><span class="sxs-lookup"><span data-stu-id="839c7-240">If more than one drive is supported, the type should be an array.</span></span> <span data-ttu-id="839c7-241">Namnet på parametern ska vara `Path` , med ett alias för `PSPath` .</span><span class="sxs-lookup"><span data-stu-id="839c7-241">The name of the parameter should be `Path`, with an alias of `PSPath`.</span></span> <span data-ttu-id="839c7-242">Dessutom `Path` ska parametern ha stöd för jokertecken.</span><span class="sxs-lookup"><span data-stu-id="839c7-242">Additionally, the `Path` parameter should support wildcard characters.</span></span> <span data-ttu-id="839c7-243">Om det inte krävs stöd för jokertecken definierar du en `LiteralPath` parameter.</span><span class="sxs-lookup"><span data-stu-id="839c7-243">If support for wildcard characters is not required, define a `LiteralPath` parameter.</span></span>

<span data-ttu-id="839c7-244">Om data som cmdleten läser eller skriver måste vara en fil, ska cmdleten acceptera Windows PowerShell Path-indata och cmdleten ska använda egenskapen [system. Management. Automation. sessionState. Path](/dotnet/api/System.Management.Automation.SessionState.Path) för att översätta Windows PowerShell-sökvägar till sökvägar som fil systemet känner igen.</span><span class="sxs-lookup"><span data-stu-id="839c7-244">If the data that the cmdlet reads or writes has to be a file, the cmdlet should accept Windows PowerShell path input, and the cmdlet should use the [System.Management.Automation.Sessionstate.Path](/dotnet/api/System.Management.Automation.SessionState.Path) property to translate the Windows PowerShell paths into paths that the file system recognizes.</span></span> <span data-ttu-id="839c7-245">De olika mekanismerna omfattar följande metoder:</span><span class="sxs-lookup"><span data-stu-id="839c7-245">The specific mechanisms include the following methods:</span></span>

- [<span data-ttu-id="839c7-246">System. Management. Automation. PSCmdlet. GetResolvedProviderPathFromPSPath</span><span class="sxs-lookup"><span data-stu-id="839c7-246">System.Management.Automation.PSCmdlet.GetResolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PSCmdlet.GetResolvedProviderPathFromPSPath)

- [<span data-ttu-id="839c7-247">System. Management. Automation. PSCmdlet. GetUnresolvedProviderPathFromPSPath</span><span class="sxs-lookup"><span data-stu-id="839c7-247">System.Management.Automation.PSCmdlet.GetUnresolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PSCmdlet.GetUnresolvedProviderPathFromPSPath)

- [<span data-ttu-id="839c7-248">System. Management. Automation. PathIntrinsics. GetResolvedProviderPathFromPSPath</span><span class="sxs-lookup"><span data-stu-id="839c7-248">System.Management.Automation.PathIntrinsics.GetResolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PathIntrinsics.GetResolvedProviderPathFromPSPath)

- [<span data-ttu-id="839c7-249">System. Management. Automation. PathIntrinsics. GetUnresolvedProviderPathFromPSPath</span><span class="sxs-lookup"><span data-stu-id="839c7-249">System.Management.Automation.PathIntrinsics.GetUnresolvedProviderPathFromPSPath</span></span>](/dotnet/api/System.Management.Automation.PathIntrinsics.GetUnresolvedProviderPathFromPSPath)

<span data-ttu-id="839c7-250">Om data som-cmdlet: en läser eller skriver bara är en uppsättning strängar i stället för en fil, ska cmdleten använda providerns innehålls information ( `Content` medlem) för att läsa och skriva.</span><span class="sxs-lookup"><span data-stu-id="839c7-250">If the data that the cmdlet reads or writes is only a set of strings instead of a file, the cmdlet should use the provider content information (`Content` member) to read and write.</span></span> <span data-ttu-id="839c7-251">Den här informationen hämtas från egenskapen [system. Management. Automation. Provider. CmdletProvider. InvokeProvider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.InvokeProvider) .</span><span class="sxs-lookup"><span data-stu-id="839c7-251">This information is obtained from the [System.Management.Automation.Provider.CmdletProvider.InvokeProvider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.InvokeProvider) property.</span></span> <span data-ttu-id="839c7-252">Dessa metoder gör det möjligt för andra data lager att delta i läsning och skrivning av data.</span><span class="sxs-lookup"><span data-stu-id="839c7-252">These mechanisms allow other data stores to participate in the reading and writing of data.</span></span>

#### <a name="support-wildcard-characters"></a><span data-ttu-id="839c7-253">Stöd för jokertecken</span><span class="sxs-lookup"><span data-stu-id="839c7-253">Support Wildcard Characters</span></span>

<span data-ttu-id="839c7-254">En cmdlet måste ha stöd för jokertecken om det är möjligt.</span><span class="sxs-lookup"><span data-stu-id="839c7-254">A cmdlet should support wildcard characters if possible.</span></span> <span data-ttu-id="839c7-255">Stöd för jokertecken förekommer på många platser i en cmdlet (särskilt när en parameter tar en sträng för att identifiera ett objekt från en uppsättning objekt).</span><span class="sxs-lookup"><span data-stu-id="839c7-255">Support for wildcard characters occurs in many places in a cmdlet (especially when a parameter takes a string to identify one object from a set of objects).</span></span> <span data-ttu-id="839c7-256">Exempel: **Stop-proc-** cmdleten från StopProc- [självstudien](./stopproc-tutorial.md) definierar till exempel en `Name` parameter för att hantera strängar som representerar process namn.</span><span class="sxs-lookup"><span data-stu-id="839c7-256">For example, the sample **Stop-Proc** cmdlet from the [StopProc Tutorial](./stopproc-tutorial.md) defines a `Name` parameter to handle strings that represent process names.</span></span> <span data-ttu-id="839c7-257">Den här parametern stöder jokertecken så att användaren enkelt kan ange vilka processer som ska stoppas.</span><span class="sxs-lookup"><span data-stu-id="839c7-257">This parameter supports wildcard characters so that the user can easily specify the processes to stop.</span></span>

<span data-ttu-id="839c7-258">När stöd för jokertecken är tillgängligt skapar en cmdlet-åtgärd vanligt vis en matris.</span><span class="sxs-lookup"><span data-stu-id="839c7-258">When support for wildcard characters is available, a cmdlet operation usually produces an array.</span></span> <span data-ttu-id="839c7-259">Ibland är det inte meningsfullt att stödja en matris eftersom användaren bara kan använda ett enda objekt i taget.</span><span class="sxs-lookup"><span data-stu-id="839c7-259">Occasionally, it does not make sense to support an array because the user might use only a single item at a time.</span></span> <span data-ttu-id="839c7-260">Till exempel behöver cmdleten [set-location](/powershell/module/Microsoft.PowerShell.Management/Set-Location) inte stöd för en matris eftersom användaren bara anger en enda plats.</span><span class="sxs-lookup"><span data-stu-id="839c7-260">For example, the [Set-Location](/powershell/module/Microsoft.PowerShell.Management/Set-Location) cmdlet does not need to support an array because the user is setting only a single location.</span></span> <span data-ttu-id="839c7-261">I den här instansen stöder cmdlet: en fortfarande jokertecken, men den framtvingar matchning till en enda plats.</span><span class="sxs-lookup"><span data-stu-id="839c7-261">In this instance, the cmdlet still supports wildcard characters, but it forces resolution to a single location.</span></span>

<span data-ttu-id="839c7-262">Mer information om mönster med jokertecken finns i [stödjande jokertecken i cmdlet-parametrar](./supporting-wildcard-characters-in-cmdlet-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="839c7-262">For more information about wildcard-character patterns, see [Supporting Wildcard Characters in Cmdlet Parameters](./supporting-wildcard-characters-in-cmdlet-parameters.md).</span></span>

#### <a name="defining-objects"></a><span data-ttu-id="839c7-263">Definiera objekt</span><span class="sxs-lookup"><span data-stu-id="839c7-263">Defining Objects</span></span>

<span data-ttu-id="839c7-264">Det här avsnittet innehåller rikt linjer för att definiera objekt för cmdlets och för att utöka befintliga objekt.</span><span class="sxs-lookup"><span data-stu-id="839c7-264">This section contains guidelines for defining objects for cmdlets and for extending existing objects.</span></span>

##### <a name="define-standard-members"></a><span data-ttu-id="839c7-265">Definiera standard medlemmar</span><span class="sxs-lookup"><span data-stu-id="839c7-265">Define Standard Members</span></span>

<span data-ttu-id="839c7-266">Definiera standard medlemmar för att utöka en objekt typ i en anpassad Types.ps1XML-fil (Använd Windows PowerShell-Types.ps1XML-fil som mall).</span><span class="sxs-lookup"><span data-stu-id="839c7-266">Define standard members to extend an object type in a custom Types.ps1xml file (use the Windows PowerShell Types.ps1xml file as a template).</span></span> <span data-ttu-id="839c7-267">Standard medlemmar definieras av en nod med namnet PSStandardMembers.</span><span class="sxs-lookup"><span data-stu-id="839c7-267">Standard members are defined by a node with the name PSStandardMembers.</span></span> <span data-ttu-id="839c7-268">Dessa definitioner gör det möjligt för andra cmdletar och Windows PowerShell-körningsmiljön att arbeta med ditt objekt på ett konsekvent sätt.</span><span class="sxs-lookup"><span data-stu-id="839c7-268">These definitions allow other cmdlets and the Windows PowerShell runtime to work with your object in a consistent way.</span></span>

##### <a name="define-objectmembers-to-be-used-as-parameters"></a><span data-ttu-id="839c7-269">Definiera ObjectMembers som ska användas som parametrar</span><span class="sxs-lookup"><span data-stu-id="839c7-269">Define ObjectMembers to Be Used as Parameters</span></span>

<span data-ttu-id="839c7-270">Om du skapar ett objekt för en cmdlet bör du se till att dess medlemmar mappar direkt till parametrarna för de cmdletar som ska använda den.</span><span class="sxs-lookup"><span data-stu-id="839c7-270">If you are designing an object for a cmdlet, ensure that its members map directly to the parameters of the cmdlets that will use it.</span></span> <span data-ttu-id="839c7-271">Med den här mappningen kan objektet enkelt skickas till pipelinen och skickas från en-cmdlet till en annan.</span><span class="sxs-lookup"><span data-stu-id="839c7-271">This mapping allows the object to be easily sent to the pipeline and to be passed from one cmdlet to another.</span></span>

<span data-ttu-id="839c7-272">Befintliga .NET Framework objekt som returneras av cmdlets ofta saknar vissa viktiga eller praktiska medlemmar som krävs av skript utvecklaren eller användaren.</span><span class="sxs-lookup"><span data-stu-id="839c7-272">Preexisting .NET Framework objects that are returned by cmdlets are frequently missing some important or convenient members that are needed by the script developer or user.</span></span> <span data-ttu-id="839c7-273">De medlemmar som saknas kan vara särskilt viktiga för att visa och för att skapa rätt medlems namn så att objektet kan skickas korrekt till pipelinen.</span><span class="sxs-lookup"><span data-stu-id="839c7-273">These missing members can be particularly important for display and for creating the correct member names so that the object can be correctly passed to the pipeline.</span></span> <span data-ttu-id="839c7-274">Skapa en anpassad Types.ps1XML-fil för att dokumentera de nödvändiga medlemmarna.</span><span class="sxs-lookup"><span data-stu-id="839c7-274">Create a custom Types.ps1xml file to document these required members.</span></span> <span data-ttu-id="839c7-275">När du skapar den här filen rekommenderar vi följande namngivnings konvention: *<Your_Product_Name>* .Types.ps1XML.</span><span class="sxs-lookup"><span data-stu-id="839c7-275">When you create this file, we recommend the following naming convention: *<Your_Product_Name>* .Types.ps1xml.</span></span>

<span data-ttu-id="839c7-276">Du kan till exempel lägga till en `Mode` skript egenskap i typen [system. io. fileinfo](/dotnet/api/System.IO.FileInfo) för att visa attributen för en fil tydligare.</span><span class="sxs-lookup"><span data-stu-id="839c7-276">For example, you could add a `Mode` script property to the [System.IO.FileInfo](/dotnet/api/System.IO.FileInfo) type to display the attributes of a file more clearly.</span></span> <span data-ttu-id="839c7-277">Dessutom kan du lägga till en `Count` aliasresurspost till [system. mat ris](/dotnet/api/System.Array) typen för att tillåta konsekvent användning av egenskaps namnet (i stället för `Length` ).</span><span class="sxs-lookup"><span data-stu-id="839c7-277">Additionally, you could add a `Count` alias property to the [System.Array](/dotnet/api/System.Array) type to allow the consistent use of that property name (instead of `Length`).</span></span>

##### <a name="implement-the-icomparable-interface"></a><span data-ttu-id="839c7-278">Implementera IComparable-gränssnittet</span><span class="sxs-lookup"><span data-stu-id="839c7-278">Implement the IComparable Interface</span></span>

<span data-ttu-id="839c7-279">Implementera ett [system. IComparable](/dotnet/api/System.IComparable) -gränssnitt på alla utgående objekt.</span><span class="sxs-lookup"><span data-stu-id="839c7-279">Implement a [System.IComparable](/dotnet/api/System.IComparable) interface on all output objects.</span></span> <span data-ttu-id="839c7-280">Detta gör att utmatnings objekt enkelt kan skickas till olika sorterings-och analys-cmdletar.</span><span class="sxs-lookup"><span data-stu-id="839c7-280">This allows the output objects to be easily piped to various sorting and analysis cmdlets.</span></span>

##### <a name="update-display-information"></a><span data-ttu-id="839c7-281">Uppdatera visnings information</span><span class="sxs-lookup"><span data-stu-id="839c7-281">Update Display Information</span></span>

<span data-ttu-id="839c7-282">Om visningen för ett objekt inte ger det förväntade resultatet skapar du en anpassad *\<YourProductName>* .Format.ps1XML-fil för objektet.</span><span class="sxs-lookup"><span data-stu-id="839c7-282">If the display for an object does not provide the expected results, create a custom *\<YourProductName>* .Format.ps1xml file for that object.</span></span>

### <a name="support-well-defined-pipeline-input-sc02"></a><span data-ttu-id="839c7-283">Support bra definierade pipeline-inmatare (SC02)</span><span class="sxs-lookup"><span data-stu-id="839c7-283">Support Well Defined Pipeline Input (SC02)</span></span>

#### <a name="implement-for-the-middle-of-a-pipeline"></a><span data-ttu-id="839c7-284">Implementera mitt i en pipeline</span><span class="sxs-lookup"><span data-stu-id="839c7-284">Implement for the Middle of a Pipeline</span></span>

<span data-ttu-id="839c7-285">Implementera en cmdlet förutsatt att den kommer att anropas från mitten av en pipeline (det vill säga andra cmdlets skapar indata eller förbrukar utdata).</span><span class="sxs-lookup"><span data-stu-id="839c7-285">Implement a cmdlet assuming that it will be called from the middle of a pipeline (that is, other cmdlets will produce its input or consume its output).</span></span> <span data-ttu-id="839c7-286">Du kan till exempel anta att `Get-Process` cmdleten, eftersom den genererar data, endast används som första cmdlet i en pipeline.</span><span class="sxs-lookup"><span data-stu-id="839c7-286">For example, you might assume that the `Get-Process` cmdlet, because it generates data, is used only as the first cmdlet in a pipeline.</span></span> <span data-ttu-id="839c7-287">Men eftersom den här cmdleten är avsedd för mitten av en pipeline, tillåter den här cmdleten tidigare cmdletar eller data i pipelinen att ange vilka processer som ska hämtas.</span><span class="sxs-lookup"><span data-stu-id="839c7-287">However, because this cmdlet is designed for the middle of a pipeline, this cmdlet allows previous cmdlets or data in the pipeline to specify the processes to retrieve.</span></span>

#### <a name="support-input-from-the-pipeline"></a><span data-ttu-id="839c7-288">Stöd för ininformation från pipelinen</span><span class="sxs-lookup"><span data-stu-id="839c7-288">Support Input from the Pipeline</span></span>

<span data-ttu-id="839c7-289">I varje parameter uppsättning för en cmdlet inkluderar du minst en parameter som stöder indatamängden från pipelinen.</span><span class="sxs-lookup"><span data-stu-id="839c7-289">In each parameter set for a cmdlet, include at least one parameter that supports input from the pipeline.</span></span> <span data-ttu-id="839c7-290">Stöd för pipeline-indata gör att användaren kan hämta data eller objekt, skicka dem till rätt parameter uppsättning och skicka resultaten direkt till en-cmdlet.</span><span class="sxs-lookup"><span data-stu-id="839c7-290">Support for pipeline input allows the user to retrieve data or objects, to send them to the correct parameter set, and to pass the results directly to a cmdlet.</span></span>

<span data-ttu-id="839c7-291">En parameter accepterar ininformation från pipelinen om attributet **parameter** innehåller `ValueFromPipeline` nyckelordet, `ValueFromPipelineByPropertyName` nyckelordet eller båda nyckelorden i dess deklaration.</span><span class="sxs-lookup"><span data-stu-id="839c7-291">A parameter accepts input from the pipeline if the **Parameter** attribute includes the `ValueFromPipeline` keyword, the `ValueFromPipelineByPropertyName` keyword attribute, or both keywords in its  declaration.</span></span> <span data-ttu-id="839c7-292">Om ingen av parametrarna i en parameter uppsättning har stöd för `ValueFromPipeline` eller `ValueFromPipelineByPropertyName` , kan cmdleten inte meningsfullt placeras efter en annan cmdlet eftersom den ignorerar alla pipeline-inflöden.</span><span class="sxs-lookup"><span data-stu-id="839c7-292">If none of the parameters in a parameter set support the `ValueFromPipeline` or `ValueFromPipelineByPropertyName` keywords, the cmdlet cannot meaningfully be placed after another cmdlet because it will ignore any pipeline input.</span></span>

#### <a name="support-the-processrecord-method"></a><span data-ttu-id="839c7-293">Stöd för metoden ProcessRecord</span><span class="sxs-lookup"><span data-stu-id="839c7-293">Support the ProcessRecord Method</span></span>

<span data-ttu-id="839c7-294">Om du vill acceptera alla poster från föregående cmdlet i pipelinen måste din cmdlet implementera metoden [system. Management. Automation. cmdlet. ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) .</span><span class="sxs-lookup"><span data-stu-id="839c7-294">To accept all the records from the preceding cmdlet in the pipeline, your cmdlet must implement the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method.</span></span> <span data-ttu-id="839c7-295">Windows PowerShell anropar den här metoden flera gånger, en gång för varje post som skickas till din cmdlet.</span><span class="sxs-lookup"><span data-stu-id="839c7-295">Windows PowerShell calls this method multiple times, once for every record that is sent to your cmdlet.</span></span>

### <a name="write-single-records-to-the-pipeline-sc03"></a><span data-ttu-id="839c7-296">Skriv enskilda poster till pipelinen (SC03)</span><span class="sxs-lookup"><span data-stu-id="839c7-296">Write Single Records to the Pipeline (SC03)</span></span>

<span data-ttu-id="839c7-297">När en cmdlet returnerar objekt ska cmdleten skriva objekten direkt när de genereras.</span><span class="sxs-lookup"><span data-stu-id="839c7-297">When a cmdlet returns objects, the cmdlet should write the objects immediately as they are generated.</span></span> <span data-ttu-id="839c7-298">Cmdleten bör inte innehålla dem för att buffra dem i en kombinerad matris.</span><span class="sxs-lookup"><span data-stu-id="839c7-298">The cmdlet should not hold them in order to buffer them into a combined array.</span></span> <span data-ttu-id="839c7-299">De cmdletar som tar emot objekten som indata kommer sedan att kunna bearbeta, Visa eller bearbeta och visa utdata utan fördröjning.</span><span class="sxs-lookup"><span data-stu-id="839c7-299">The cmdlets that receive the objects as input will then be able to process, display, or process and display the output objects without delay.</span></span> <span data-ttu-id="839c7-300">En cmdlet som genererar utdata en i taget bör anropa metoden [system. Management. Automation. cmdlet. WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) .</span><span class="sxs-lookup"><span data-stu-id="839c7-300">A cmdlet that generates output objects one at a time should call the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="839c7-301">En cmdlet som genererar utdata i batchar (till exempel eftersom ett underliggande API returnerar en matris med utgående objekt) bör anropa metoden [system. Management. Automation. cmdlet. WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) med dess andra parameter inställd på `true` .</span><span class="sxs-lookup"><span data-stu-id="839c7-301">A cmdlet that generates output objects in batches (for example, because an underlying API returns an array of output objects) should call the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) Method with its second parameter set to `true`.</span></span>

### <a name="make-cmdlets-case-insensitive-and-case-preserving-sc04"></a><span data-ttu-id="839c7-302">Skapa cmdlets Case-Insensitive och Case-Preserving (SC04)</span><span class="sxs-lookup"><span data-stu-id="839c7-302">Make Cmdlets Case-Insensitive and Case-Preserving (SC04)</span></span>

<span data-ttu-id="839c7-303">Som standard är Windows PowerShell inte Skift läges känsligt.</span><span class="sxs-lookup"><span data-stu-id="839c7-303">By default, Windows PowerShell itself is case-insensitive.</span></span> <span data-ttu-id="839c7-304">Men eftersom det behandlar flera befintliga system, bevarar Windows PowerShell Skift läge för enkel drift och kompatibilitet.</span><span class="sxs-lookup"><span data-stu-id="839c7-304">However, because it deals with many preexisting systems, Windows PowerShell does preserve case for ease of operation and compatibility.</span></span> <span data-ttu-id="839c7-305">Om ett tecken i versaler anges med versaler, så behåller Windows PowerShell det med versala bokstäver.</span><span class="sxs-lookup"><span data-stu-id="839c7-305">In other words, if a character is supplied in uppercase letters, Windows PowerShell keeps it in uppercase letters.</span></span> <span data-ttu-id="839c7-306">För att system ska fungera bra måste en cmdlet följa denna konvention.</span><span class="sxs-lookup"><span data-stu-id="839c7-306">For systems to work well, a cmdlet needs to follow this convention.</span></span> <span data-ttu-id="839c7-307">Om möjligt bör det köras på ett skift läges okänsligt sätt.</span><span class="sxs-lookup"><span data-stu-id="839c7-307">If possible, it should operate in a case-insensitive way.</span></span> <span data-ttu-id="839c7-308">Det bör dock behålla det ursprungliga fallet för cmdletar som sker senare i ett kommando eller i pipelinen.</span><span class="sxs-lookup"><span data-stu-id="839c7-308">It should, however, preserve the original case for cmdlets that occur later in a command or in the pipeline.</span></span>

## <a name="see-also"></a><span data-ttu-id="839c7-309">Se även</span><span class="sxs-lookup"><span data-stu-id="839c7-309">See Also</span></span>

[<span data-ttu-id="839c7-310">Obligatoriska riktlinjer för utveckling</span><span class="sxs-lookup"><span data-stu-id="839c7-310">Required Development Guidelines</span></span>](./required-development-guidelines.md)

[<span data-ttu-id="839c7-311">Rekommenderade riktlinjer för utveckling</span><span class="sxs-lookup"><span data-stu-id="839c7-311">Advisory Development Guidelines</span></span>](./advisory-development-guidelines.md)

[<span data-ttu-id="839c7-312">Skriva en Windows PowerShell-cmdlet</span><span class="sxs-lookup"><span data-stu-id="839c7-312">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)

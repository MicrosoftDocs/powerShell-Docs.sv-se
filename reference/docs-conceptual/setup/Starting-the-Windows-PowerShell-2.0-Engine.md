---
ms.date: 2017-06-05
keywords: PowerShell-cmdlet
title: Starta Windows PowerShell 2.0-motorn
ms.assetid: edafc2fa-7576-49c2-bbba-9336f4bcfc28
ms.openlocfilehash: f074330953164c49d9bfaa3eb7ca1c1638eeeb76
ms.sourcegitcommit: 755d7bc0740573d73613cedcf79981ca3dc81c5e
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 02/09/2018
---
# <a name="starting-the-windows-powershell-20-engine"></a><span data-ttu-id="2eaf7-103">Starta Windows PowerShell 2.0-motorn</span><span class="sxs-lookup"><span data-stu-id="2eaf7-103">Starting the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="2eaf7-104">Det här avsnittet beskrivs hur du startar Windows PowerShell 2.0-motorn på Windows 8.1, Windows Server 2012 R2, Windows 8 och Windows Server 2012, bland annat Windows PowerShell 2.0-motorn och på andra datorer på vilka Windows PowerShell 2.0, Windows PowerShell 3.0 och Windows PowerShell 4.0 är installerat.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-104">This section explains how to start the Windows PowerShell 2.0 Engine on Windows 8.1, Windows Server 2012 R2, Windows 8, and Windows Server 2012, which include the Windows PowerShell 2.0 Engine, and on other systems on which Windows PowerShell 2.0, Windows PowerShell 3.0, and Windows PowerShell 4.0 are installed.</span></span>

<span data-ttu-id="2eaf7-105">Windows PowerShell 4.0 och Windows PowerShell 3.0 är avsedda att vara bakåtkompatibla med Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-105">Windows PowerShell 4.0 and Windows PowerShell 3.0 are designed to be backwards compatible with Windows PowerShell 2.0.</span></span> <span data-ttu-id="2eaf7-106">Cmdlets, providers, snapin-moduler, moduler och skript som är skrivna för Windows PowerShell 2.0 kör oförändrad i Windows PowerShell 4.0 och Windows PowerShell 3.0.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-106">Cmdlets, providers, snap-ins, modules, and scripts written for Windows PowerShell 2.0 run unchanged in Windows PowerShell 4.0 and Windows PowerShell 3.0.</span></span> <span data-ttu-id="2eaf7-107">Men på grund av en ändring i principen runtime aktivering i Microsoft .NET Framework 4 även Windows PowerShell värd för program som har skrivits för Windows PowerShell 2.0 och kompileras med Runtime CLR (Common Language) 2.0 kan inte köras utan ändringar i Windows PowerShell 3.0 eller Windows PowerShell 4.0, som kompileras med CLR-4.0.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-107">However, due to a change in the runtime activation policy in Microsoft .NET Framework 4, Windows PowerShell host programs that were written for Windows PowerShell 2.0 and compiled with Common Language Runtime (CLR) 2.0 cannot run without modification in Windows PowerShell 3.0 or Windows PowerShell 4.0, which are compiled with CLR 4.0.</span></span> <span data-ttu-id="2eaf7-108">Windows PowerShell 2.0-motorn är avsedd att användas endast när ett befintligt skript eller värdprogrammet kan inte köras eftersom den inte är kompatibel med Windows PowerShell 4.0, Windows PowerShell 3.0 eller Microsoft .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-108">The Windows PowerShell 2.0 Engine is intended to be used only when an existing script or host program cannot run because it is incompatible with Windows PowerShell 4.0, Windows PowerShell 3.0, or Microsoft .NET Framework 4.</span></span> <span data-ttu-id="2eaf7-109">Sådana fall förväntas vara sällsynt.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-109">Such cases are expected to be rare.</span></span>

<span data-ttu-id="2eaf7-110">Många program som kräver Windows PowerShell 2.0-motorn startas den automatiskt.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-110">Many programs that require the Windows PowerShell 2.0 Engine start it automatically.</span></span> <span data-ttu-id="2eaf7-111">Dessa instruktioner ingår i ovanliga situationer där du behöver starta motorn manuellt.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-111">These instructions are included for the rare situations in which you need to start the engine manually.</span></span>

## <a name="installing-and-enabling-required-programs"></a><span data-ttu-id="2eaf7-112">Installera och aktivera program som behövs</span><span class="sxs-lookup"><span data-stu-id="2eaf7-112">Installing and Enabling Required Programs</span></span>

<span data-ttu-id="2eaf7-113">Aktivera Windows PowerShell 2.0-motorn och Microsoft .NET Framework 3.5 med Service Pack 1 innan du startar Windows PowerShell 2.0-motorn.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-113">Before starting the Windows PowerShell 2.0 Engine, enable the Windows PowerShell 2.0 Engine and Microsoft .NET Framework 3.5 with Service Pack 1.</span></span> <span data-ttu-id="2eaf7-114">Instruktioner finns i [installera Windows PowerShell](Installing-Windows-PowerShell.md).</span><span class="sxs-lookup"><span data-stu-id="2eaf7-114">For instructions, see [Installing Windows PowerShell](Installing-Windows-PowerShell.md).</span></span>

<span data-ttu-id="2eaf7-115">System där [Windows Management Framework 4.0](http://go.microsoft.com/fwlink/?LinkID=293881) eller Windows Management Framework 3.0 är installerat har alla nödvändiga komponenter.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-115">Systems on which [Windows Management Framework 4.0](http://go.microsoft.com/fwlink/?LinkID=293881) or Windows Management Framework 3.0 are installed have all of the required components.</span></span> <span data-ttu-id="2eaf7-116">Det krävs ingen ytterligare konfiguration.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-116">No further configuration is necessary.</span></span> <span data-ttu-id="2eaf7-117">Information om hur du installerar [Windows Management Framework 4.0](http://go.microsoft.com/fwlink/?LinkID=293881) eller Windows Management Framework 3.0 finns [installera Windows PowerShell](Installing-Windows-PowerShell.md).</span><span class="sxs-lookup"><span data-stu-id="2eaf7-117">For information about installing [Windows Management Framework 4.0](http://go.microsoft.com/fwlink/?LinkID=293881) or Windows Management Framework 3.0, see [Installing Windows PowerShell](Installing-Windows-PowerShell.md).</span></span>

## <a name="how-to-start-the-windows-powershell-20-engine"></a><span data-ttu-id="2eaf7-118">Så här startar du Windows PowerShell 2.0-motorn</span><span class="sxs-lookup"><span data-stu-id="2eaf7-118">How to start the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="2eaf7-119">Som standard när du startar Windows PowerShell startar den senaste versionen.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-119">When you start Windows PowerShell the newest version starts by default.</span></span> <span data-ttu-id="2eaf7-120">Om du vill starta Windows PowerShell med Windows PowerShell 2.0-motorn, använder du parametern Version av PowerShell.exe.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-120">To start Windows PowerShell with the Windows PowerShell 2.0 Engine, use the Version parameter of PowerShell.exe.</span></span> <span data-ttu-id="2eaf7-121">Du kan köra kommandot i en kommandotolk, inklusive Windows PowerShell och Cmd.exe.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-121">You can run the command at any command prompt, including Windows PowerShell and Cmd.exe.</span></span>

```
PowerShell.exe -Version 2
```

## <a name="how-to-start-a-remote-session-with-the-windows-powershell-20-engine"></a><span data-ttu-id="2eaf7-122">Hur du startar en fjärrsession med Windows PowerShell 2.0-motorn</span><span class="sxs-lookup"><span data-stu-id="2eaf7-122">How to start a remote session with the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="2eaf7-123">Skapa en sessionskonfiguration (även kallat en ”slutpunkt”) för att köra Windows PowerShell 2.0-motorn i en fjärrsession på fjärrdatorn som läser in Windows PowerShell 2.0-motorn.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-123">To run the Windows PowerShell 2.0 Engine in a remote session, create a session configuration (also known as an "endpoint") on the remote computer that loads the Windows PowerShell 2.0 Engine.</span></span> <span data-ttu-id="2eaf7-124">Sessionskonfigurationen sparas på fjärrdatorn och kan användas av alla behöriga användare för att skapa sessioner som använder Windows PowerShell 2.0-motorn.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-124">The session configuration is saved on the remote computer and can be used by any authorized user to create sessions that use the Windows PowerShell 2.0 Engine.</span></span>

<span data-ttu-id="2eaf7-125">Detta är en avancerad uppgift som vanligtvis utförs av en systemadministratör.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-125">This is an advanced task that is typically performed by a system administrator.</span></span>

<span data-ttu-id="2eaf7-126">I följande procedur används den **PSVersion** parameter för den [Register-PSSessionConfiguration](https://technet.microsoft.com/en-us/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) för att skapa en sessionskonfiguration som använder Windows PowerShell 2.0-motorn.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-126">The following procedure uses the **PSVersion** parameter of the [Register-PSSessionConfiguration](https://technet.microsoft.com/en-us/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet to create a session configuration that uses the Windows PowerShell 2.0 Engine.</span></span> <span data-ttu-id="2eaf7-127">Du kan också använda den **PowerShellVersion** parameter för den [ny PSSessionConfigurationFile](https://technet.microsoft.com/en-us/library/5f3e3633-6e90-479c-aea9-ba45a1954866) för att skapa en konfigurationsfil för sessionen för en session som läser in Windows PowerShell 2.0-motorn och Du kan använda den **PSVersion** parameter för den [Set-PSSessionConfiguration](https://technet.microsoft.com/en-us/library/b21fbad3-1759-4260-b206-dcb8431cd6ea) parametern för att ändra en sessionskonfiguration om du vill använda Windows PowerShell 2.0-motorn.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-127">You can also use the **PowerShellVersion** parameter of the [New-PSSessionConfigurationFile](https://technet.microsoft.com/en-us/library/5f3e3633-6e90-479c-aea9-ba45a1954866) cmdlet to create a session configuration file for a session that loads the Windows PowerShell 2.0 Engine and you can use the **PSVersion** parameter of the [Set-PSSessionConfiguration](https://technet.microsoft.com/en-us/library/b21fbad3-1759-4260-b206-dcb8431cd6ea) parameter to change a session configuration to use the Windows PowerShell 2.0 Engine.</span></span>

<span data-ttu-id="2eaf7-128">Mer information om sessionen konfigurationsfiler finns [about_Session_Configuration_Files](https://technet.microsoft.com/en-us/library/c7217447-1ebf-477b-a8ef-4dbe9a1473b8). Information om sessionskonfigurationer, inklusive installation och säkerhet, se [about_Session_Configurations [v4]](https://technet.microsoft.com/en-us/library/a2fbe12a-350c-4d04-be50-24102824e3ab).</span><span class="sxs-lookup"><span data-stu-id="2eaf7-128">For more information about session configuration files, see [about_Session_Configuration_Files](https://technet.microsoft.com/en-us/library/c7217447-1ebf-477b-a8ef-4dbe9a1473b8).For information about session configurations, including setup and security, see [about_Session_Configurations[v4]](https://technet.microsoft.com/en-us/library/a2fbe12a-350c-4d04-be50-24102824e3ab).</span></span>

#### <a name="to-start-a-remote-windows-powershell-20-session"></a><span data-ttu-id="2eaf7-129">Att starta en fjärrsession i Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="2eaf7-129">To start a remote Windows PowerShell 2.0 session</span></span>

1. <span data-ttu-id="2eaf7-130">Så här skapar du en sessionskonfiguration som kräver Windows PowerShell 2.0-motorn på **PSVersion** parameter för den [Register-PSSessionConfiguration](https://technet.microsoft.com/en-us/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet med värdet ”2.0”.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-130">To create a session configuration that requires the Windows PowerShell 2.0 Engine, use the **PSVersion** parameter of the [Register-PSSessionConfiguration](https://technet.microsoft.com/en-us/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet with a value of "2.0".</span></span> <span data-ttu-id="2eaf7-131">Kör kommandot på datorn i ”serversidan” eller mottagande slutet av anslutningen.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-131">Run this command on the computer at the "server side" or receiving end of the connection.</span></span>

   <span data-ttu-id="2eaf7-132">Följande exempelkommando skapar PS2-sessionskonfiguration på Server01-datorn.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-132">The following sample command creates the PS2 session configuration on the Server01 computer.</span></span> <span data-ttu-id="2eaf7-133">Om du vill köra det här kommandot, starta Windows PowerShell 4.0 eller Windows PowerShell 3.0 med den **kör som administratör** alternativet.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-133">To run this command, start Windows PowerShell 4.0 or Windows PowerShell 3.0 with the **Run as administrator** option.</span></span>

   ```powershell
   Register-PSSessionConfiguration -Name PS2 -PSVersion 2.0
   ```

2. <span data-ttu-id="2eaf7-134">Använd för att skapa en session på datorn Server01 som använder sessionskonfigurationen PS2 den **ConfigurationName** parametern för cmdletar som skapar en fjärrsession som den [New-PSSession](https://technet.microsoft.com/en-us/library/76f6628c-054c-4eda-ba7a-a6f28daaa26f) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-134">To create a session on the Server01 computer that uses the PS2 session configuration, use the **ConfigurationName** parameter of cmdlets that create a remote session, such as the [New-PSSession](https://technet.microsoft.com/en-us/library/76f6628c-054c-4eda-ba7a-a6f28daaa26f) cmdlet.</span></span>

   <span data-ttu-id="2eaf7-135">När en session som använder sessionskonfigurationen startar laddas automatiskt Windows PowerShell 2.0-motorn i sessionen.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-135">When a session that uses the session configuration starts, the Windows PowerShell 2.0 Engine is automatically loaded into the session.</span></span>

   <span data-ttu-id="2eaf7-136">Följande kommando startar en session på datorn Server01 som använder sessionskonfigurationen PS2.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-136">The following command starts a session on the Server01 computer that uses the PS2 session configuration.</span></span> <span data-ttu-id="2eaf7-137">Kommandot sparar sessionen i variabeln $s.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-137">The command saves the session in the $s variable.</span></span>

   ```powershell
   $s = New-PSSession -ComputerName Server01 -ConfigurationName PS2
   ```

## <a name="how-to-start-a-background-job-with-the-windows-powershell-20-engine"></a><span data-ttu-id="2eaf7-138">Starta ett bakgrundsjobb med Windows PowerShell 2.0-motorn</span><span class="sxs-lookup"><span data-stu-id="2eaf7-138">How to start a background job with the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="2eaf7-139">Starta ett bakgrundsjobb med Windows PowerShell 2.0 motorn med den **PSVersion** parameter för den [Start-Job](https://technet.microsoft.com/en-us/library/2bc04935-0deb-4ec0-b856-d7290cca6442) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="2eaf7-139">To start a background job with the Windows PowerShell 2.0 Engine, use the **PSVersion** parameter of the [Start-Job](https://technet.microsoft.com/en-us/library/2bc04935-0deb-4ec0-b856-d7290cca6442) cmdlet.</span></span>

<span data-ttu-id="2eaf7-140">Följande kommando startar bakgrunden med Windows PowerShell 2.0-motorn</span><span class="sxs-lookup"><span data-stu-id="2eaf7-140">The following command starts a background job with the Windows PowerShell 2.0 Engine</span></span>

```powershell
Start-Job {Get-Process} -PSVersion 2.0
```

<span data-ttu-id="2eaf7-141">Mer information om bakgrundsjobb finns [about_Jobs](/powershell/module/microsoft.powershell.core/about/about_jobs).</span><span class="sxs-lookup"><span data-stu-id="2eaf7-141">For more information about background jobs, see [about_Jobs](/powershell/module/microsoft.powershell.core/about/about_jobs).</span></span>
